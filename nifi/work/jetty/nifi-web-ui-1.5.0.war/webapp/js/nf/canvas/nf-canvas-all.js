(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(d){var c=false;var e=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return d.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(f){var g=f;var h=g.clusterSummary;if(e!==h.connectedToCluster){b=true}c=h.clustered;e=h.connectedToCluster})},isClustered:function(){return c===true},isConnectedToCluster:function(){return e===true},didConnectedStateChange:function(){var f=b;b=false;return f}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var g=86400000;var f=g*2;var b=function(h){return typeof h==="undefined"};var e=function(h){return h===null};var d=function(h){return !b(h)&&!e(h)};var c=function(j){if(d(j.expires)){var h=new Date(j.expires);var i=new Date();return h.valueOf()<i.valueOf()}else{return false}};var a=function(h){try{var i=JSON.parse(localStorage.getItem(h));if(d(i)){return i}else{return null}}catch(j){return null}};return{init:function(){for(var j=0;j<localStorage.length;j++){try{var h=localStorage.key(j);this.getItem(h)}catch(k){}}},setItem:function(i,k,h){h=d(h)?h:new Date().valueOf()+f;var j={expires:h,item:k};localStorage.setItem(i,JSON.stringify(j))},hasItem:function(h){return a(h)!==null},getItem:function(h){var i=a(h);if(i===null){return null}if(c(i)){this.removeItem(h);return null}if(d(i.item)){return i.item}else{return null}},getItemExpiration:function(h){var i=a(h);if(i===null){return null}if(d(i.expires)){return i.expires}else{return null}},removeItem:function(h){localStorage.removeItem(h)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Storage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.Storage")))}else{nf.AjaxSetup=b(a.$,a.nf.Storage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(f){var d=a.hasItem("jwt");var e=a.getItem("jwt");if(e!==null){f.setRequestHeader("Authorization","Bearer "+e)}else{if(d===true){return false}}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nfel-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster."})},showConnectedToClusterMessage:function(){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster."})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage"],function(e,d,c){return(nf.Common=b(e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.Storage")))}else{nf.Common=b(a.$,a.d3,a.nf.Storage)}}}(this,function(e,d,b){e(document).ready(function(){var g="images/bg-error.png";e("<img/>").attr("src",g).on("load",function(){e("div.message-pane").css("background-image",g)});e(document).on("mouseenter","span.link",function(){e(this).addClass("link-over")}).on("mouseleave","span.link",function(){e(this).removeClass("link-over")});e(document).on("click","div.nf-checkbox",function(){var h=e(this);if(h.hasClass("checkbox-unchecked")){h.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{h.removeClass("checkbox-checked").addClass("checkbox-unchecked")}h.trigger("change")});e(document).on("click",".nf-checkbox-label",function(h){e(h.target).parent().find(".nf-checkbox").click()});e(document).ajaxStart(function(){e("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){e("div.loading-container").removeClass("ajax-loading")});if(b.getItem("jwt")!==null){e("#user-logout-container").css("display","block");f.scheduleTokenRefresh()}e("#user-logout").on("click",function(){b.removeItem("jwt");window.location="../nifi/login"});e("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi"}else{window.location="../nifi"}})});var c=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Reporting Tasks, Controller Services, and Nodes in the Cluster"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming otherwise sufficient permissions"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var f={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(g){e(this).slideDown(100)}},hide:{effect:function(g){e(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(g,r){if(g===r){return 0}var n=g.split(/-/);var s=r.split(/-/);if(n.length>=1&&s.length>=1){var p=n[0].split(/\./);var m=s[0].split(/\./);if(p.length>=1&&m.length>=1){var k=Math.min(p.length,m.length);for(var l=0;l<k;l++){var q=parseInt(p[l],10);var j=parseInt(m[l],10);if(isNaN(q)&&isNaN(j)){continue}else{if(isNaN(q)){return -1}else{if(isNaN(j)){return 1}}}if(q!==j){return q-j}}if(p.length===m.length){if(n.length===s.length){var o=f.substringAfterFirst(g,n[0]);var h=f.substringAfterFirst(r,s[0]);return o===h?0:o>h?1:-1}else{return s.length-n.length}}else{return p.length-m.length}}else{if(p.length>=1){return 1}else{if(m.length>=1){return -1}else{return 0}}}}else{if(n.length>=1){return 1}else{if(s.length>=1){return -1}else{return 0}}}},sortType:function(g,j){var h=function(m,k){var n=f.formatBundle(m.bundle);var l=f.formatBundle(k.bundle);return n===l?0:n>l?1:-1};var i=function(r,q){if(g.columnId==="version"){var p=f.isDefinedAndNotNull(r.bundle[g.columnId])?r.bundle[g.columnId]:"";var n=f.isDefinedAndNotNull(q.bundle[g.columnId])?q.bundle[g.columnId]:"";var l=f.sortVersion(p,n);return l===0?h(r,q):l}else{if(g.columnId==="type"){var o=f.substringAfterLast(r[g.columnId],".");var m=f.substringAfterLast(q[g.columnId],".");return o===m?0:o>m?1:-1}else{var k=f.isDefinedAndNotNull(r[g.columnId])?r[g.columnId]:"";var s=f.isDefinedAndNotNull(q[g.columnId])?q[g.columnId]:"";return k===s?h(r,q):k>s?1:-1}}};j.sort(i,g.sortAsc)},typeFormatter:function(l,h,k,j,g){var i="";if(f.isBlank(g.usageRestriction)===false){i+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}else{i+='<div class="fa"></div>'}i+=f.escapeHtml(k);return i},genericValueFormatter:function(k,h,j,i,g){return f.escapeHtml(j)},typeBundleFormatter:function(k,h,j,i,g){return f.escapeHtml(f.formatBundle(g.bundle))},typeVersionFormatter:function(l,h,k,j,g){var i="";if(f.isDefinedAndNotNull(g.bundle)){i+=('<div style="float: left;">'+f.escapeHtml(g.bundle.version)+"</div>")}else{i+='<div style="float: left;">unversioned</div>'}if(!f.isEmpty(g.controllerServiceApis)){i+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-top: 2px; margin-left: 4px;"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}i+='<div class="clear"></div>';return i},instanceTypeFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.escapeHtml(f.formatType(g.component))},instanceBundleFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.typeBundleFormatter(k,h,j,i,g.component)},getVersionControlTooltip:function(g){return g.stateExplanation},formatClassName:function(g){return f.substringAfterLast(g.type,".")},formatType:function(g){var h=f.formatClassName(g);if(g.bundle.version!=="unversioned"){h+=(" "+g.bundle.version)}return h},formatBundle:function(g){var h="";if(g.group!=="default"){h=g.group+" - "}return h+g.artifact},setCurrentUser:function(g){f.currentUser=g},scheduleTokenRefresh:function(){if(c!==null){clearInterval(c)}var g=f.MILLIS_PER_MINUTE;var h=function(){var j=b.getItemExpiration("jwt");if(j!==null){var l=new Date(j);var k=new Date();var i=l.valueOf()-k.valueOf()-(30*f.MILLIS_PER_SECOND);if(i<g){if(e("#current-user").text()!==f.ANONYMOUS_USER_TEXT&&!e("#anonymous-user-alert").is(":visible")){e("#anonymous-user-alert").show().qtip(e.extend({},f.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};h();c=setInterval(h,g)},setAnonymousUserLabel:function(){var g=e("#anonymous-user-alert");if(g.data("qtip")){g.qtip("api").destroy(true)}g.show().qtip(e.extend({},f.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));e("#current-user").text(f.ANONYMOUS_USER_TEXT).show()},getJwtPayload:function(h){if(f.isDefinedAndNotNull(h)){var g=h.split(/\./);if(g.length!==3){return""}var j=e.base64.atob(g[1]);var i=JSON.parse(j);if(f.isDefinedAndNotNull(i)){return i}else{return null}}return null},canVersionFlows:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true&&f.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true&&f.currentUser.tenantsPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true&&f.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true&&f.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(g,i,h){e(document).on("mouseenter",g,function(){e(this).removeClass(i).addClass(h)}).on("mouseleave",g,function(){e(this).removeClass(h).addClass(i)});return e(g).addClass(i)},toggleScrollable:function(g){if(e(g).is(":visible")){if(g.offsetHeight<g.scrollHeight||g.offsetWidth<g.scrollWidth){e(g).addClass("scrollable")}else{e(g).removeClass("scrollable")}}},determineContrastColor:function(g){if(parseInt(g,16)>16777215/1.5){return"#000000"}return"#ffffff"},showLogoutLink:function(){if(b.getItem("jwt")===null){e("#user-logout-container").css("display","none")}else{e("#user-logout-container").css("display","block")}},isContentViewConfigured:function(){var g=e("#nifi-content-viewer-url").text();return !f.isBlank(g)},populateField:function(h,g){if(f.isUndefined(g)||f.isNull(g)){return e("#"+h).addClass("unset").text("No value set")}else{if(g===""){return e("#"+h).addClass("blank").text("Empty string set")}else{return e("#"+h).text(g)}}},clearField:function(g){return e("#"+g).removeClass("unset blank").text("")},cleanUpTooltips:function(g,h){g.find(h).each(function(){var j=e(this);if(j.data("qtip")){var i=j.qtip("api");i.destroy(true)}})},formatPropertyTooltip:function(h,j){var k=[];if(f.isDefinedAndNotNull(h)){if(!f.isBlank(h.description)){k.push(f.escapeHtml(h.description))}if(!f.isBlank(h.defaultValue)){k.push("<b>Default value:</b> "+f.escapeHtml(h.defaultValue))}if(!f.isBlank(h.supportsEl)){k.push("<b>Supports expression language:</b> "+f.escapeHtml(h.supportsEl))}if(!f.isBlank(h.identifiesControllerService)){var g=f.formatType({type:h.identifiesControllerService,bundle:h.identifiesControllerServiceBundle});var i=f.formatBundle(h.identifiesControllerServiceBundle);k.push("<b>Requires Controller Service:</b> "+f.escapeHtml(g+" from "+i))}}if(f.isDefinedAndNotNull(j)){if(!f.isEmpty(j.previousValues)){var l=[];e.each(j.previousValues,function(n,m){l.push("<li>"+f.escapeHtml(m.previousValue)+" - "+f.escapeHtml(m.timestamp)+" ("+f.escapeHtml(m.userIdentity)+")</li>")});k.push('<b>History:</b><ul class="property-info">'+l.join("")+"</ul>")}}if(k.length>0){return k.join("<br/><br/>")}else{return null}},formatProperty:function(g,h){return'<div><span class="label">'+f.formatValue(g)+": </span>"+f.formatValue(h)+"</div>"},formatValue:function(g){if(f.isDefinedAndNotNull(g)){if(g===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return f.escapeHtml(g)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(h){if(f.isDefinedAndNotNull(h)){return String(h).replace(/[&<>"'\/]/g,function(i){return g[i]})}else{return""}}}()),isSensitiveProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.sensitive===true}else{return false}},isRequiredProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.required===true}else{return false}},isDynamicProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.dynamic===true}else{return false}},getAllowableValues:function(g){if(f.isDefinedAndNotNull(g)){return g.allowableValues}else{return null}},supportsEl:function(g){if(f.isDefinedAndNotNull(g)){return g.supportsEl===true}else{return false}},formatUnorderedList:function(h){if(e.isArray(h)){var g=e('<ul class="result"></ul>');e.each(h,function(j,k){var i=e("<li></li>").appendTo(g);if(k instanceof jQuery){i.append(k)}else{i.text(k)}});return g}else{return null}},substringAfterLast:function(k,j){var h="";var i=k.lastIndexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringAfterFirst:function(k,j){var h="";var i=k.indexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringBeforeFirst:function(j,i){var g="";var h=j.indexOf(i);if(h>=0){g=j.substr(0,h)}return g},setCursor:function(h,g){if(g){e("#"+h).addClass("pointer")}else{e("#"+h).removeClass("pointer")}},getAccessToken:function(g){return e.Deferred(function(h){if(b.hasItem("jwt")){e.ajax({type:"POST",url:g}).done(function(i){h.resolve(i)}).fail(function(){h.reject()})}else{h.resolve("")}}).promise()},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,formatDuration:function(j){j=j<1?0:j;var l=j/f.MILLIS_PER_DAY;l=l>=1?parseInt(l,10):0;j%=f.MILLIS_PER_DAY;var g=j/f.MILLIS_PER_HOUR;g=g>=1?parseInt(g,10):0;j%=f.MILLIS_PER_HOUR;var h=j/f.MILLIS_PER_MINUTE;h=h>=1?parseInt(h,10):0;j%=f.MILLIS_PER_MINUTE;var k=j/f.MILLIS_PER_SECOND;k=k>=1?parseInt(k,10):0;j=Math.floor(j%f.MILLIS_PER_SECOND);var i=f.pad(g,2,"0")+":"+f.pad(h,2,"0")+":"+f.pad(k,2,"0")+"."+f.pad(j,3,"0");if(l>0){return l+" days and "+i}else{return i}},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(h){var g=parseFloat(h/f.BYTES_IN_TERABYTE);if(g>1){return g.toFixed(2)+" TB"}g=parseFloat(h/f.BYTES_IN_GIGABYTE);if(g>1){return g.toFixed(2)+" GB"}g=parseFloat(h/f.BYTES_IN_MEGABYTE);if(g>1){return g.toFixed(2)+" MB"}g=parseFloat(h/f.BYTES_IN_KILOBYTE);if(g>1){return g.toFixed(2)+" KB"}return parseFloat(h).toFixed(2)+" bytes"},formatInteger:function(h){var g=h+"";var i=/(\d+)(\d{3})/;while(i.test(g)){g=g.replace(i,"$1,$2")}return f.escapeHtml(g)},formatFloat:function(g){if(f.isUndefinedOrNull(g)){return 0+""}return g.toFixed(2)+""},pad:function(j,h,i){var g=j+"";while(g.length<h){g=i+g}return g},formatDateTime:function(g){return f.pad(g.getMonth()+1,2,"0")+"/"+f.pad(g.getDate(),2,"0")+"/"+f.pad(g.getFullYear(),2,"0")+" "+f.pad(g.getHours(),2,"0")+":"+f.pad(g.getMinutes(),2,"0")+":"+f.pad(g.getSeconds(),2,"0")+"."+f.pad(g.getMilliseconds(),3,"0")},parseDateTime:function(k){if(!f.isDefinedAndNotNull(k)){return new Date()}if(k==="No value set"){return new Date()}if(k==="Empty string set"){return new Date()}var r=k.split(/ /);if(r.length!==3){return new Date()}var h=r[0].split(/\//);var g=r[1].split(/:/);if(h.length!==3||g.length!==3){return new Date()}var m=parseInt(h[2],10);var l=parseInt(h[0],10)-1;var n=parseInt(h[1],10);var o=parseInt(g[0],10);var j=parseInt(g[1],10);var q=g[2].split(/\./);var p=parseInt(q[0],10);var i=0;if(q.length===2){i=parseInt(q[1],10)}return new Date(m,l,n,o,j,p,i)},parseDuration:function(g){var h=g.split(/:/);if(h.length!==3){return 0}var i=h[2].split(/\./);if(i.length===2){return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(i[0],10),parseInt(i[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0).getTime()}},parseSize:function(i){var j=i.split(/ /);var h=parseFloat(j[0].replace(/,/g,""));var g=j[1];if(g==="KB"){return h*1024}else{if(g==="MB"){return h*1024*1024}else{if(g==="GB"){return h*1024*1024*1024}else{if(g==="TB"){return h*1024*1024*1024*1024}else{return h}}}}},parseCount:function(i){var h=i.split(/ /,1);if(h.length!==1){return 0}var g=parseInt(h[0].replace(/,/g,""),10);if(isNaN(g)){return 0}return g},isDefinedAndNotNull:function(g){return !f.isUndefined(g)&&!f.isNull(g)},isUndefinedOrNull:function(g){return f.isUndefined(g)||f.isNull(g)},isUndefined:function(g){return typeof g==="undefined"},isBlank:function(g){return f.isUndefined(g)||f.isNull(g)||e.trim(g)===""},isNull:function(g){return g===null},isEmpty:function(g){return e.isArray(g)?g.length===0:true},doBulletinsDiffer:function(h,j){if(e.isArray(h)&&e.isArray(j)){if(h.length===j.length){for(var g=0;g<h.length;g++){if(h[g].id!==j[g].id||h[g].canRead!==j[g].canRead){return true}}}else{return true}}else{if(e.isArray(h)||e.isArray(j)){return true}}return false},getFormattedBulletins:function(h){var g=[];e.each(h,function(k,l){if(l.canRead===true){var i=l.bulletin;var o="";if(f.isDefinedAndNotNull(i.nodeAddress)){o="-&nbsp;"+f.escapeHtml(i.nodeAddress)+"&nbsp;-&nbsp;"}var n=e("<pre></pre>").css({"white-space":"pre-wrap"}).text(i.message);var m=e("<div>"+f.escapeHtml(i.timestamp)+"&nbsp;"+o+"&nbsp;<b>"+f.escapeHtml(i.level)+"</b>&nbsp;</div>").append(n);g.push(m)}});return g},getFormattedServiceApis:function(h){var g=[];e.each(h,function(l,m){var j=f.formatType({type:m.type,bundle:m.bundle});var k=f.formatBundle(m.bundle);g.push(e("<div></div>").text(j+" from "+k))});return g},getFormattedGarbageCollections:function(h){h.sort(function(j,i){return i.collectionCount-j.collectionCount});var g=[];e.each(h,function(k,i){var j=e('<span style="font-weight: bold;"></span>').text(i.name);var l=e("<span></span>").text(" - "+i.collectionCount+" times ("+i.collectionTime+")");var m=e("<div></div>").append(j).append(l);g.push(m)});return g},getPolicyTypeListing:function(h){var g=d.nest().key(function(i){return i.value}).map(a,d.map);return g.get(h)[0]}};return f}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common"],function(d,c,e){return(nf.ErrorHandler=b(d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common)}}}(this,function(b,a,c){return{handleAjaxError:function(g,d,e){if(d==="canceled"){if(b("#splash").is(":visible")){b("#message-title").text("Session Expired");b("#message-content").text("Your session has expired. Please reload to log in again.");b("#message-pane").show()}else{a.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="/nifi"}})}return}if(b("#splash").is(":visible")){if(g.status===401){b("#message-title").text("Unauthorized")}else{if(g.status===403){b("#message-title").text("Insufficient Permissions")}else{if(g.status===409){b("#message-title").text("Invalid State")}else{b("#message-title").text("An unexpected error has occurred")}}}if(b.trim(g.responseText)===""){b("#message-content").text("Please check the logs.")}else{b("#message-content").text(g.responseText)}b("#message-pane").show();return}if(g.status===400||g.status===404||g.status===409||g.status===503){a.showOkDialog({headerText:"Error",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status===403){a.showOkDialog({headerText:"Insufficient Permissions",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status<99||g.status===12007||g.status===12029){var f="Please ensure the application is running and check the logs for any errors.";if(c.isDefinedAndNotNull(d)){if(d==="timeout"){f="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(d==="abort"){f="Request has been aborted."}else{if(d==="No Transport"){f="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}b("#message-title").text("Unable to communicate with NiFi");b("#message-content").text(f)}else{if(g.status===401){b("#message-title").text("Unauthorized");if(b.trim(g.responseText)===""){b("#message-content").text("Authentication is required to use this NiFi.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===500){b("#message-title").text("An unexpected error has occurred");if(b.trim(g.responseText)===""){b("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===200||g.status===201){b("#message-title").text("Parse Error");if(b.trim(g.responseText)===""){b("#message-content").text("Unable to interpret response from NiFi.")}else{b("#message-content").text(g.responseText)}}else{b("#message-title").text(g.status+": Unexpected Response");b("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}b("#message-pane").show()}}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ClusterSummary","nf.ErrorHandler","nf.Dialog","nf.Common"],function(e,h,c,g,d,f){return(nf.ComponentState=b(e,h,c,g,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("Slick"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ComponentState=b(a.$,a.Slick,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,k,j,d,c){var g=function(){var n=f("#component-state-table").data("gridInstance");if(c.isDefinedAndNotNull(n)){var o=n.getData();o.setFilterArgs({searchString:l()});o.refresh()}};var a=function(p,o){if(o.searchString===""){return true}try{var t=new RegExp(o.searchString,"i")}catch(q){return false}var s=p.key.search(t)>=0;var n=p.value.search(t)>=0;var r=false;if(c.isDefinedAndNotNull(p.scope)){r=p.scope.search(t)>=0}return s||n||r};var e=function(n,p){var o=function(s,q){var r=c.isDefinedAndNotNull(s[n.columnId])?s[n.columnId]:"";var t=c.isDefinedAndNotNull(q[n.columnId])?q[n.columnId]:"";return r===t?0:r>t?1:-1};p.sort(o,n.sortAsc)};var l=function(){return f("#component-state-filter").val()};var i=function(){var n=f("#component-state-table").data("gridInstance");var o=n.getData();o.setItems([]);f("#component-state-partial-results-container").hide();f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")};var h=function(n,o){var p=0;var r=0;var s=false;var q=f("#component-state-table").data("gridInstance");var t=q.getData();t.beginUpdate();if(c.isDefinedAndNotNull(n)){f.each(n.state,function(u,v){t.addItem(f.extend({id:p++,scope:v.clusterNodeAddress},v))});r+=n.totalEntryCount;if(c.isDefinedAndNotNull(n.state)&&n.totalEntryCount!==n.state.length){s=true}}if(c.isDefinedAndNotNull(o)){f.each(o.state,function(u,v){t.addItem(f.extend({id:p++,scope:"Cluster"},v))});r+=o.totalEntryCount;if(c.isDefinedAndNotNull(o.state)&&o.totalEntryCount!==o.state.length){s=true}}t.endUpdate();t.reSort();if(s){f("#component-state-partial-results-container").show()}f("#total-component-state-entries").text(c.formatInteger(r))};var m=function(){f("#component-state-name").text("");f("#component-state-description").text("");f("#component-state-filter").val("");f("#clear-link").removeClass("disabled").attr("title","");i();f("#component-state-table").removeData("component")};return{init:function(){f("#component-state-filter").on("keyup",function(){g()});f("#component-state-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component State",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f(this).modal("hide")}}}],handler:{close:function(){m()},resize:function(){f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(f("#component-state-description").attr("title")).ellipsis()}}});f("#clear-link").on("click",function(){if(f(this).hasClass("disabled")===false){var s=f("#component-state-table");var u=s.data("gridInstance");var t=u.getDataLength();if(t>0){var r=s.data("component");f.ajax({type:"POST",url:r.uri+"/state/clear-requests",dataType:"json"}).done(function(v){i();h()}).fail(j.handleAjaxError)}else{d.showOkDialog({headerText:"Component State",dialogContent:"This component has no state to clear."})}}});var o=[{id:"key",field:"key",name:"Key",sortable:true,resizable:true,formatter:c.genericValueFormatter},{id:"value",field:"value",name:"Value",sortable:true,resizable:true,formatter:c.genericValueFormatter}];if(k.isClustered()){o.push({id:"scope",field:"scope",name:"Scope",sortable:true,resizable:true,formatter:c.genericValueFormatter})}var n={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var q=new b.Data.DataView({inlineFilters:false});q.setItems([]);q.setFilterArgs({searchString:"",property:"key"});q.setFilter(a);e({columnId:"key",sortAsc:true},q);var p=new b.Grid("#component-state-table",q,o,n);p.setSelectionModel(new b.RowSelectionModel());p.registerPlugin(new b.AutoTooltips());p.setSortColumn("key",true);p.onSort.subscribe(function(s,r){e({columnId:r.sortCol.field,sortAsc:r.sortAsc},q)});q.onRowCountChanged.subscribe(function(s,r){p.updateRowCount();p.render();f("#displayed-component-state-entries").text(r.current)});q.onRowsChanged.subscribe(function(s,r){p.invalidateRows(r.rows);p.render()});f("#component-state-table").data("gridInstance",p);f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")},showState:function(n,o){return f.ajax({type:"GET",url:n.uri+"/state",dataType:"json"}).done(function(q){var r=q.componentState;var p=f("#component-state-table");h(r.localState,r.clusterState);f("#component-state-dialog").modal("show");f("#component-state-name").text(n.component.name);f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(r.stateDescription).ellipsis();p.data("component",n);if(o===false){f("#clear-link").addClass("disabled").attr("title","Component state can only be cleared when the component is not actively running")}var s=p.data("gridInstance");s.resizeCanvas()}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Shell=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Shell=b(require("jquery"),require("nf.Common")))}else{nf.Shell=b(a.$,a.nf.Common)}}}(this,function(b,e){b(document).ready(function(){b("#shell-dialog").modal({scrollableContentStyle:"scrollable",header:false,footer:false,responsive:{x:false,y:false}});b("#shell-close-button").click(function(){b("#shell-dialog").modal("hide")});b("#shell-undock-button").click(function(){var f=b("#shell-iframe").attr("src");if(!e.isBlank(f)){window.open(f);b("#shell-dialog").modal("hide")}})});var d=null;var c=null;var a=null;return{init:function(f){a=f},resizeContent:function(f){var g=f.find(".shell-content-container");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:content:resize")},resizeIframe:function(f){var g=f.find("#shell-iframe");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:iframe:resize")},showPage:function(f,g){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(h){var i=b("#shell");if(e.isNull(g)||e.isUndefined(g)){g=true}b("#shell-dialog").modal("setCloseHandler",function(){i.empty();h.resolve()});b("#shell-dialog").modal("setOpenHandler",function(){e.toggleScrollable(b("#"+this.find(".tab-container").attr("id")+"-content").get(0))});b("#shell-dialog").modal("show");if(g){b("#shell-undock-button").show()}else{b("#shell-undock-button").hide()}var j=b("<iframe/>",{id:"shell-iframe",frameBorder:"0",src:f}).css({width:i.width(),height:i.height()-28}).appendTo(i)}).promise()},showContent:function(f){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(g){var k=b(f);if(k.length){var h=b("#shell");var j=k.parent();k.detach();b("#shell-dialog").modal("setCloseHandler",function(){var m=b(".combo");for(var n=0,l=m.length;n<l;n++){if(b(m[n]).is(":visible")){b(m[n]).combo("close")}}g.resolve();k.hide().detach().appendTo(j);h.empty()});b("#shell-undock-button").hide();b("#shell-dialog").modal("show");var i=b("<div>").addClass("shell-content-container").css({width:h.width(),height:h.height()}).append(k).appendTo(h);k.show()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Clipboard=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Clipboard=b(require("jquery"),require("nf.Common")))}else{nf.Clipboard=b(a.$,a.nf.Common)}}}(this,function(e,f){var a="copy";var d="paste";var c=null;var b={};return{addListener:function(h,g){b[h]=g},removeListener:function(g){if(f.isDefinedAndNotNull(b[g])){delete b[g]}},copy:function(h){c=h;for(var g in b){b[g].call(g,a,c)}},isCopied:function(){return f.isDefinedAndNotNull(c)},paste:function(){return e.Deferred(function(g){if(f.isDefinedAndNotNull(c)){var i=c;g.resolve(i);c=null;for(var h in b){b[h].call(h,d,i)}}else{g.reject()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Client"],function(f,g,c,e,d){return(nf.CustomUi=b(f,g,c,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Client)}}}(this,function(d,e,a,c,b){return{showCustomUi:function(f,h,g){return d.Deferred(function(i){e.getAccessToken("../nifi-api/access/ui-extension-token").done(function(k){d("#shell-close-button");var j=b.getRevision(f);var l={id:f.id,revision:j.version,clientId:j.clientId,editable:g};if(!e.isBlank(k)){l.access_token=k}a.showPage(".."+h+"?"+d.param(l),false).done(function(){i.resolve()})}).fail(function(){c.showOkDialog({headerText:"Advanced Configuration",dialogContent:"Unable to generate access token for accessing the advanced configuration dialog."});i.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","jquery","nf.Common","nf.ErrorHandler","nf.Dialog","nf.Clipboard","nf.Storage"],function(e,g,h,i,f,d,c){return(nf.CanvasUtils=b(e,g,h,i,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CanvasUtils=b(require("d3"),require("jquery"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Clipboard"),require("nf.Storage")))}else{nf.CanvasUtils=b(a.d3,a.$,a.nf.Common,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Clipboard,a.nf.Storage)}}}(this,function(p,a,f,d,i,e,c){var q;var m;var l;var g;var b;var o={storage:{namePrefix:"nifi-view-"},urls:{controller:"../nifi-api/controller"}};var h=2000;var n=2*Math.PI;var j=function(w,u){var t=0;var x=w-1;var v;var s=0;while(t<=x){v=~~((t+x)/2);s=u(v);if(s<0){x=v-1}else{if(s>0){t=v+1}else{break}}}return v};var r=function(t,s){return a.Deferred(function(v){var u=k.getGroupId();var w=l.marshal(t,u);l.create(w).done(function(x){l.move(x.snippet.id,s).done(function(){var z=p.map();var y=function(A,B){if(!z.has(A)){z.set(A,[])}z.get(A).push(B)};t.each(function(A){y(A.type,A.id)});z.forEach(function(B,A){k.getComponentByType(B).remove(A)});g.refresh();v.resolve()}).fail(d.handleAjaxError).fail(function(){v.reject()})}).fail(d.handleAjaxError).fail(function(){v.reject()})}).promise()};var k={init:function(w,u,t,v,s){q=w;m=u;l=t;g=v;b=s},config:{systemTooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:false},hide:{effect:false},position:{at:"bottom right",my:"top left"}}},getComponentByType:function(s){return b.getComponentByType(s)},getPerimeterPoint:function(s,B){var t=Math.atan2(B.height,B.width);var y=B.width/2;var x=B.height/2;var w=B.x+y;var u=B.y+x;var C=s.x-w;var A=s.y-u;var v=Math.atan2(A,C);v=v%n;if(v<0){v+=n}var z=(Math.PI/2)-v;if((v>=0&&v<t)||(v>=(n-t)&&v<n)){return{x:B.x+B.width,y:u+Math.tan(v)*y}}else{if(v>=t&&v<(Math.PI-t)){return{x:w+Math.tan(z)*x,y:B.y+B.height}}else{if(v>=(Math.PI-t)&&v<(Math.PI+t)){return{x:B.x,y:u-Math.tan(v)*y}}else{return{x:w-Math.tan(z)*x,y:B.y}}}}},queryBulletins:function(u){var s=[];var t=function(y){var w=new URL(window.location);var A=w.origin+"/nifi-api/flow/bulletin-board?"+a.param({sourceId:y.join("|")});if(A.length>h){var v=Math.ceil(y.length/2);var z=y.slice(0,v);if(z.length>0){t(z)}var x=y.slice(v);if(x.length>0){t(x)}}else{s.push(a.ajax({type:"GET",url:A,dataType:"json"}))}};t(u);if(s.length===1){return a.Deferred(function(v){s[0].done(function(w){v.resolve(w)}).fail(function(){v.reject()}).fail(d.handleAjaxError)}).promise()}else{return a.Deferred(function(v){a.when.apply(window,s).done(function(){var x=a.makeArray(arguments);var w=null;var y=[];a.each(x,function(B,z){var A=z[0];var C=A.bulletinBoard;if(w===null){w=C.generated}Array.prototype.push.apply(y,C.bulletins)});y.sort(function(A,z){return z.id-A.id});v.resolve({bulletinBoard:{generated:w,bulletins:y}})}).fail(function(){v.reject()}).fail(d.handleAjaxError)}).promise()}},showComponent:function(t,s){if(f.isDefinedAndNotNull(t)){var u=a.Deferred(function(v){if(t!==q.getGroupId()){q.setGroupId(t);q.reload().done(function(){v.resolve()}).fail(function(y,w,x){i.showOkDialog({headerText:"Error",dialogContent:"Unable to load the group for the specified component."});v.reject(y,w,x)})}else{v.resolve()}}).promise();u.done(function(){var v=p.select("#id-"+s);if(!v.empty()){m.show(v)}else{i.showOkDialog({headerText:"Error",dialogContent:"Unable to find the specified component."})}});return u}else{return a.Deferred(function(v){v.reject()}).promise()}},showDeepLink:function(s){k.getSelection().classed("selected",false);if(a("#nf-ok-dialog").is(":visible")===true){a("#nf-ok-dialog").modal("hide")}if("URLSearchParams" in window){var v=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(v)){v=new URLSearchParams(new URL(window.location).search)}var t=k.getGroupId();if(nf.Common.isDefinedAndNotNull(v)){var u=[];if(v.get("processGroupId")){t=v.get("processGroupId")}if(v.get("componentIds")){u=v.get("componentIds").split(",")}if(u.length>=1){return k.showComponents(t,u,s)}else{return k.getComponentByType("ProcessGroup").enterGroup(t)}}else{return k.getComponentByType("ProcessGroup").enterGroup(t)}}},showComponents:function(t,v,s){if(f.isDefinedAndNotNull(t)){var u=a.Deferred(function(w){if(t!==q.getGroupId()||s){q.setGroupId(t);q.reload().done(function(){w.resolve()}).fail(function(z,x,y){i.showOkDialog({headerText:"Error",dialogContent:"Unable to enter the selected group."});w.reject(z,x,y)})}else{w.resolve()}}).promise();u.done(function(){var w=p.selectAll("g.component, g.connection").filter(function(y){if(v.indexOf(y.id)>=0){v.splice(v.indexOf(y.id),1);return y}});if(v.length>0){var x=a("<p></p>").text("Specified component(s) not found: "+v.join(", ")+".").append("<br/><br/>").append(a("<p>Unable to select component(s).</p>"));i.showOkDialog({headerText:"Error",dialogContent:x})}m.show(w)});return u}},setURLParameters:function(u,v){if("URLSearchParams" in window){if(!f.isDefinedAndNotNull(u)){u=k.getGroupId()}if(!f.isDefinedAndNotNull(v)){v=k.getSelection()}var s=[];v.each(function(y){s.push(y.id)});var t=new URL(window.location);var x=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(x)){x=new URLSearchParams(t.search)}if(nf.Common.isDefinedAndNotNull(x)){var x=new URLSearchParams(t.search);x.set("processGroupId",u);x.set("componentIds",s.sort());var w=t.origin+t.pathname;if(f.isDefinedAndNotNull(k.getParentGroupId())||s.length>0){if(!f.isDefinedAndNotNull(k.getParentGroupId())){x.set("processGroupId","root")}if((t.origin+t.pathname+"?"+x.toString()).length<=h){w=t.origin+t.pathname+"?"+x.toString()}else{if(f.isDefinedAndNotNull(k.getParentGroupId())){x.set("componentIds","");w=t.origin+t.pathname+"?"+x.toString()}}}window.history.replaceState({previous_url:t.href},window.document.title,w)}}},getSelection:function(){return p.selectAll("g.component.selected, g.connection.selected")},centerBoundingBox:function(t){var v=q.View.scale();var x=a("#canvas-container");var u=x.width()/v;var w=x.height()/v;var s=[(u/2)-(t.width/2),(w/2)-(t.height/2)];q.View.translate([(s[0]-t.x)*v,(s[1]-t.y)*v])},editable:function(s,t,u){if(k.canModify(s)){if(!s.classed("connectable")){s.call(t.activate)}if(!s.classed("moveable")){s.call(u.activate)}}else{if(s.classed("connectable")){s.call(t.deactivate)}if(s.classed("moveable")){s.call(u.deactivate)}}},transition:function(s,t){if(t&&!s.empty()){return s.transition().duration(400)}else{return s}},position:function(s,t){if(s.empty()){return}return k.transition(s,t).attr("transform",function(u){return"translate("+u.position.x+", "+u.position.y+")"})},ellipsis:function(u,w){w=w.trim();var t=parseInt(u.attr("width"),10);var v=u.node();u.text(w);if(w.length>0&&v.getSubStringLength(0,w.length-1)>t){t-=5;var s=j(w.length,function(y){var z=v.getSubStringLength(0,y);if(z>t){return -1}else{if(z<t){return 1}}return 0});u.text(w.substring(0,s)+String.fromCharCode(8230))}},multilineEllipsis:function(B,E,D){var u=1;var v=D.split(/\s+/).reverse();var A=parseInt(B.attr("x"),10);var z=parseInt(B.attr("y"),10);var t=parseInt(B.attr("width"),10);var F=[];var w=B.append("tspan").attr({x:A,y:z,width:t});var s=v.pop();while(f.isDefinedAndNotNull(s)){F.push(s);w.text(F.join(" "));if(w.node().getComputedTextLength()>t){F.pop();w.text(F.join(" "));w=B.append("tspan").attr({x:A,dy:"1.2em",width:t});if(++u>=E){var C=[s].concat(v.reverse());k.ellipsis(w,C.join(" "));break}else{w.text(s);F=[s]}}s=v.pop()}},activeThreadCount:function(s,u,v){if(u.status.aggregateSnapshot.activeThreadCount>0){var t=s.select("text.active-thread-count").text(function(){return u.status.aggregateSnapshot.activeThreadCount}).style("display","block").each(function(){var w=this.getBBox();p.select(this).attr("x",function(){return u.dimensions.width-w.width-15})});s.select("text.active-thread-count-icon").attr("x",function(){var w=t.node().getBBox();if(typeof v==="function"){v(w.width+6)}return u.dimensions.width-w.width-20}).style("display","block")}else{s.selectAll("text.active-thread-count, text.active-thread-count-icon").style("display","none")}},disableImageHref:function(s){s.on("click.disableImageHref",function(){if(p.event.ctrlKey||p.event.shiftKey){p.event.preventDefault()}})},bulletins:function(s,y,z,x){x=f.isDefinedAndNotNull(x)?x:0;var v=p.select("#bulletin-tip-"+y.id);var u=false;if(!f.isEmpty(y.bulletins)){var w=f.getFormattedBulletins(y.bulletins);u=w.length>0;if(u){var t=f.formatUnorderedList(w)}}if(u){s.select("text.bulletin-icon").each(function(){if(v.empty()){v=z().append("div").attr("id",function(){return"bulletin-tip-"+y.id}).attr("class","tooltip nifi-tooltip")}v.html(function(){return a("<div></div>").append(t).html()});k.canvasTooltip(v,p.select(this))});s.select("text.bulletin-icon").style("visibility","visible");s.select("rect.bulletin-background").style("visibility","visible")}else{if(!v.empty()){v.remove()}s.select("text.bulletin-icon").style("visibility","hidden");s.select("rect.bulletin-background").style("visibility","hidden")}},canvasTooltip:function(s,t){t.on("mouseenter",function(){s.style("top",(p.event.pageY+15)+"px").style("left",(p.event.pageX+15)+"px").style("display","block")}).on("mousemove",function(){s.style("top",(p.event.pageY+15)+"px").style("left",(p.event.pageX+15)+"px")}).on("mouseleave",function(){s.style("display","none")})},canAlign:function(u){var t=true;var s=u.filter(function(w){var v=p.select(this);return k.isConnection(v)});if(u.size()-s.size()<2){t=false}if(k.canModify(u)===false){t=false}return t},isColorable:function(u){if(u.empty()){return false}if(k.canRead(u)===false||k.canModify(u)===false){return false}var t=u.filter(function(y){var x=p.select(this);return k.isProcessor(x)&&k.canModify(x)});var w=u.filter(function(y){var x=p.select(this);return k.isLabel(x)&&k.canModify(x)});var s=t.size()===u.size();var v=w.size()===u.size();return s||v},isConnection:function(s){return s.classed("connection")},isRemoteProcessGroup:function(s){return s.classed("remote-process-group")},isProcessor:function(s){return s.classed("processor")},isLabel:function(s){return s.classed("label")},isInputPort:function(s){return s.classed("input-port")},isOutputPort:function(s){return s.classed("output-port")},isProcessGroup:function(s){return s.classed("process-group")},isFunnel:function(s){return s.classed("funnel")},areRunnable:function(s){if(s.empty()){return true}var t=true;s.each(function(){if(!k.isRunnable(p.select(this))){t=false;return false}});return t},isRunnable:function(s){if(s.size()!==1){return false}if(k.isProcessGroup(s)){return true}if(k.canModify(s)===false){return false}var u=false;var t=s.datum();if(k.isProcessor(s)||k.isInputPort(s)||k.isOutputPort(s)){u=k.supportsModification(s)&&t.status.aggregateSnapshot.runStatus==="Stopped"}return u},areStoppable:function(s){if(s.empty()){return true}var t=true;s.each(function(){if(!k.isStoppable(p.select(this))){t=false;return false}});return t},isStoppable:function(s){if(s.size()!==1){return false}if(k.isProcessGroup(s)){return true}if(k.canModify(s)===false){return false}var u=false;var t=s.datum();if(k.isProcessor(s)||k.isInputPort(s)||k.isOutputPort(s)){u=t.status.aggregateSnapshot.runStatus==="Running"}return u},filterEnable:function(s){return s.filter(function(v){var t=p.select(this);var u=t.datum();return((k.isProcessor(t)||k.isInputPort(t)||k.isOutputPort(t))&&k.supportsModification(t)&&u.status.aggregateSnapshot.runStatus==="Disabled")})},canEnable:function(s){if(s.empty()){return false}if(k.canModify(s)===false){return false}return k.filterEnable(s).size()===s.size()},filterDisable:function(s){return s.filter(function(v){var t=p.select(this);var u=t.datum();return((k.isProcessor(t)||k.isInputPort(t)||k.isOutputPort(t))&&k.supportsModification(t)&&(u.status.aggregateSnapshot.runStatus==="Stopped"||u.status.aggregateSnapshot.runStatus==="Invalid"))})},canDisable:function(s){if(s.empty()){return false}if(k.canModify(s)===false){return false}return k.filterDisable(s).size()===s.size()},canAllStartTransmitting:function(s){if(s.empty()){return false}var t=true;s.each(function(){if(!k.canStartTransmitting(p.select(this))){t=false}});return t},canStartTransmitting:function(s){if(s.size()!==1){return false}if(k.canModify(s)===false||k.canRead(s)===false){return false}return k.isRemoteProcessGroup(s)},canAllStopTransmitting:function(s){if(s.empty()){return false}var t=true;s.each(function(){if(!k.canStopTransmitting(p.select(this))){t=false}});return t},canStopTransmitting:function(s){if(s.size()!==1){return false}if(k.canModify(s)===false||k.canRead(s)===false){return false}return k.isRemoteProcessGroup(s)},areDeletable:function(s){if(s.empty()){return false}var t=true;s.each(function(){if(!k.isDeletable(p.select(this))){t=false}});return t},isDeletable:function(s){if(s.size()!==1){return false}if(q.canWrite()===false){return false}if(k.canModify(s)===false){return false}return k.supportsModification(s)},isConfigurable:function(s){if(s.size()!==1){if(s.empty()){return true}else{return false}}if(k.isProcessGroup(s)){return true}if(k.canRead(s)===false||k.canModify(s)===false){return false}if(k.isFunnel(s)){return false}return k.supportsModification(s)},hasDetails:function(s){if(s.size()!==1){return false}if(k.canRead(s)===false){return false}if(k.canModify(s)){if(k.isProcessor(s)||k.isInputPort(s)||k.isOutputPort(s)||k.isRemoteProcessGroup(s)||k.isConnection(s)){return !k.isConfigurable(s)}}else{return k.isProcessor(s)||k.isConnection(s)||k.isInputPort(s)||k.isOutputPort(s)||k.isRemoteProcessGroup(s)}return false},canManagePolicies:function(){var s=k.getSelection();if(s.size()<=1){if(!s.empty()&&k.isConnection(s)){return false}return f.canAccessTenants()}return false},canModify:function(u){var t=u.size();var s=u.filter(function(v){return v.permissions.canWrite}).size();return t===s},canRead:function(t){var s=t.size();var u=t.filter(function(v){return v.permissions.canRead}).size();return s===u},supportsModification:function(z){if(z.size()!==1){return false}var x=z.datum();var v=false;if(k.isProcessor(z)||k.isInputPort(z)||k.isOutputPort(z)){v=!(x.status.aggregateSnapshot.runStatus==="Running"||x.status.aggregateSnapshot.activeThreadCount>0)}else{if(k.isRemoteProcessGroup(z)){v=!(x.status.transmissionStatus==="Transmitting"||x.status.aggregateSnapshot.activeThreadCount>0)}else{if(k.isProcessGroup(z)){v=true}else{if(k.isFunnel(z)){v=true}else{if(k.isLabel(z)){v=true}else{if(k.isConnection(z)){var y=false;var t=false;var A=k.getConnectionSourceComponentId(x);var s=p.select("#id-"+A);if(!s.empty()){if(k.isRemoteProcessGroup(s)||k.isProcessGroup(s)){y=true}else{y=k.supportsModification(s)}}var u=k.getConnectionDestinationComponentId(x);var w=p.select("#id-"+u);if(!w.empty()){if(k.isRemoteProcessGroup(w)||k.isProcessGroup(w)){t=true}else{t=k.supportsModification(w)}}v=y&&t}}}}}}return v},getConnectableTypeForSource:function(t){var s;if(k.isProcessor(t)){s="PROCESSOR"}else{if(k.isRemoteProcessGroup(t)){s="REMOTE_OUTPUT_PORT"}else{if(k.isProcessGroup(t)){s="OUTPUT_PORT"}else{if(k.isInputPort(t)){s="INPUT_PORT"}else{if(k.isFunnel(t)){s="FUNNEL"}}}}}return s},getConnectableTypeForDestination:function(t){var s;if(k.isProcessor(t)){s="PROCESSOR"}else{if(k.isRemoteProcessGroup(t)){s="REMOTE_INPUT_PORT"}else{if(k.isProcessGroup(t)){s="INPUT_PORT"}else{if(k.isOutputPort(t)){s="OUTPUT_PORT"}else{if(k.isFunnel(t)){s="FUNNEL"}}}}}return s},isCopyable:function(t){if(t.empty()){return false}if(k.canRead(t)===false){return false}var s=t.filter(function(x){var v=p.select(this);if(k.isConnection(v)){var u=!t.filter(function(y){var z=k.getConnectionSourceComponentId(x);return z===y.id}).empty();var w=!t.filter(function(y){var z=k.getConnectionDestinationComponentId(x);return z===y.id}).empty();return u&&w}else{return k.isProcessor(v)||k.isFunnel(v)||k.isLabel(v)||k.isProcessGroup(v)||k.isRemoteProcessGroup(v)||k.isInputPort(v)||k.isOutputPort(v)}});return t.size()===s.size()},isPastable:function(){return q.canWrite()&&e.isCopied()},persistUserView:function(){var s=o.storage.namePrefix+q.getGroupId();var u=q.View.translate();var t={scale:q.View.scale(),translateX:u[0],translateY:u[1]};c.setItem(s,t)},formatConnectionName:function(s){if(!f.isBlank(s.name)){return s.name}else{if(f.isDefinedAndNotNull(s.selectedRelationships)){return s.selectedRelationships.join(", ")}}return""},reloadConnectionSourceAndDestination:function(v,u){if(f.isBlank(v)===false){var t=p.select("#id-"+v);if(t.empty()===false){b.reload(t)}}if(f.isBlank(u)===false){var s=p.select("#id-"+u);if(s.empty()===false){b.reload(s)}}},getConnectionSourceComponentId:function(s){var t=s.sourceId;if(s.sourceGroupId!==q.getGroupId()){t=s.sourceGroupId}return t},getConnectionDestinationComponentId:function(s){var t=s.destinationId;if(s.destinationGroupId!==q.getGroupId()){t=s.destinationGroupId}return t},restoreUserView:function(){var u=false;try{var s=o.storage.namePrefix+q.getGroupId();var t=c.getItem(s);if(f.isDefinedAndNotNull(t)){if(isFinite(t.scale)&&isFinite(t.translateX)&&isFinite(t.translateY)){q.View.translate([t.translateX,t.translateY]);q.View.scale(t.scale);q.View.refresh({transition:true});u=true}}}catch(v){}return u},getOrigin:function(t){var s={};t.each(function(v){var u=p.select(this);if(!k.isConnection(u)){if(f.isUndefined(s.x)||v.position.x<s.x){s.x=v.position.x}if(f.isUndefined(s.y)||v.position.y<s.y){s.y=v.position.y}}});return s},moveComponentsToParent:function(t){var s=q.getParentGroupId();if(s===null){i.showOkDialog({headerText:"Process Group",dialogContent:"Components are already in the topmost group."})}else{r(t,s)}},moveComponents:function(t,u){var s=u.datum();r(t,s.id).done(function(){k.getComponentByType("ProcessGroup").reload(s.id)})},trimDanglingEdges:function(s){var t=function(u){var y=k.getConnectionSourceComponentId(u);var x=k.getConnectionDestinationComponentId(u);var w=false;var v=false;s.each(function(z){if(z.id===y){w=true}if(z.id===x){v=true}});return w&&v};return s.filter(function(u){if(u.type==="Connection"){return t(u)}else{return true}})},isValidConnectionSource:function(s){if(s.size()!==1){return false}if(k.isProcessGroup(s)){return true}if(k.canRead(s)===false||k.canModify(s)===false){return false}return k.isProcessor(s)||k.isRemoteProcessGroup(s)||k.isInputPort(s)||k.isFunnel(s)},isValidConnectionDestination:function(t){if(t.size()!==1){return false}if(k.isProcessGroup(t)){return true}if(k.canModify(t)===false){return false}if(k.isRemoteProcessGroup(t)||k.isOutputPort(t)||k.isFunnel(t)){return true}if(k.isProcessor(t)){var s=t.datum();return s.inputRequirement!=="INPUT_FORBIDDEN"}},isManagedAuthorizer:function(){return q.isManagedAuthorizer()},isConfigurableAuthorizer:function(){return q.isConfigurableAuthorizer()},isConfigurableUsersAndGroups:function(){return q.isConfigurableUsersAndGroups()},setGroupId:function(s){return q.setGroupId(s)},getGroupId:function(){return q.getGroupId()},getGroupName:function(){return q.getGroupName()},getParentGroupId:function(){return q.getParentGroupId()},reload:function(){return q.reload({transition:true})},canReadCurrentGroup:function(){return q.canRead()},canWriteCurrentGroup:function(){return q.canWrite()},refreshCanvasView:function(s){return q.View.refresh(s)},scaleCanvasView:function(s){return q.View.scale(s)},translateCanvasView:function(s){return q.View.translate(s)},fitCanvasView:function(){return q.View.fit()},zoomCanvasViewIn:function(){return q.View.zoomIn()},zoomCanvasViewOut:function(){return q.View.zoomOut()},actualSizeCanvasView:function(){return q.View.actualSize()},shouldRenderPerScale:function(){return q.View.shouldRenderPerScale()},getCanvasOffset:function(){return q.CANVAS_OFFSET}};return k}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.CanvasUtils"],function(d,e,c){return(nf.GoTo=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.GoTo=b(require("jquery"),require("nf.ErrorHandler"),require("nf.CanvasUtils")))}else{nf.GoTo=b(a.$,a.nf.ErrorHandler,a.nf.CanvasUtils)}}}(this,function(h,j,e){var b={urls:{api:"../nifi-api",processGroups:"../nifi-api/flow/process-groups/"}};var a;var f;var c=function(u,q,r,p){var o=h('<div class="source-destination-connection"></div>').appendTo("#connections-container");if(q.sourceType==="OUTPUT_PORT"){d(u,o,q,r)}else{if(q.sourceType==="REMOTE_OUTPUT_PORT"){i(u,o,q,p)}else{g(o,q)}}var t=h('<div class="connection-entry"></div>').appendTo(o);var w="unset";var s="Connection";if(q.permissions.canRead===true){var v=e.formatConnectionName(q.component);if(v!==""){w="";s=v}}h('<div class="search-result-icon icon-connect"></div>').appendTo(t);h('<div class="connection-entry-name go-to-link"></div>').attr("title",s).addClass(w).text(s).on("click",function(){e.showComponent(u,q.id);h("#connections-dialog").modal("hide")}).appendTo(t);h('<div class="clear"></div>').appendTo(t);if(q.destinationType==="INPUT_PORT"){l(u,o,q,r)}else{if(q.destinationType==="REMOTE_INPUT_PORT"){k(u,o,q,p)}else{m(o,q)}}h('<div class="clear"></div>').appendTo(o)};var m=function(o,p){var q="icon-funnel";if(p.destinationType==="PROCESSOR"){q="icon-processor"}else{if(p.destinationType==="OUTPUT_PORT"){q="icon-port-out"}}var r=p.destinationId;if(p.permissions.canRead===true){r=p.component.destination.name}else{if(a===p.destinationId){r=f}}var s=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(q).appendTo(s);h('<div class="destination-component-name go-to-link"></div>').attr("title",r).text(r).on("click",function(){e.showComponent(p.destinationGroupId,p.destinationId);h("#connections-dialog").modal("hide")}).appendTo(s);h('<div class="clear"></div>').appendTo(s)};var l=function(w,p,s,t){var v;h.each(t,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var o=n(v);var r=h('<div class="destination-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(r);h('<div class="destination-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(w,v.id);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r);var u=s.destinationId;if(s.permissions.canRead===true){u=s.component.destination.name}else{if(a===s.destinationId){u=f}}var q=h('<div class="destination-input-port"></div>').appendTo(r);h('<div class="search-result-icon icon-port-in"></div>').appendTo(q);h('<div class="destination-input-port-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(s.destinationGroupId,s.destinationId);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(r)};var k=function(t,o,s,r){var v;h.each(r,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var u=n(v);var q=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="destination-component-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(t,v.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var w=s.destinationId;if(s.permissions.canRead===true){w=s.component.destination.name}else{if(a===s.destinationId){w=f}}var p=h('<div class="destination-input-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-in"></div>').appendTo(p);h('<div class="destination-input-port-name"></div>').attr("title",w).text(w).appendTo(p);h('<div class="clear"></div>').appendTo(q)};var g=function(o,q){var s="icon-funnel";if(q.sourceType==="PROCESSOR"){s="icon-processor"}else{if(q.sourceType==="INPUT_PORT"){s="icon-port-in"}}var p=q.sourceId;if(q.permissions.canRead===true){p=q.component.source.name}else{if(a===q.sourceId){p=f}}var r=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(s).appendTo(r);h('<div class="source-component-name go-to-link"></div>').attr("title",p).text(p).on("click",function(){e.showComponent(q.sourceGroupId,q.sourceId);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r)};var d=function(v,p,r,s){var u;h.each(s,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var o=n(u);var q=h('<div class="source-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(v,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var t=r.sourceId;if(r.permissions.canRead===true){t=r.component.source.name}else{if(a===r.sourceId){t=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(r.sourceGroupId,r.sourceId);h("#connections-dialog").modal("hide")}).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var i=function(s,o,r,p){var u;h.each(p,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var t=n(u);var q=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(s,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var v=r.sourceId;if(r.permissions.canRead===true){v=r.component.source.name}else{if(r.sourceId===a){v=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name"></div>').attr("title",v).text(v).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var n=function(o){if(o.permissions.canRead===true){return o.component.name}else{if(a===o.id){return f}else{return o.id}}};return{init:function(){h("#connections-dialog").modal({scrollableContentStyle:"scrollable",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){h("#connections-dialog").modal("hide")}}}],handler:{close:function(){h("#connections-context").empty();h("#connections-container").empty()}}})},showDownstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.sourceId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.destinationId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.sourceGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.destinationGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromInputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-in"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.sourceId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromInputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-in" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.destinationId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}).fail(j.handleAjaxError)},showDownstreamFromOutputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-out" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.sourceId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")}).fail(j.handleAjaxError)},showUpstreamFromOutputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-out"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.destinationId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="connections-component-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.sourceId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="upstream-destination-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.destinationId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Client"],function(f,e,d,c){return(nf.Snippet=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Snippet=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Client")))}else{nf.Snippet=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Client)}}}(this,function(e,d,c,b){var a={urls:{snippets:"../nifi-api/snippets",processGroups:"../nifi-api/process-groups"}};return{marshal:function(g,f){var h={parentGroupId:f,processors:{},funnels:{},inputPorts:{},outputPorts:{},remoteProcessGroups:{},processGroups:{},connections:{},labels:{}};g.each(function(j){var i=d.select(this);if(c.isProcessor(i)){h.processors[j.id]=b.getRevision(i.datum())}else{if(c.isFunnel(i)){h.funnels[j.id]=b.getRevision(i.datum())}else{if(c.isLabel(i)){h.labels[j.id]=b.getRevision(i.datum())}else{if(c.isInputPort(i)){h.inputPorts[j.id]=b.getRevision(i.datum())}else{if(c.isOutputPort(i)){h.outputPorts[j.id]=b.getRevision(i.datum())}else{if(c.isProcessGroup(i)){h.processGroups[j.id]=b.getRevision(i.datum())}else{if(c.isRemoteProcessGroup(i)){h.remoteProcessGroups[j.id]=b.getRevision(i.datum())}else{if(c.isConnection(i)){h.connections[j.id]=b.getRevision(i.datum())}}}}}}}}});return h},create:function(g){var f={snippet:g};return e.ajax({type:"POST",url:a.urls.snippets,data:JSON.stringify(f),dataType:"json",contentType:"application/json"})},copy:function(h,f,i){var g={snippetId:h,originX:f.x,originY:f.y};return e.ajax({type:"POST",url:a.urls.processGroups+"/"+encodeURIComponent(i)+"/snippet-instance",data:JSON.stringify(g),dataType:"json",contentType:"application/json"})},remove:function(f){return e.ajax({type:"DELETE",url:a.urls.snippets+"/"+encodeURIComponent(f)})},move:function(g,h){var f={snippet:{id:g,parentGroupId:h}};return e.ajax({type:"PUT",url:a.urls.snippets+"/"+encodeURIComponent(g),data:JSON.stringify(f),dataType:"json",contentType:"application/json"})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler","nf.Client","nf.CanvasUtils"],function(g,e,h,f,i,c,d){return(nf.Connection=b(g,e,h,f,i,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connection=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Connection=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(C,N,L,i,d,f,R){var m;var r;var K;var y;var I={width:200};var g=(I.width/2)-15-2;var Q=function(W){var Y=W.datum();var V,Z;if(Y.bends.length>0){var X=Math.min(Math.max(0,Y.labelIndex),Y.bends.length-1);V=Y.bends[X].x;Z=Y.bends[X].y}else{V=(Y.start.x+Y.end.x)/2;Z=(Y.start.y+Y.end.y)/2}V-=(I.width/2);Z-=(W.attr("height")/2);return{x:V,y:Z}};var o;var z;var w;var q;var T;var O;var s;var A;var j=function(W,V){return Math.pow(W.x-V.x,2)+Math.pow(W.y-V.y,2)};var t=function(W,V){return Math.sqrt(j(W,V))};var F=function(Z,Y,W){var V=j(Y,W);if(V===0){return Math.sqrt(j(Z,Y))}var X=((Z.x-Y.x)*(W.x-Y.x)+(Z.y-Y.y)*(W.y-Y.y))/V;if(X<0){return Math.sqrt(j(Z,Y))}if(X>1){return Math.sqrt(j(Z,W))}return Math.sqrt(j(Z,{x:Y.x+X*(W.x-Y.x),y:Y.y+X*(W.y-Y.y)}))};var b=function(Z,ab){if(ab.bends.length===0){return 0}var X;var W;var V=[ab.start].concat(ab.bends,[ab.end]);for(var Y=0;Y<V.length;Y++){if(Y+1<V.length){var aa=F(Z,V[Y],V[Y+1]);if(L.isUndefined(X)||aa<X){X=aa;W=Y}}}return W};var E=function(V){return V.indexOf("INPUT_PORT")>=0};var x=function(V){return V.indexOf("OUTPUT_PORT")>=0};var J=function(V){return V.groupId!==R.getGroupId()&&(E(V.type)||x(V.type))};var n=function(V){if(L.isDefinedAndNotNull(V.flowFileExpiration)){var W=V.flowFileExpiration.match(/^(\d+).*/);if(W!==null&&W.length>0){if(parseInt(W[0],10)>0){return true}}}return false};var S=function(V){V.sort(function(X,W){return X.zIndex===W.zIndex?0:X.zIndex>W.zIndex?1:-1})};var M=function(){return q.selectAll("g.connection").data(o.values(),function(V){return V.id})};var P=function(X,W){if(X.empty()){return}var V=X.append("g").attr({id:function(Y){return"id-"+Y.id},"class":"connection"}).classed("selected",W);V.append("path").attr({"class":"connection-path","pointer-events":"none"});V.append("path").attr({"class":"connection-selection-path","pointer-events":"none"});V.append("path").attr({"class":"connection-path-selectable","pointer-events":"stroke"}).on("mousedown.selection",function(){m.select(N.select(this.parentNode));R.setURLParameters()}).call(y.activate)};var v=function(W){var V=false;if(L.isDefinedAndNotNull(W.component.selectedRelationships)&&L.isDefinedAndNotNull(W.component.availableRelationships)){C.each(W.component.selectedRelationships,function(X,Y){if(C.inArray(Y,W.component.availableRelationships)===-1){V=true;return false}})}return V};var p=function(W){var V="normal";if(W.permissions.canRead){if(H(W)||l(W)){V="full"}else{if(v(W)){V="ghost"}}}else{V="unauthorized"}return"url(#"+V+")"};var c=function(V){if(l(V)||H(V)){return"url(#connection-full-drop-shadow)"}else{return"url(#component-drop-shadow)"}};var l=function(V){return V.status.aggregateSnapshot.percentUseCount===100};var e=function(W){var V=W.status.aggregateSnapshot.percentUseCount;if(L.isDefinedAndNotNull(V)){return V>=61&&V<=85}return false};var k=function(W){var V=W.status.aggregateSnapshot.percentUseCount;if(L.isDefinedAndNotNull(V)){return V>85}return false};var H=function(V){return V.status.aggregateSnapshot.percentUseBytes===100};var B=function(W){var V=W.status.aggregateSnapshot.percentUseBytes;if(L.isDefinedAndNotNull(V)){return V>=61&&V<=85}return false};var G=function(W){var V=W.status.aggregateSnapshot.percentUseBytes;if(L.isDefinedAndNotNull(V)){return V>85}return false};var a=function(V,W){if(V.empty()){return}var X=true;var Y=true;var Z=false;if(L.isDefinedAndNotNull(W)){X=L.isDefinedAndNotNull(W.updatePath)?W.updatePath:X;Y=L.isDefinedAndNotNull(W.updateLabel)?W.updateLabel:Y;Z=L.isDefinedAndNotNull(W.transition)?W.transition:Z}if(X===true){V.classed("grouped",function(ab){var aa=false;if(ab.permissions.canRead){if(L.isDefinedAndNotNull(ab.component.selectedRelationships)&&ab.component.selectedRelationships.length>1){aa=true}}return aa}).classed("ghost",function(ab){var aa=false;if(ab.permissions.canRead){if(v(ab)){aa=true}}return aa});V.select("path.connection-path").classed("unauthorized",function(aa){return aa.permissions.canRead===false});V.select("path.connection-path-selectable").on("dblclick",function(af){if(af.permissions.canWrite&&af.permissions.canRead){var aa=N.mouse(this.parentNode);var ad=b({x:aa[0],y:aa[1]},af);var ac=af.component.bends.slice();ac.splice(ad,0,{x:aa[0],y:aa[1]});var ab={id:af.id,bends:ac};var ae=af.component.labelIndex;if(ac.length===1){ab.labelIndex=0}else{if(ad<=ae){ab.labelIndex=ae+1}}u(af,ab);N.event.stopPropagation()}else{return null}})}V.each(function(aC){var at=N.select(this);if(X===true){var aB=R.getConnectionSourceComponentId(aC);var ag=N.select("#id-"+aB).datum();var ah;var ao;if(aC.bends.length>0){ao=aC.bends[aC.bends.length-1]}else{ao={x:ag.position.x+(ag.dimensions.width/2),y:ag.position.y+(ag.dimensions.height/2)}}if(L.isDefinedAndNotNull(aC.end)&&aC.end.dragging===true){ah=aC.end;var aD=N.select("g.hover.connectable-destination");if(!aD.empty()){var ax=aD.datum();var aa=R.getPerimeterPoint(ao,{x:ax.position.x,y:ax.position.y,width:ax.dimensions.width,height:ax.dimensions.height});ah.x=aa.x;ah.y=aa.y}}else{var ac=R.getConnectionDestinationComponentId(aC);var aF=N.select("#id-"+ac).datum();ah=R.getPerimeterPoint(ao,{x:aF.position.x,y:aF.position.y,width:aF.dimensions.width,height:aF.dimensions.height})}var aq;if(aC.bends.length>0){aq=aC.bends[0]}else{aq=ah}var ak=R.getPerimeterPoint(aq,{x:ag.position.x,y:ag.position.y,width:ag.dimensions.width,height:ag.dimensions.height});aC.start=ak;aC.end=ah;R.transition(at.select("path.connection-path"),Z).attr({d:function(){var aG=[aC.start].concat(aC.bends,[aC.end]);return A(aG)}});R.transition(at.select("path.connection-selection-path"),Z).attr({d:function(){var aG=[aC.start].concat(aC.bends,[aC.end]);return A(aG)}});R.transition(at.select("path.connection-path-selectable"),Z).attr({d:function(){var aG=[aC.start].concat(aC.bends,[aC.end]);return A(aG)}});var an=at.selectAll("rect.startpoint");var al=at.selectAll("rect.endpoint");var av=at.selectAll("rect.midpoint");if(aC.permissions.canWrite&&aC.permissions.canRead){an=an.data([aC.start]);an.enter().append("rect").attr({"class":"startpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(N.select(this.parentNode));R.setURLParameters()}).call(y.activate);R.transition(an,Z).attr("transform",function(aG){return"translate("+(aG.x-4)+", "+(aG.y-4)+")"});an.exit().remove();var al=al.data([aC.end]);al.enter().append("rect").call(O).attr({"class":"endpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(N.select(this.parentNode));R.setURLParameters()}).call(y.activate);R.transition(al,Z).attr("transform",function(aG){return"translate("+(aG.x-4)+", "+(aG.y-4)+")"});al.exit().remove();var av=av.data(aC.bends);av.enter().append("rect").attr({"class":"midpoint linepoint","pointer-events":"all",width:8,height:8}).call(T).on("dblclick",function(aJ){N.event.stopPropagation();var aG=N.select(this.parentNode);var aN=aG.datum();var aM=R.getConnectionSourceComponentId(aN);var aL=R.getConnectionDestinationComponentId(aN);if(aM===aL&&aC.component.bends.length<=2){i.showOkDialog({headerText:"Connection",dialogContent:"Looping connections must have at least two bend points."});return}var aI=[];var aH=-1;C.each(aN.component.bends,function(aP,aO){if(aJ.x!==aO.x&&aJ.y!==aO.y){aI.push(aO)}else{aH=aP}});if(aH<0){return}var aG={id:aN.id,bends:aI};var aK=aN.component.labelIndex;if(aI.length<=1){aG.labelIndex=0}else{if(aH<=aK){aG.labelIndex=Math.max(0,aK-1)}}u(aN,aG)}).on("mousedown.selection",function(){m.select(N.select(this.parentNode));R.setURLParameters()}).call(y.activate);R.transition(av,Z).attr("transform",function(aG){return"translate("+(aG.x-4)+", "+(aG.y-4)+")"});av.exit().remove()}else{an.remove();al.remove();av.remove()}}if(Y===true){var ai=at.select("g.connection-label-container");if(at.classed("visible")){if(ai.empty()){ai=at.insert("g","rect.startpoint").attr({"class":"connection-label-container","pointer-events":"all"}).on("mousedown.selection",function(){m.select(N.select(this.parentNode));R.setURLParameters()}).call(y.activate).call(K.activate);ai.append("rect").attr({"class":"body",width:I.width,x:0,y:0});ai.append("rect").attr({"class":"border",width:I.width,fill:"transparent",stroke:"transparent"})}var au=0;var ae=19;var aA=[];var aj=[];var ar=ai.select("g.connection-from-container");var aE=ai.select("g.connection-to-container");var aw=ai.select("g.connection-name-container");if(aC.permissions.canRead){if(J(aC.component.source)){if(ar.empty()){ar=ai.append("g").attr({"class":"connection-from-container"});aA.push(ar.append("rect").attr({"class":"connection-label-background",width:I.width,height:ae}));aj.push(ar.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));ar.append("text").attr({"class":"stats-label",x:5,y:14}).text("From");ar.append("text").attr({"class":"stats-value connection-from",x:43,y:14,width:130});ar.append("text").attr({"class":"connection-from-run-status",x:185,y:14})}else{aA.push(ar.select("rect.connection-label-background"));aj.push(ar.select("rect.connection-label-border"))}ar.attr("transform",function(){var aG=(ae*au++);return"translate(0, "+aG+")"});ar.select("text.connection-from").each(function(){var aG=N.select(this);aG.text(null).selectAll("title").remove();R.ellipsis(aG,aC.component.source.name)}).append("title").text(function(){return aC.component.source.name});ar.select("text.connection-from-run-status").text(function(){if(aC.component.source.exists===false){return"\uf071"}else{if(aC.component.source.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aC.component.source.exists===false){return false}else{return aC.component.source.running}}).classed("stopped",function(){if(aC.component.source.exists===false){return false}else{return !aC.component.source.running}}).classed("is-missing-port",function(){return aC.component.source.exists===false})}else{ar.remove()}if(J(aC.component.destination)){if(aE.empty()){aE=ai.append("g").attr({"class":"connection-to-container"});aA.push(aE.append("rect").attr({"class":"connection-label-background",width:I.width,height:ae}));aj.push(aE.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));aE.append("text").attr({"class":"stats-label",x:5,y:14}).text("To");aE.append("text").attr({"class":"stats-value connection-to",x:25,y:14,width:145});aE.append("text").attr({"class":"connection-to-run-status",x:185,y:14})}else{aA.push(aE.select("rect.connection-label-background"));aj.push(aE.select("rect.connection-label-border"))}aE.attr("transform",function(){var aG=(ae*au++);return"translate(0, "+aG+")"});aE.select("text.connection-to").each(function(aH){var aG=N.select(this);aG.text(null).selectAll("title").remove();R.ellipsis(aG,aH.component.destination.name)}).append("title").text(function(aG){return aG.component.destination.name});aE.select("text.connection-to-run-status").text(function(){if(aC.component.destination.exists===false){return"\uf071"}else{if(aC.component.destination.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aC.component.destination.exists===false){return false}else{return aC.component.destination.running}}).classed("stopped",function(){if(aC.component.destination.exists===false){return false}else{return !aC.component.destination.running}}).classed("is-missing-port",function(){return aC.component.destination.exists===false})}else{aE.remove()}var af=R.formatConnectionName(aC.component);if(!L.isBlank(af)){if(aw.empty()){aw=ai.append("g").attr({"class":"connection-name-container"});aA.push(aw.append("rect").attr({"class":"connection-label-background",width:I.width,height:ae}));aj.push(aw.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));aw.append("text").attr({"class":"stats-label",x:5,y:14}).text("Name");aw.append("text").attr({"class":"stats-value connection-name",x:45,y:14,width:142})}else{aA.push(aw.select("rect.connection-label-background"));aj.push(aw.select("rect.connection-label-border"))}aw.attr("transform",function(){var aG=(ae*au++);return"translate(0, "+aG+")"});aw.select("text.connection-name").each(function(){var aG=N.select(this);aG.text(null).selectAll("title").remove();R.ellipsis(aG,af)}).append("title").text(function(){return af})}else{aw.remove()}}else{ar.remove();aE.remove();aw.remove()}var az=3;var ab=ai.select("g.queued-container");if(ab.empty()){ab=ai.append("g").attr({"class":"queued-container"});aA.push(ab.append("rect").attr({"class":"connection-label-background",width:I.width,height:ae+az}));aj.push(ab.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));ab.append("text").attr({"class":"stats-label",x:5,y:14}).text("Queued");var ay=ab.append("text").attr({"class":"stats-value queued",x:55,y:14});ay.append("tspan").attr({"class":"count"});ay.append("tspan").attr({"class":"size"});ab.append("text").attr({"class":"expiration-icon",x:185,y:14}).text(function(){return"\uf017"}).append("title");var ad=ae+az-4;ab.append("rect").attr({"class":"backpressure-tick object",width:1,height:3,x:5,y:ad});var ap=6;ab.append("rect").attr({"class":"backpressure-object",width:g,height:3,x:ap,y:ad}).append("title");ab.append("rect").attr({"class":"backpressure-tick object",width:1,height:3,x:ap+g,y:ad});ab.append("rect").attr({"class":"backpressure-percent object",width:0,height:3,x:ap,y:ad});ab.append("rect").attr({"class":"backpressure-tick data-size",width:1,height:3,x:(I.width/2)+10,y:ad});var am=(I.width/2)+10+1;ab.append("rect").attr({"class":"backpressure-data-size",width:g,height:3,x:am,y:ad}).append("title");ab.append("rect").attr({"class":"backpressure-tick data-size",width:1,height:3,x:am+g,y:ad});ab.append("rect").attr({"class":"backpressure-percent data-size",width:0,height:3,x:am,y:ad})}else{aA.push(ab.select("rect.connection-label-background"));aj.push(ab.select("rect.connection-label-border"))}ab.attr("transform",function(){var aG=(ae*au++);return"translate(0, "+aG+")"});ai.select("rect.body").attr("height",function(){return(ae*au)+az}).classed("unauthorized",function(){return aC.permissions.canRead===false});ai.select("rect.border").attr("height",function(){return(ae*au)+az}).classed("unauthorized",function(){return aC.permissions.canRead===false});C.each(aA,function(aH,aG){if(aH%2===0){aG.attr("fill","#f4f6f7")}else{aG.attr("fill","#ffffff")}});C.each(aj,function(aH,aG){if(aH>0){aG.attr("fill","#c7d2d7")}else{aG.attr("fill","transparent")}});ai.select("text.expiration-icon").classed("hidden",function(){if(aC.permissions.canRead){return !n(aC.component)}else{return true}}).select("title").text(function(){if(aC.permissions.canRead){return"Expires FlowFiles older than "+aC.component.flowFileExpiration}else{return""}});ai.select("rect.backpressure-object").classed("not-configured",function(){return L.isUndefinedOrNull(aC.status.aggregateSnapshot.percentUseCount)});ai.selectAll("rect.backpressure-tick.object").classed("not-configured",function(){return L.isUndefinedOrNull(aC.status.aggregateSnapshot.percentUseCount)});ai.select("rect.backpressure-data-size").classed("not-configured",function(){return L.isUndefinedOrNull(aC.status.aggregateSnapshot.percentUseBytes)});ai.selectAll("rect.backpressure-tick.data-size").classed("not-configured",function(){return L.isUndefinedOrNull(aC.status.aggregateSnapshot.percentUseBytes)});if(aC.permissions.canWrite){ai.call(s)}at.call(D)}else{if(!ai.empty()){ai.remove()}}}R.transition(at.select("g.connection-label-container"),Z).attr("transform",function(){var aH=N.select(this).select("rect.body");var aG=Q(aH);return"translate("+aG.x+", "+aG.y+")"})})};var D=function(V){if(V.empty()){return}var W=C.Deferred(function(Y){V.select("text.queued tspan.count").text(function(aa){return L.substringBeforeFirst(aa.status.aggregateSnapshot.queued," ")});var Z=V.select("rect.backpressure-percent.data-size");Z.transition().duration(400).attr({width:function(aa){if(L.isDefinedAndNotNull(aa.status.aggregateSnapshot.percentUseBytes)){return(g*aa.status.aggregateSnapshot.percentUseBytes)/100}else{return 0}}}).each("end",function(){Z.classed("warning",function(aa){return B(aa)}).classed("error",function(aa){return G(aa)});Y.resolve()});V.select("rect.backpressure-data-size").select("title").text(function(aa){if(L.isDefinedAndNotNull(aa.status.aggregateSnapshot.percentUseBytes)){return"Queue is "+aa.status.aggregateSnapshot.percentUseBytes+"% full based on Back Pressure Data Size Threshold"}else{return"Back Pressure Data Size Threshold is not configured"}})}).promise();var X=C.Deferred(function(Y){V.select("text.queued tspan.size").text(function(aa){return" "+L.substringAfterFirst(aa.status.aggregateSnapshot.queued," ")});var Z=V.select("rect.backpressure-percent.object");Z.transition().duration(400).attr({width:function(aa){if(L.isDefinedAndNotNull(aa.status.aggregateSnapshot.percentUseCount)){return(g*aa.status.aggregateSnapshot.percentUseCount)/100}else{return 0}}}).each("end",function(){Z.classed("warning",function(aa){return e(aa)}).classed("error",function(aa){return k(aa)});Y.resolve()});V.select("rect.backpressure-object").select("title").text(function(aa){if(L.isDefinedAndNotNull(aa.status.aggregateSnapshot.percentUseCount)){return"Queue is "+aa.status.aggregateSnapshot.percentUseCount+"% full based on Back Pressure Object Threshold"}else{return"Back Pressure Object Threshold is not configured"}})}).promise();C.when(W,X).done(function(){V.select("path.connection-path").classed("full",function(Y){return l(Y)||H(Y)}).attr({"marker-end":p});V.select("rect.border").classed("full",function(Y){return l(Y)||H(Y)});V.select("rect.body").attr({filter:c})})};var u=function(X,W){var V={revision:f.getRevision(X),component:W};return C.ajax({type:"PUT",url:X.uri,data:JSON.stringify(V),dataType:"json",contentType:"application/json"}).done(function(Y){U.set(Y)}).fail(function(aa,Y,Z){if(aa.status===400||aa.status===404||aa.status===409){i.showOkDialog({headerText:"Connection",dialogContent:L.escapeHtml(aa.responseText)})}else{d.handleAjaxError(aa,Y,Z)}})};var h=function(V){V.each(function(W){R.reloadConnectionSourceAndDestination(W.sourceId,W.destinationId)});V.remove()};var U={config:{selfLoopXOffset:(I.width/2)+5,selfLoopYOffset:25},init:function(V,W,Y,X){m=V;y=W;K=Y;r=X;o=N.map();z=N.map();w=N.map();q=N.select("#canvas").append("g").attr({"pointer-events":"stroke","class":"connections"});A=N.svg.line().x(function(Z){return Z.x}).y(function(Z){return Z.y}).interpolate("linear");T=N.behavior.drag().on("dragstart",function(){N.event.sourceEvent.stopPropagation()}).on("drag",function(Z){Z.x=N.event.x;Z.y=N.event.y;N.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("dragend",function(){var Z=N.select(this.parentNode);var ad=Z.datum();var ab=Z.selectAll("rect.midpoint").data();if(ab.length===ad.component.bends.length){var ac=false;for(var aa=0;aa<ab.length&&!ac;aa++){if(ab[aa].x!==ad.component.bends[aa].x||ab[aa].y!==ad.component.bends[aa].y){ac=true}}if(ac){u(ad,{id:ad.id,bends:ab}).fail(function(){ad.bends=C.map(ad.component.bends,function(ae){return{x:ae.x,y:ae.y}});Z.call(a,{updatePath:true,updateLabel:false})})}}N.event.sourceEvent.stopPropagation()});O=N.behavior.drag().on("dragstart",function(Z){Z.dragging=true;N.event.sourceEvent.stopPropagation()}).on("drag",function(Z){Z.x=N.event.x-8;Z.y=N.event.y-8;N.select("g.hover").classed("connectable-destination",function(){return R.isValidConnectionDestination(N.select(this))});N.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("dragend",function(ah){ah.dragging=false;var aa=N.select(this.parentNode);var aj=aa.datum();var Z=aj.destinationId;var ai=N.select("g.connectable-destination");if(ai.empty()){aa.call(a,{updatePath:true,updateLabel:false})}else{if(R.isProcessGroup(ai)||R.isRemoteProcessGroup(ai)){r.showConfiguration(aa,ai).done(function(){R.reloadConnectionSourceAndDestination(null,Z)}).fail(function(){aa.call(a,{updatePath:true,updateLabel:false})})}else{var ad=ai.datum();var af=R.getConnectableTypeForDestination(ai);var ae={revision:f.getRevision(aj),component:{id:aj.id,destination:{id:ad.id,groupId:R.getGroupId(),type:af}}};if(aj.bends.length<2&&aj.sourceId===ad.id){var ab={x:ad.position.x+(ad.dimensions.width),y:ad.position.y+(ad.dimensions.height/2)};var ag=U.config.selfLoopXOffset;var ac=U.config.selfLoopYOffset;ae.component.bends=[];ae.component.bends.push({x:(ab.x+ag),y:(ab.y-ac)});ae.component.bends.push({x:(ab.x+ag),y:(ab.y+ac)})}C.ajax({type:"PUT",url:aj.uri,data:JSON.stringify(ae),dataType:"json",contentType:"application/json"}).done(function(al){var ak=al.component;U.set(al);R.reloadConnectionSourceAndDestination(null,Z);R.reloadConnectionSourceAndDestination(al.sourceId,al.destinationId)}).fail(function(am,ak,al){if(am.status===400||am.status===401||am.status===403||am.status===404||am.status===409){i.showOkDialog({headerText:"Connection",dialogContent:L.escapeHtml(am.responseText)});aa.call(a,{updatePath:true,updateLabel:false})}else{d.handleAjaxError(am,ak,al)}})}}N.event.sourceEvent.stopPropagation()});s=N.behavior.drag().on("dragstart",function(Z){N.event.sourceEvent.stopPropagation()}).on("drag",function(ae){if(ae.bends.length>1){var ab=N.select("rect.label-drag");if(ab.empty()){var ad=N.select(this).select("rect.body");var ac=Q(ad);var Z=I.width;var ai=ad.attr("height");ab=N.select("#canvas").append("rect").attr("x",ac.x).attr("y",ac.y).attr("class","label-drag").attr("width",Z).attr("height",ai).attr("stroke-width",function(){return 1/R.scaleCanvasView()}).attr("stroke-dasharray",function(){return 4/R.scaleCanvasView()}).datum({x:ac.x,y:ac.y,width:Z,height:ai})}else{ab.attr("x",function(aj){aj.x+=N.event.dx;return aj.x}).attr("y",function(aj){aj.y+=N.event.dy;return aj.y})}var af=ab.datum();var ah={x:af.x+(af.width/2),y:af.y+(af.height/2)};var aa=-1;var ag;C.each(ae.bends,function(al,ak){var aj={x:ak.x,y:ak.y};var am=t(ah,aj);if(aa===-1||am<ag){aa=al;ag=am}});ae.labelIndex=aa;N.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}}).on("dragend",function(ab){if(ab.bends.length>1){var aa=N.select("rect.label-drag");if(!aa.empty()){aa.remove()}if(ab.labelIndex!==ab.component.labelIndex){var Z=N.select(this.parentNode);u(ab,{id:ab.id,labelIndex:ab.labelIndex}).fail(function(){ab.labelIndex=ab.component.labelIndex;Z.call(a,{updatePath:true,updateLabel:false})})}}N.event.sourceEvent.stopPropagation()})},add:function(V,X){var Z=false;if(L.isDefinedAndNotNull(X)){Z=L.isDefinedAndNotNull(X.selectAll)?X.selectAll:Z}var W=new Date().getTime();var aa=function(ab){w.set(ab.id,W);o.set(ab.id,C.extend({type:"Connection"},ab))};if(C.isArray(V)){C.each(V,function(ab,ac){aa(ac)})}else{if(L.isDefinedAndNotNull(V)){aa(V)}}var Y=M();Y.enter().call(P,Z);Y.call(a,{updatePath:true,updateLabel:false}).call(S)},isDisconnected:function(X){if(X.empty()){return false}var W=N.map();var Y=N.map();var V=true;X.filter(function(Z){return Z.type==="Connection"}).each(function(Z){W.set(Z.id,Z)});X.filter(function(Z){return Z.type!=="Connection"}).each(function(Z){Y.set(Z.id,Z.component);C.each(U.getComponentConnections(Z.id),function(ab,aa){if(!W.has(aa.id)){V=false;return false}})});if(V){W.forEach(function(aa,Z){if(V){V=Y.has(R.getConnectionSourceComponentId(Z))&&Y.has(R.getConnectionDestinationComponentId(Z))}})}return V},set:function(V,W){var Z=false;var aa=false;var Y=false;if(L.isDefinedAndNotNull(W)){Z=L.isDefinedAndNotNull(W.selectAll)?W.selectAll:Z;aa=L.isDefinedAndNotNull(W.transition)?W.transition:aa;Y=L.isDefinedAndNotNull(W.overrideRevisionCheck)?W.overrideRevisionCheck:Y}var ab=function(ac){var ad=o.get(ac.id);if((f.isNewerRevision(ad,ac)&&!z.has(ac.id))||Y===true){o.set(ac.id,C.extend({type:"Connection"},ac))}};if(C.isArray(V)){C.each(o.keys(),function(ad,ae){var af=o.get(ae);var ac=C.grep(V,function(ag){return ag.id===af.id});if(ac.length===0&&!w.has(ae)){o.remove(ae)}});C.each(V,function(ac,ad){ab(ad)})}else{if(L.isDefinedAndNotNull(V)){ab(V)}}var X=M();X.enter().call(P,Z);X.call(a,{updatePath:true,updateLabel:true,transition:aa}).call(S);X.exit().call(h)},refresh:function(V){if(L.isDefinedAndNotNull(V)){N.select("#id-"+V).call(a,{updatePath:true,updateLabel:true})}else{N.selectAll("g.connection").call(a,{updatePath:true,updateLabel:true})}},pan:function(){N.selectAll("g.connection.entering, g.connection.leaving").call(a,{updatePath:false,updateLabel:true})},remove:function(W){var V=new Date().getTime();if(C.isArray(W)){C.each(W,function(X,Y){z.set(Y,V);o.remove(Y)})}else{z.set(W,V);o.remove(W)}M().exit().call(h)},removeAll:function(){U.remove(o.keys())},reload:function(W){if(o.has(W)){var V=o.get(W);return C.ajax({type:"GET",url:V.uri,dataType:"json"}).done(function(X){U.set(X)})}},reloadStatus:function(V){if(o.has(V)){return C.ajax({type:"GET",url:"../nifi-api/flow/connections/"+encodeURIComponent(V)+"/status",dataType:"json"}).done(function(W){var X=o.get(V);X.status=W.connectionStatus;o.set(V,X);M().call(D)})}},getComponentConnections:function(W){var V=[];o.forEach(function(X,Y){if(R.getConnectionSourceComponentId(Y)===W||R.getConnectionDestinationComponentId(Y)===W){V.push(Y)}});return V},get:function(V){if(L.isUndefined(V)){return o.values()}else{return o.get(V)}},expireCaches:function(W){var V=function(X){X.forEach(function(Z,Y){if(W>Y){X.remove(Z)}})};V(w);V(z)}};return U}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Funnel=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Funnel=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Funnel=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(b,r,d,s,o){var i;var l;var e;var m;var c={width:48,height:48};var j;var q;var a;var p;var k=function(){return p.selectAll("g.funnel").data(j.values(),function(t){return t.id})};var g=function(v,u){if(v.empty()){return v}var t=v.append("g").attr({id:function(w){return"id-"+w.id},"class":"funnel component"}).classed("selected",u).call(o.position);t.append("rect").attr({rx:2,ry:2,"class":"border",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},fill:"transparent",stroke:"transparent"});t.append("rect").attr({rx:2,ry:2,"class":"body",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});t.append("text").attr({"class":"funnel-icon",x:9,y:34}).text("\ue803");t.call(e.activate).call(m.activate)};var h=function(t){if(t.empty()){return}t.select("rect.border").classed("unauthorized",function(u){return u.permissions.canRead===false});t.select("rect.body").classed("unauthorized",function(u){return u.permissions.canRead===false});t.each(function(){var u=r.select(this);o.editable(u,i,l)})};var f=function(t){t.remove()};var n={init:function(v,w,t,u){i=v;l=w;e=t;m=u;j=r.map();q=r.map();a=r.map();p=r.select("#canvas").append("g").attr({"pointer-events":"all","class":"funnels"})},add:function(v,u){var x=false;if(d.isDefinedAndNotNull(u)){x=d.isDefinedAndNotNull(u.selectAll)?u.selectAll:x}var t=new Date().getTime();var y=function(z){a.set(z.id,t);j.set(z.id,b.extend({type:"Funnel",dimensions:c},z))};if(b.isArray(v)){b.each(v,function(A,z){y(z)})}else{if(d.isDefinedAndNotNull(v)){y(v)}}var w=k();w.enter().call(g,x);w.call(h)},set:function(u,t){var x=false;var y=false;var w=false;if(d.isDefinedAndNotNull(t)){x=d.isDefinedAndNotNull(t.selectAll)?t.selectAll:x;y=d.isDefinedAndNotNull(t.transition)?t.transition:y;w=d.isDefinedAndNotNull(t.overrideRevisionCheck)?t.overrideRevisionCheck:w}var z=function(B){var A=j.get(B.id);if((s.isNewerRevision(A,B)&&!q.has(B.id))||w===true){j.set(B.id,b.extend({type:"Funnel",dimensions:c},B))}};if(b.isArray(u)){b.each(j.keys(),function(B,D){var C=j.get(D);var A=b.grep(u,function(E){return E.id===C.id});if(A.length===0&&!a.has(D)){j.remove(D)}});b.each(u,function(B,A){z(A)})}else{if(d.isDefinedAndNotNull(u)){z(u)}}var v=k();v.enter().call(g,x);v.call(h).call(o.position,y);v.exit().call(f)},get:function(t){if(d.isUndefined(t)){return j.values()}else{return j.get(t)}},refresh:function(t){if(d.isDefinedAndNotNull(t)){r.select("#id-"+t).call(h)}else{r.selectAll("g.funnel").call(h)}},reload:function(u){if(j.has(u)){var t=j.get(u);return b.ajax({type:"GET",url:t.uri,dataType:"json"}).done(function(v){n.set(v)})}},position:function(t){r.select("#id-"+t).call(o.position)},remove:function(u){var t=new Date().getTime();if(b.isArray(u)){b.each(u,function(w,v){q.set(v,t);j.remove(v)})}else{q.set(u,t);j.remove(u)}k().exit().call(f)},removeAll:function(){n.remove(j.keys())},expireCaches:function(u){var t=function(v){v.forEach(function(x,w){if(u>w){v.remove(x)}})};t(a);t(q)}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Label=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Label=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Label=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(e,u,j,w,s){var m;var p;var l;var k;var q;var i={width:150,height:150};var a=20;var h=64;var f;var t;var d;var b;var c;var o=function(){return b.selectAll("g.label").data(f.values(),function(x){return x.id})};var v=function(z,y){if(z.empty()){return}var x=z.append("g").attr({id:function(A){return"id-"+A.id},"class":"label component"}).classed("selected",y).call(s.position);x.append("rect").attr({"class":"border",fill:"transparent",stroke:"transparent"});x.append("rect").attr({"class":"body",filter:"url(#component-drop-shadow)","stroke-width":0});x.append("text").attr({"xml:space":"preserve","font-weight":"bold",fill:"black","class":"label-value"});x.call(l.activate).call(q.activate).call(k.activate)};var g=function(x){if(x.empty()){return}x.select("rect.border").attr({width:function(y){return y.dimensions.width},height:function(y){return y.dimensions.height}}).classed("unauthorized",function(y){return y.permissions.canRead===false});x.select("rect.body").attr({width:function(y){return y.dimensions.width},height:function(y){return y.dimensions.height}}).style("fill",function(z){if(!z.permissions.canRead){return null}var y=n.defaultColor();if(j.isDefinedAndNotNull(z.component.style["background-color"])){y=z.component.style["background-color"]}return y}).classed("unauthorized",function(y){return y.permissions.canRead===false});x.each(function(F){var B=u.select(this);s.editable(B,m,p);var E=B.select("text.label-value");var D=B.selectAll("rect.labelpoint");if(F.permissions.canRead){E.attr("font-size",function(){var G="12px";if(j.isDefinedAndNotNull(F.component.style["font-size"])){G=F.component.style["font-size"]}return G});E.selectAll("tspan").remove();var z=[];if(j.isDefinedAndNotNull(F.component.label)){z=F.component.label.split("\n")}else{z.push("")}var A=n.defaultColor();if(j.isDefinedAndNotNull(F.component.style["background-color"])){A=F.component.style["background-color"]}e.each(z,function(H,G){E.append("tspan").attr("x","0.4em").attr("dy","1.2em").text(function(){return G}).style("fill",function(I){return j.determineContrastColor(j.substringAfterLast(A,"#"))})});if(F.permissions.canWrite){var y=[{x:F.dimensions.width,y:F.dimensions.height}];var C=D.data(y);C.enter().append("rect").attr({"class":"labelpoint",width:10,height:10}).call(c);C.attr("transform",function(G){return"translate("+(G.x-10)+", "+(G.y-10)+")"});C.exit().remove()}}else{E.selectAll("tspan").remove();D.remove()}})};var r=function(x){x.remove()};var n={config:{width:i.width,height:i.height},init:function(z,A,x,y,B){m=z;p=A;l=x;q=y;k=B;f=u.map();t=u.map();d=u.map();b=u.select("#canvas").append("g").attr({"pointer-events":"all","class":"labels"});c=u.behavior.drag().on("dragstart",function(){u.event.sourceEvent.stopPropagation()}).on("drag",function(){var C=u.select(this.parentNode);var D=C.datum();D.dimensions.width=Math.max(h,u.event.x);D.dimensions.height=Math.max(a,u.event.y);g(C)}).on("dragend",function(){var D=u.select(this.parentNode);var E=D.datum();var F=false;if(j.isDefinedAndNotNull(E.component.width)||E.dimensions.width!==E.component.width){F=true}if(!F&&j.isDefinedAndNotNull(E.component.height)||E.dimensions.height!==E.component.height){F=true}if(F){var C={revision:w.getRevision(E),component:{id:E.id,width:E.dimensions.width,height:E.dimensions.height}};e.ajax({type:"PUT",url:E.uri,data:JSON.stringify(C),dataType:"json",contentType:"application/json"}).done(function(G){n.set(G)}).fail(function(){var H=i.width;if(j.isDefinedAndNotNull(E.component.width)){H=E.component.width}var G=i.height;if(j.isDefinedAndNotNull(E.component.height)){G=E.component.height}E.dimensions={width:H,height:G};D.call(g)})}u.event.sourceEvent.stopPropagation()})},add:function(A,y){var B=false;if(j.isDefinedAndNotNull(y)){B=j.isDefinedAndNotNull(y.selectAll)?y.selectAll:B}var x=new Date().getTime();var C=function(D){d.set(D.id,x);f.set(D.id,e.extend({type:"Label"},D))};if(e.isArray(A)){e.each(A,function(E,D){C(D)})}else{if(j.isDefinedAndNotNull(A)){C(A)}}var z=o();z.enter().call(v,B);z.call(g)},set:function(z,x){var B=false;var C=false;var A=false;if(j.isDefinedAndNotNull(x)){B=j.isDefinedAndNotNull(x.selectAll)?x.selectAll:B;C=j.isDefinedAndNotNull(x.transition)?x.transition:C;A=j.isDefinedAndNotNull(x.overrideRevisionCheck)?x.overrideRevisionCheck:A}var D=function(E){var F=f.get(E.id);if((w.isNewerRevision(F,E)&&!t.has(E.id))||A===true){f.set(E.id,e.extend({type:"Label"},E))}};if(e.isArray(z)){e.each(f.keys(),function(F,H){var G=f.get(H);var E=e.grep(z,function(I){return I.id===G.id});if(E.length===0&&!d.has(H)){f.remove(H)}});e.each(z,function(F,E){D(E)})}else{if(j.isDefinedAndNotNull(z)){D(z)}}var y=o();y.enter().call(v,B);y.call(g).call(s.position,C);y.exit().call(r)},get:function(x){if(j.isUndefined(x)){return f.values()}else{return f.get(x)}},refresh:function(x){if(j.isDefinedAndNotNull(x)){u.select("#id-"+x).call(g)}else{u.selectAll("g.label").call(g)}},reload:function(y){if(f.has(y)){var x=f.get(y);return e.ajax({type:"GET",url:x.uri,dataType:"json"}).done(function(z){n.set(z)})}},position:function(x){u.select("#id-"+x).call(s.position)},remove:function(y){var x=new Date().getTime();if(e.isArray(y)){e.each(y,function(z,A){t.set(A,x);f.remove(A)})}else{t.set(y,x);f.remove(y)}o().exit().call(r)},removeAll:function(){n.remove(f.keys())},expireCaches:function(y){var x=function(z){z.forEach(function(B,A){if(y>A){z.remove(B)}})};x(d);x(t)},defaultColor:function(){return"#fff7d7"}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Port=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Port=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Port=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(d,x,h,y,u){var m;var r;var j;var i;var s;var n=15;var k=25;var v={width:240,height:50};var o={width:240,height:75};var e;var w;var c;var g;var q=function(){return g.selectAll("g.input-port, g.output-port").data(e.values(),function(z){return z.id})};var l=function(B,A){if(B.empty()){return}var z=B.append("g").attr({id:function(D){return"id-"+D.id},"class":function(D){if(D.portType==="INPUT_PORT"){return"input-port component"}else{return"output-port component"}}}).classed("selected",A).call(u.position);z.append("rect").attr({"class":"border",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},fill:"transparent",stroke:"transparent"});z.append("rect").attr({"class":"body",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});var C=0;if(u.getParentGroupId()===null){C=k;z.append("rect").attr({"class":"remote-banner",width:function(D){return D.dimensions.width},height:C,fill:"#e3e8eb"})}z.append("text").attr({"class":"port-icon",x:10,y:38+C}).text(function(D){if(D.portType==="INPUT_PORT"){return"\ue832"}else{return"\ue833"}});z.append("text").attr({x:70,y:25+C,width:95,height:30,"class":"port-name"});z.call(j.activate).call(s.activate).call(i.activate);z.filter(function(D){return D.permissions.canWrite&&D.permissions.canRead}).call(r.activate).call(m.activate)};var p=function(z){if(z.empty()){return}z.select("rect.border").classed("unauthorized",function(A){return A.permissions.canRead===false});z.select("rect.body").classed("unauthorized",function(A){return A.permissions.canRead===false});z.each(function(B){var A=x.select(this);var C=A.select("g.port-details");u.editable(A,m,r);if(A.classed("visible")){if(C.empty()){C=A.append("g").attr("class","port-details");var D=0;if(u.getParentGroupId()===null){D=k;C.append("text").attr({"class":"port-transmission-icon",x:10,y:18});C.append("rect").attr({"class":"bulletin-background",x:function(E){return B.dimensions.width-D},width:D,height:D});C.append("text").attr({"class":"bulletin-icon",x:function(E){return B.dimensions.width-18},y:18}).text("\uf24a")}C.append("text").attr({"class":"run-status-icon",x:50,y:function(){return 25+D}});C.append("path").attr({"class":"component-comments",transform:"translate("+(B.dimensions.width-2)+", "+(B.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});C.append("text").attr({"class":"active-thread-count-icon",y:43+D}).text("\ue83f");C.append("text").attr({"class":"active-thread-count",y:43+D})}if(B.permissions.canRead){A.select("text.port-name").each(function(H){var G=x.select(this);var E=H.component.name;var F=E.split(/\s+/);G.text(null).selectAll("tspan, title").remove();if(F.length===1){u.ellipsis(G,E)}else{u.multilineEllipsis(G,2,E)}}).append("title").text(function(E){return E.component.name});A.select("path.component-comments").style("visibility",h.isBlank(B.component.comments)?"hidden":"visible").each(function(){var E=x.select("#comments-tip-"+B.id);if(h.isBlank(B.component.comments)){if(!E.empty()){E.remove()}}else{if(E.empty()){E=x.select("#port-tooltips").append("div").attr("id",function(){return"comments-tip-"+B.id}).attr("class","tooltip nifi-tooltip")}E.text(B.component.comments);u.canvasTooltip(E,x.select(this))}})}else{A.select("text.port-name").text(null);A.select("path.component-comments").style("visibility","hidden");A.call(b)}A.call(f)}else{if(B.permissions.canRead){A.select("text.port-name").text(function(F){var E=F.component.name;if(E.length>n){return E.substring(0,n)+String.fromCharCode(8230)}else{return E}})}else{A.select("text.port-name").text(null)}A.call(b);if(!C.empty()){C.remove()}}})};var f=function(z){if(z.empty()){return}z.select("text.run-status-icon").attr({fill:function(B){var A="#728e9b";if(B.status.aggregateSnapshot.runStatus==="Invalid"){A="#cf9f5d"}else{if(B.status.aggregateSnapshot.runStatus==="Running"){A="#7dc7a0"}else{if(B.status.aggregateSnapshot.runStatus==="Stopped"){A="#d18686"}}}return A},"font-family":function(B){var A="FontAwesome";if(B.status.aggregateSnapshot.runStatus==="Disabled"){A="flowfont"}return A}}).text(function(B){var A="";if(B.status.aggregateSnapshot.runStatus==="Disabled"){A="\ue802"}else{if(B.status.aggregateSnapshot.runStatus==="Invalid"){A="\uf071"}else{if(B.status.aggregateSnapshot.runStatus==="Running"){A="\uf04b"}else{if(B.status.aggregateSnapshot.runStatus==="Stopped"){A="\uf04d"}}}}return A}).each(function(B){var A=x.select("#run-status-tip-"+B.id);if(B.permissions.canRead&&!h.isEmpty(B.component.validationErrors)){if(A.empty()){A=x.select("#port-tooltips").append("div").attr("id",function(){return"run-status-tip-"+B.id}).attr("class","tooltip nifi-tooltip")}A.html(function(){var C=h.formatUnorderedList(B.component.validationErrors);if(C===null||C.length===0){return""}else{return d("<div></div>").append(C).html()}});u.canvasTooltip(A,x.select(this))}else{if(!A.empty()){A.remove()}}});z.select("text.port-transmission-icon").attr({"font-family":function(A){if(A.status.transmitting===true){return"FontAwesome"}else{return"flowfont"}}}).text(function(A){if(A.status.transmitting===true){return"\uf140"}else{return"\ue80a"}}).classed("transmitting",function(A){if(A.status.transmitting===true){return true}else{return false}}).classed("not-transmitting",function(A){if(A.status.transmitting!==true){return true}else{return false}});z.each(function(C){var A=x.select(this);var B=0;u.activeThreadCount(A,C,function(D){B=D});A.select("rect.bulletin-background").classed("has-bulletins",function(){return !h.isEmpty(C.status.aggregateSnapshot.bulletins)});u.bulletins(A,C,function(){return x.select("#port-tooltips")},B)})};var t=function(z){if(z.empty()){return}z.call(b).remove()};var b=function(z){z.each(function(A){d("#run-status-tip-"+A.id).remove();d("#bulletin-tip-"+A.id).remove();d("#comments-tip-"+A.id).remove()})};var a={init:function(B,C,z,A,D){m=B;r=C;j=z;s=A;i=D;e=x.map();w=x.map();c=x.map();g=x.select("#canvas").append("g").attr({"pointer-events":"all","class":"ports"})},add:function(D,A){var E=false;if(h.isDefinedAndNotNull(A)){E=h.isDefinedAndNotNull(A.selectAll)?A.selectAll:E}var C=v;if(u.getParentGroupId()===null){C=o}var z=new Date().getTime();var F=function(G){c.set(G.id,z);e.set(G.id,d.extend({type:"Port",dimensions:C,status:{activeThreadCount:0}},G))};if(d.isArray(D)){d.each(D,function(H,G){F(G)})}else{if(h.isDefinedAndNotNull(D)){F(D)}}var B=q();B.enter().call(l,E);B.call(p)},set:function(C,z){var E=false;var F=false;var D=false;if(h.isDefinedAndNotNull(z)){E=h.isDefinedAndNotNull(z.selectAll)?z.selectAll:E;F=h.isDefinedAndNotNull(z.transition)?z.transition:F;D=h.isDefinedAndNotNull(z.overrideRevisionCheck)?z.overrideRevisionCheck:D}var B=v;if(u.getParentGroupId()===null){B=o}var G=function(H){var I=e.get(H.id);if((y.isNewerRevision(I,H)&&!w.has(H.id))||D===true){e.set(H.id,d.extend({type:"Port",dimensions:B,status:{activeThreadCount:0}},H))}};if(d.isArray(C)){d.each(e.keys(),function(I,J){var K=e.get(J);var H=d.grep(C,function(L){return L.id===K.id});if(H.length===0&&!c.has(J)){e.remove(J)}});d.each(C,function(I,H){G(H)})}else{if(h.isDefinedAndNotNull(C)){G(C)}}var A=q();A.enter().call(l,E);A.call(p).call(u.position,F);A.exit().call(t)},get:function(z){if(h.isUndefined(z)){return e.values()}else{return e.get(z)}},refresh:function(z){if(h.isDefinedAndNotNull(z)){x.select("#id-"+z).call(p)}else{x.selectAll("g.input-port, g.output-port").call(p)}},pan:function(){x.selectAll("g.input-port.entering, g.output-port.entering, g.input-port.leaving, g.output-port.leaving").call(p)},reload:function(A){if(e.has(A)){var z=e.get(A);return d.ajax({type:"GET",url:z.uri,dataType:"json"}).done(function(B){a.set(B)})}},position:function(z){x.select("#id-"+z).call(u.position)},remove:function(A){var z=new Date().getTime();if(d.isArray(A)){d.each(A,function(B,C){w.set(C,z);e.remove(C)})}else{w.set(A,z);e.remove(A)}q().exit().call(t)},removeAll:function(){a.remove(e.keys())},expireCaches:function(A){var z=function(B){B.forEach(function(D,C){if(A>C){B.remove(D)}})};z(c);z(w)}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.Dialog"],function(g,e,i,h,c,d,f){return(nf.ProcessGroup=b(g,e,i,h,c,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Dialog")))}else{nf.ProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.Dialog)}}}(this,function(g,z,k,j,A,v,p){var n;var t;var l;var u;var o=30;var i={width:380,height:172};var d;var y;var e;var q;var m=function(B){return j.isDefinedAndNotNull(B.versionedFlowState)};var s=function(){return q.selectAll("g.process-group").data(d.values(),function(B){return B.id})};var w=function(D,B){if(D.empty()){return}var C=D.append("g").attr({id:function(E){return"id-"+E.id},"class":"process-group component"}).classed("selected",B).call(v.position);C.append("rect").attr({"class":"border",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},fill:"transparent",stroke:"transparent"});C.append("rect").attr({"class":"body",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});C.append("rect").attr({width:function(E){return E.dimensions.width},height:32,fill:"#b8c6cd"});C.append("text").attr({x:10,y:20,width:316,height:16,"class":"process-group-name"});C.append("text").attr({x:10,y:21,"class":"version-control"});C.on("dblclick",function(E){h.enterGroup(E.id)}).call(l.activate).call(u.activate);C.filter(function(E){return E.permissions.canWrite&&E.permissions.canRead}).on("mouseover.drop",function(I){var G=z.select(this);if(!G.classed("drop")){var H=G.datum();var F=z.select("rect.drag-selection");if(!F.empty()){var E=v.getSelection().filter(function(J){return H.id===J.id});if(E.empty()){G.classed("drop",function(){return k.isDisconnected(v.getSelection())})}}}}).on("mouseout.drop",function(E){z.select(this).classed("drop",false)}).call(t.activate).call(n.activate)};var b=10;var a=5;var x=function(B){if(B.empty()){return}B.select("rect.border").classed("unauthorized",function(C){return C.permissions.canRead===false});B.select("rect.body").classed("unauthorized",function(C){return C.permissions.canRead===false});B.each(function(K){var Z=z.select(this);var X=Z.select("g.process-group-details");v.editable(Z,n,t);if(Z.classed("visible")){if(X.empty()){X=Z.append("g").attr("class","process-group-details");X.append("rect").attr({x:0,y:32,width:function(){return K.dimensions.width},height:24,fill:"#e3e8eb"});X.append("rect").attr({x:0,y:function(){return K.dimensions.height-24},width:function(){return K.dimensions.width},height:24,fill:"#e3e8eb"});X.append("text").attr({x:10,y:49,"class":"process-group-transmitting process-group-contents-icon","font-family":"FontAwesome"}).text("\uf140");X.append("text").attr({y:49,"class":"process-group-transmitting-count process-group-contents-count"});X.append("text").attr({y:49,"class":"process-group-not-transmitting process-group-contents-icon","font-family":"flowfont"}).text("\ue80a");X.append("text").attr({y:49,"class":"process-group-not-transmitting-count process-group-contents-count"});X.append("text").attr({y:49,"class":"process-group-running process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04b");X.append("text").attr({y:49,"class":"process-group-running-count process-group-contents-count"});X.append("text").attr({y:49,"class":"process-group-stopped process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04d");X.append("text").attr({y:49,"class":"process-group-stopped-count process-group-contents-count"});X.append("text").attr({y:49,"class":"process-group-invalid process-group-contents-icon","font-family":"FontAwesome"}).text("\uf071");X.append("text").attr({y:49,"class":"process-group-invalid-count process-group-contents-count"});X.append("text").attr({y:49,"class":"process-group-disabled process-group-contents-icon","font-family":"flowfont"}).text("\ue802");X.append("text").attr({y:49,"class":"process-group-disabled-count process-group-contents-count"});X.append("text").attr({x:10,y:function(){return K.dimensions.height-7},"class":"process-group-up-to-date process-group-contents-icon","font-family":"FontAwesome"}).text("\uf00c");X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-up-to-date-count process-group-contents-count"});X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified process-group-contents-icon","font-family":"FontAwesome"}).text("\uf069");X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-count process-group-contents-count"});X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf0aa");X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-stale-count process-group-contents-count"});X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-and-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf06a");X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-and-stale-count process-group-contents-count"});X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-sync-failure process-group-contents-icon","font-family":"FontAwesome"}).text("\uf128");X.append("text").attr({y:function(){return K.dimensions.height-7},"class":"process-group-sync-failure-count process-group-contents-count"});X.append("rect").attr({width:function(){return K.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});X.append("rect").attr({width:function(){return K.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});X.append("rect").attr({width:function(){return K.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});X.append("rect").attr({width:function(){return K.dimensions.width},height:1,x:0,y:103,fill:"#c7d2d7"});X.append("rect").attr({width:function(){return K.dimensions.width},height:19,x:0,y:104,fill:"#f4f6f7"});X.append("rect").attr({width:function(){return K.dimensions.width},height:1,x:0,y:122,fill:"#c7d2d7"});X.append("rect").attr({width:function(){return K.dimensions.width},height:19,x:0,y:123,fill:"#ffffff"});var W=X.append("g").attr({transform:"translate(6, 75)"});W.append("text").attr({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Queued");W.append("text").attr({width:73,height:10,x:4,y:24,"class":"stats-label"}).text("In");W.append("text").attr({width:73,height:10,x:4,y:42,"class":"stats-label"}).text("Read/Write");W.append("text").attr({width:73,height:10,x:4,y:60,"class":"stats-label"}).text("Out");var F=X.append("g").attr({transform:"translate(95, 75)"});var T=F.append("text").attr({width:180,height:10,x:4,y:5,"class":"process-group-queued stats-value"});T.append("tspan").attr({"class":"count"});T.append("tspan").attr({"class":"size"});var O=F.append("text").attr({width:180,height:10,x:4,y:24,"class":"process-group-in stats-value"});O.append("tspan").attr({"class":"count"});O.append("tspan").attr({"class":"size"});O.append("tspan").attr({"class":"ports"});F.append("text").attr({width:180,height:10,x:4,y:42,"class":"process-group-read-write stats-value"});var R=F.append("text").attr({width:180,height:10,x:4,y:60,"class":"process-group-out stats-value"});R.append("tspan").attr({"class":"ports"});R.append("tspan").attr({"class":"count"});R.append("tspan").attr({"class":"size"});var N=X.append("g").attr({transform:"translate(335, 75)"});N.append("text").attr({width:25,height:10,x:4,y:24,"class":"stats-info"}).text("5 min");N.append("text").attr({width:25,height:10,x:4,y:42,"class":"stats-info"}).text("5 min");N.append("text").attr({width:25,height:10,x:4,y:60,"class":"stats-info"}).text("5 min");X.append("path").attr({"class":"component-comments",transform:"translate("+(K.dimensions.width-2)+", "+(K.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});X.append("text").attr({"class":"active-thread-count-icon",y:20}).text("\ue83f");X.append("text").attr({"class":"active-thread-count",y:20});X.append("rect").attr({"class":"bulletin-background",x:function(){return K.dimensions.width-24},y:32,width:24,height:24});X.append("text").attr({"class":"bulletin-icon",x:function(){return K.dimensions.width-17},y:49}).text("\uf24a")}var V=X.select("text.process-group-transmitting").classed("transmitting",function(ag){return ag.permissions.canRead&&ag.activeRemotePortCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.activeRemotePortCount===0});var ac=X.select("text.process-group-transmitting-count").attr("x",function(){var ag=parseInt(V.attr("x"),10);return ag+Math.round(V.node().getComputedTextLength())+a}).text(function(ag){return ag.activeRemotePortCount});var E=X.select("text.process-group-not-transmitting").classed("not-transmitting",function(ag){return ag.permissions.canRead&&ag.inactiveRemotePortCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.inactiveRemotePortCount===0}).attr("x",function(){var ag=parseInt(ac.attr("x"),10);return ag+Math.round(ac.node().getComputedTextLength())+b});var aa=X.select("text.process-group-not-transmitting-count").attr("x",function(){var ag=parseInt(E.attr("x"),10);return ag+Math.round(E.node().getComputedTextLength())+a}).text(function(ag){return ag.inactiveRemotePortCount});var G=X.select("text.process-group-running").classed("running",function(ag){return ag.permissions.canRead&&ag.component.runningCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.runningCount===0}).attr("x",function(){var ag=parseInt(aa.attr("x"),10);return ag+Math.round(aa.node().getComputedTextLength())+b});var M=X.select("text.process-group-running-count").attr("x",function(){var ag=parseInt(G.attr("x"),10);return ag+Math.round(G.node().getComputedTextLength())+a}).text(function(ag){return ag.runningCount});var H=X.select("text.process-group-stopped").classed("stopped",function(ag){return ag.permissions.canRead&&ag.component.stoppedCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.stoppedCount===0}).attr("x",function(){var ag=parseInt(M.attr("x"),10);return ag+Math.round(M.node().getComputedTextLength())+b});var ab=X.select("text.process-group-stopped-count").attr("x",function(){var ag=parseInt(H.attr("x"),10);return ag+Math.round(H.node().getComputedTextLength())+a}).text(function(ag){return ag.stoppedCount});var Y=X.select("text.process-group-invalid").classed("invalid",function(ag){return ag.permissions.canRead&&ag.component.invalidCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.invalidCount===0}).attr("x",function(){var ag=parseInt(ab.attr("x"),10);return ag+Math.round(ab.node().getComputedTextLength())+b});var Q=X.select("text.process-group-invalid-count").attr("x",function(){var ag=parseInt(Y.attr("x"),10);return ag+Math.round(Y.node().getComputedTextLength())+a}).text(function(ag){return ag.invalidCount});var I=X.select("text.process-group-disabled").classed("disabled",function(ag){return ag.permissions.canRead&&ag.component.disabledCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.disabledCount===0}).attr("x",function(){var ag=parseInt(Q.attr("x"),10);return ag+Math.round(Q.node().getComputedTextLength())+b});X.select("text.process-group-disabled-count").attr("x",function(){var ag=parseInt(I.attr("x"),10);return ag+Math.round(I.node().getComputedTextLength())+a}).text(function(ag){return ag.disabledCount});var af=X.select("text.process-group-up-to-date").classed("up-to-date",function(ag){return ag.permissions.canRead&&ag.component.upToDateCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.upToDateCount===0});var L=X.select("text.process-group-up-to-date-count").attr("x",function(){var ag=parseInt(af.attr("x"),10);return ag+Math.round(af.node().getComputedTextLength())+a}).text(function(ag){return ag.upToDateCount});var U=X.select("text.process-group-locally-modified").classed("locally-modified",function(ag){return ag.permissions.canRead&&ag.component.locallyModifiedCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.locallyModifiedCount===0}).attr("x",function(){var ag=parseInt(L.attr("x"),10);return ag+Math.round(L.node().getComputedTextLength())+b});var D=X.select("text.process-group-locally-modified-count").attr("x",function(){var ag=parseInt(U.attr("x"),10);return ag+Math.round(U.node().getComputedTextLength())+a}).text(function(ag){return ag.locallyModifiedCount});var P=X.select("text.process-group-stale").classed("stale",function(ag){return ag.permissions.canRead&&ag.component.staleCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.staleCount===0}).attr("x",function(){var ag=parseInt(D.attr("x"),10);return ag+Math.round(D.node().getComputedTextLength())+b});var J=X.select("text.process-group-stale-count").attr("x",function(){var ag=parseInt(P.attr("x"),10);return ag+Math.round(P.node().getComputedTextLength())+a}).text(function(ag){return ag.staleCount});var C=X.select("text.process-group-locally-modified-and-stale").classed("locally-modified-and-stale",function(ag){return ag.permissions.canRead&&ag.component.locallyModifiedAndStaleCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.locallyModifiedAndStaleCount===0}).attr("x",function(){var ag=parseInt(J.attr("x"),10);return ag+Math.round(J.node().getComputedTextLength())+b});var S=X.select("text.process-group-locally-modified-and-stale-count").attr("x",function(){var ag=parseInt(C.attr("x"),10);return ag+Math.round(C.node().getComputedTextLength())+a}).text(function(ag){return ag.locallyModifiedAndStaleCount});var ad=X.select("text.process-group-sync-failure").classed("sync-failure",function(ag){return ag.permissions.canRead&&ag.component.syncFailureCount>0}).classed("zero",function(ag){return ag.permissions.canRead&&ag.component.syncFailureCount===0}).attr("x",function(){var ag=parseInt(S.attr("x"),10);return ag+Math.round(S.node().getComputedTextLength())+b-2});X.select("text.process-group-sync-failure-count").attr("x",function(){var ag=parseInt(ad.attr("x"),10);return ag+Math.round(ad.node().getComputedTextLength())+a}).text(function(ag){return ag.syncFailureCount});var ae=Z.select("text.version-control").style({visibility:m(K)?"visible":"hidden",fill:function(){if(m(K)){var ag=K.versionedFlowState;if(ag==="SYNC_FAILURE"){return"#666666"}else{if(ag==="LOCALLY_MODIFIED_AND_STALE"){return"#BA554A"}else{if(ag==="STALE"){return"#BA554A"}else{if(ag==="LOCALLY_MODIFIED"){return"#666666"}else{return"#1A9964"}}}}}else{return"#000"}}}).text(function(){if(m(K)){var ag=K.versionedFlowState;if(ag==="SYNC_FAILURE"){return"\uf128"}else{if(ag==="LOCALLY_MODIFIED_AND_STALE"){return"\uf06a"}else{if(ag==="STALE"){return"\uf0aa"}else{if(ag==="LOCALLY_MODIFIED"){return"\uf069"}else{return"\uf00c"}}}}}else{return""}});if(K.permissions.canRead){ae.each(function(){var ag=z.select("#version-control-tip-"+K.id);if(m(K)){if(ag.empty()){ag=z.select("#process-group-tooltips").append("div").attr("id",function(){return"version-control-tip-"+K.id}).attr("class","tooltip nifi-tooltip")}ag.html(function(){var ah=K.component.versionControlInformation;var aj=g("<div></div>").text('Tracking to "'+ah.flowName+'" version '+ah.version+' in "'+ah.registryName+" - "+ah.bucketName+'"');var ai=g("<div></div>").text(j.getVersionControlTooltip(ah));return g("<div></div>").append(aj).append("<br/>").append(ai).html()});v.canvasTooltip(ag,z.select(this))}else{if(!ag.empty()){ag.remove()}}});Z.select("path.component-comments").style("visibility",j.isBlank(K.component.comments)?"hidden":"visible").each(function(){var ag=z.select("#comments-tip-"+K.id);if(j.isBlank(K.component.comments)){if(!ag.empty()){ag.remove()}}else{if(ag.empty()){ag=z.select("#process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+K.id}).attr("class","tooltip nifi-tooltip")}ag.text(K.component.comments);v.canvasTooltip(ag,z.select(this))}});Z.select("text.process-group-name").attr({x:function(){if(m(K)){var ag=parseInt(ae.attr("x"),10);return ag+Math.round(ae.node().getComputedTextLength())+a}else{return 10}},width:function(){if(m(K)){var ah=parseInt(ae.attr("x"),10);var ag=parseInt(z.select(this).attr("x"),10);return 316-(ag-ah)}else{return 316}}}).each(function(ah){var ag=z.select(this);ag.text(null).selectAll("title").remove();v.ellipsis(ag,ah.component.name)}).append("title").text(function(ag){return ag.component.name})}else{Z.select("path.component-comments").style("visibility","hidden");Z.select("text.process-group-name").attr({x:10,width:316}).text(null);Z.call(c)}Z.call(f)}else{if(K.permissions.canRead){Z.select("text.process-group-name").text(function(ah){var ag=ah.component.name;if(ag.length>o){return ag.substring(0,o)+String.fromCharCode(8230)}else{return ag}})}else{Z.select("text.process-group-name").text(null)}Z.call(c);if(!X.empty()){X.remove()}}})};var f=function(B){if(B.empty()){return}B.select("text.process-group-queued tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-queued tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-in tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.ports").text(function(C){return" "+String.fromCharCode(8594)+" "+C.inputPortCount});B.select("text.process-group-read-write").text(function(C){return C.status.aggregateSnapshot.read+" / "+C.status.aggregateSnapshot.written});B.select("text.process-group-out tspan.ports").text(function(C){return C.outputPortCount+" "+String.fromCharCode(8594)+" "});B.select("text.process-group-out tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.output," ")});B.select("text.process-group-out tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.output," ")});B.each(function(E){var C=z.select(this);var D=0;v.activeThreadCount(C,E,function(F){D=F});C.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(E.status.aggregateSnapshot.bulletins)});v.bulletins(C,E,function(){return z.select("#process-group-tooltips")},D)})};var r=function(B){if(B.empty()){return}B.call(c).remove()};var c=function(B){B.each(function(C){g("#bulletin-tip-"+C.id).remove();g("#version-control-tip-"+C.id).remove();g("#comments-tip-"+C.id).remove()})};var h={init:function(D,E,B,C){n=D;t=E;l=B;u=C;d=z.map();y=z.map();e=z.map();q=z.select("#canvas").append("g").attr({"pointer-events":"all","class":"process-groups"})},add:function(G,C){var E=false;if(j.isDefinedAndNotNull(C)){E=j.isDefinedAndNotNull(C.selectAll)?C.selectAll:E}var B=new Date().getTime();var F=function(H){e.set(H.id,B);d.set(H.id,g.extend({type:"ProcessGroup",dimensions:i},H))};if(g.isArray(G)){g.each(G,function(H,I){F(I)})}else{if(j.isDefinedAndNotNull(G)){F(G)}}var D=s();D.enter().call(w,E);D.call(x)},set:function(H,B){var E=false;var F=false;var D=false;if(j.isDefinedAndNotNull(B)){E=j.isDefinedAndNotNull(B.selectAll)?B.selectAll:E;F=j.isDefinedAndNotNull(B.transition)?B.transition:F;D=j.isDefinedAndNotNull(B.overrideRevisionCheck)?B.overrideRevisionCheck:D}var G=function(I){var J=d.get(I.id);if((A.isNewerRevision(J,I)&&!y.has(I.id))||D===true){d.set(I.id,g.extend({type:"ProcessGroup",dimensions:i},I))}};if(g.isArray(H)){g.each(d.keys(),function(J,K){var L=d.get(K);var I=g.grep(H,function(M){return M.id===L.id});if(I.length===0&&!e.has(K)){d.remove(K)}});g.each(H,function(I,J){G(J)})}else{if(j.isDefinedAndNotNull(H)){G(H)}}var C=s();C.enter().call(w,E);C.call(x).call(v.position,F);C.exit().call(r)},get:function(B){if(j.isUndefined(B)){return d.values()}else{return d.get(B)}},refresh:function(B){if(j.isDefinedAndNotNull(B)){z.select("#id-"+B).call(x)}else{z.selectAll("g.process-group").call(x)}},pan:function(){z.selectAll("g.process-group.entering, g.process-group.leaving").call(x)},reload:function(C){if(d.has(C)){var B=d.get(C);return g.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(D){h.set(D)})}},position:function(B){z.select("#id-"+B).call(v.position)},remove:function(C){var B=new Date().getTime();if(g.isArray(C)){g.each(C,function(E,D){y.set(D,B);d.remove(D)})}else{y.set(C,B);d.remove(C)}s().exit().call(r)},removeAll:function(){h.remove(d.keys())},expireCaches:function(C){var B=function(D){D.forEach(function(F,E){if(C>E){D.remove(F)}})};B(e);B(y)},enterGroup:function(B){u.hide();v.setGroupId(B);return v.reload().done(function(){var C=v.restoreUserView();if(C===false){v.fitCanvasView();v.refreshCanvasView({transition:true})}v.setURLParameters(B,z.select())}).fail(function(){p.showOkDialog({headerText:"Process Group",dialogContent:"Unable to enter the selected group."})})}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,h,g,c,d){return(nf.RemoteProcessGroup=b(f,e,h,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(g,y,l,j,z,v){var n;var t;var m;var k;var u;var o=30;var h={width:380,height:158};var c;var w;var d;var x;var s=function(){return x.selectAll("g.remote-process-group").data(c.values(),function(A){return A.id})};var f=function(C,A){if(C.empty()){return}var B=C.append("g").attr({id:function(D){return"id-"+D.id},"class":"remote-process-group component"}).classed("selected",A).call(v.position);B.append("rect").attr({"class":"border",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},fill:"transparent",stroke:"transparent"});B.append("rect").attr({"class":"body",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});B.append("rect").attr({width:function(D){return D.dimensions.width},height:32,fill:"#b8c6cd"});B.append("text").attr({x:30,y:20,width:305,height:16,"class":"remote-process-group-name"});B.call(m.activate).call(u.activate).call(k.activate)};var r=function(A){if(A.empty()){return}A.select("rect.border").classed("unauthorized",function(B){return B.permissions.canRead===false});A.select("rect.body").classed("unauthorized",function(B){return B.permissions.canRead===false});A.each(function(G){var H=y.select(this);var E=H.select("g.remote-process-group-details");v.editable(H,n,t);if(H.classed("visible")){if(E.empty()){E=H.append("g").attr("class","remote-process-group-details");E.append("text").attr({"class":"remote-process-group-transmission-status",x:10,y:20});E.append("rect").attr({x:0,y:32,width:function(){return G.dimensions.width},height:24,fill:"#e3e8eb"});E.append("text").attr({"class":"remote-process-group-transmission-secure",x:10,y:48});E.append("text").attr({x:30,y:48,width:305,height:12,"class":"remote-process-group-uri"});E.append("rect").attr({width:function(){return G.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});E.append("rect").attr({width:function(){return G.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});E.append("rect").attr({width:function(){return G.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});var F=E.append("g").attr({transform:"translate(6, 75)"});F.append("text").attr({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Sent");F.append("text").attr({width:73,height:10,x:4,y:23,"class":"stats-label"}).text("Received");var I=E.append("g").attr({transform:"translate(95, 75)"});var B=I.append("text").attr({width:180,height:10,x:4,y:5,"class":"remote-process-group-sent stats-value"});B.append("tspan").attr({"class":"count"});B.append("tspan").attr({"class":"size"});B.append("tspan").attr({"class":"ports"});var C=I.append("text").attr({width:180,height:10,x:4,y:23,"class":"remote-process-group-received stats-value"});C.append("tspan").attr({"class":"ports"});C.append("tspan").attr({"class":"count"});C.append("tspan").attr({"class":"size"});var D=E.append("g").attr({transform:"translate(335, 75)"});D.append("text").attr({width:25,height:10,x:4,y:5,"class":"stats-info"}).text("5 min");D.append("text").attr({width:25,height:10,x:4,y:23,"class":"stats-info"}).text("5 min");E.append("rect").attr({x:0,y:function(){return G.dimensions.height-24},width:function(){return G.dimensions.width},height:24,fill:"#e3e8eb"});E.append("text").attr({x:10,y:150,"class":"remote-process-group-last-refresh"});E.append("path").attr({"class":"component-comments",transform:"translate("+(G.dimensions.width-2)+", "+(G.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});E.append("text").attr({"class":"active-thread-count-icon",y:20}).text("\ue83f");E.append("text").attr({"class":"active-thread-count",y:20});E.append("rect").attr({"class":"bulletin-background",x:function(){return G.dimensions.width-24},y:32,width:24,height:24});E.append("text").attr({"class":"bulletin-icon",x:function(){return G.dimensions.width-17},y:49}).text("\uf24a")}if(G.permissions.canRead){E.select("text.remote-process-group-uri").each(function(K){var J=y.select(this);J.text(null).selectAll("title").remove();v.ellipsis(J,K.component.targetUris)}).append("title").text(function(J){return J.component.name});E.select("text.remote-process-group-transmission-secure").text(function(K){var J="";if(K.component.targetSecure===true){J="\uf023"}else{J="\uf09c"}return J}).each(function(K){var J=y.select("#transmission-secure-"+K.id);if(J.empty()){J=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"transmission-secure-"+K.id}).attr("class","tooltip nifi-tooltip")}J.text(function(){if(K.component.targetSecure===true){return"Site-to-Site is secure."}else{return"Site-to-Site is NOT secure."}});v.canvasTooltip(J,y.select(this))});E.select("path.component-comments").style("visibility",j.isBlank(G.component.comments)?"hidden":"visible").each(function(){var J=y.select("#comments-tip-"+G.id);if(j.isBlank(G.component.comments)){if(!J.empty()){J.remove()}}else{if(J.empty()){J=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+G.id}).attr("class","tooltip nifi-tooltip")}J.text(G.component.comments);v.canvasTooltip(J,y.select(this))}});E.select("text.remote-process-group-last-refresh").text(function(J){if(j.isDefinedAndNotNull(J.component.flowRefreshed)){return J.component.flowRefreshed}else{return"Remote flow not current"}});H.select("text.remote-process-group-name").each(function(K){var J=y.select(this);J.text(null).selectAll("title").remove();v.ellipsis(J,K.component.name)}).append("title").text(function(J){return J.component.name})}else{E.select("text.remote-process-group-uri").text(null);E.select("text.remote-process-group-transmission-secure").text(null);E.select("path.component-comments").style("visibility","hidden");E.select("text.remote-process-group-last-refresh").text(null);H.select("text.remote-process-group-name").text(null);H.call(a)}H.call(e)}else{if(G.permissions.canRead){H.select("text.remote-process-group-name").text(function(K){var J=K.component.name;if(J.length>o){return J.substring(0,o)+String.fromCharCode(8230)}else{return J}})}else{H.select("text.remote-process-group-name").text(null)}H.call(a);if(!E.empty()){E.remove()}}})};var b=function(A){return !j.isEmpty(A.component.authorizationIssues)||!j.isEmpty(A.component.validationErrors)};var p=function(B){var A=[];if(!j.isEmpty(B.component.authorizationIssues)){A=A.concat(B.component.authorizationIssues)}if(!j.isEmpty(B.component.validationErrors)){A=A.concat(B.component.validationErrors)}return A};var e=function(A){if(A.empty()){return}A.select("text.remote-process-group-sent tspan.count").text(function(B){return j.substringBeforeFirst(B.status.aggregateSnapshot.sent," ")});A.select("text.remote-process-group-sent tspan.size").text(function(B){return" "+j.substringAfterFirst(B.status.aggregateSnapshot.sent," ")});A.select("text.remote-process-group-sent tspan.ports").text(function(B){return" "+String.fromCharCode(8594)+" "+B.inputPortCount});A.select("text.remote-process-group-received tspan.ports").text(function(B){return B.outputPortCount+" "+String.fromCharCode(8594)+" "});A.select("text.remote-process-group-received tspan.count").text(function(B){return j.substringBeforeFirst(B.status.aggregateSnapshot.received," ")});A.select("text.remote-process-group-received tspan.size").text(function(B){return" "+j.substringAfterFirst(B.status.aggregateSnapshot.received," ")});A.select("text.remote-process-group-transmission-status").text(function(C){var B="";if(C.permissions.canRead){if(b(C)){B="\uf071"}else{if(C.component.transmitting===true){B="\uf140"}else{B="\ue80a"}}}return B}).attr("font-family",function(C){var B="";if(C.permissions.canRead){if(b(C)||C.component.transmitting){B="FontAwesome"}else{B="flowfont"}}return B}).classed("invalid",function(B){return B.permissions.canRead&&b(B)}).classed("transmitting",function(B){return B.permissions.canRead&&!b(B)&&B.component.transmitting===true}).classed("not-transmitting",function(B){return B.permissions.canRead&&!b(B)&&B.component.transmitting===false}).each(function(C){var B=y.select("#authorization-issues-"+C.id);if(C.permissions.canRead&&b(C)){if(B.empty()){B=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"authorization-issues-"+C.id}).attr("class","tooltip nifi-tooltip")}B.html(function(){var D=j.formatUnorderedList(p(C));if(D===null||D.length===0){return""}else{return g("<div></div>").append(D).html()}});v.canvasTooltip(B,y.select(this))}else{if(!B.empty()){B.remove()}}});A.each(function(D){var B=y.select(this);var C=0;v.activeThreadCount(B,D,function(E){C=E});B.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(D.status.aggregateSnapshot.bulletins)});v.bulletins(B,D,function(){return y.select("#remote-process-group-tooltips")},C)})};var i=function(A){if(A.empty()){return}A.call(a).remove()};var a=function(A){A.each(function(B){g("#bulletin-tip-"+B.id).remove();g("#authorization-issues-"+B.id).remove();g("#transmission-secure-"+B.id).remove();g("#comments-tip-"+B.id).remove()})};var q={init:function(C,D,A,B,E){n=C;t=D;m=A;u=B;k=E;c=y.map();w=y.map();d=y.map();x=y.select("#canvas").append("g").attr({"pointer-events":"all","class":"remote-process-groups"})},add:function(F,B){var D=false;if(j.isDefinedAndNotNull(B)){D=j.isDefinedAndNotNull(B.selectAll)?B.selectAll:D}var A=new Date().getTime();var E=function(G){d.set(G.id,A);c.set(G.id,g.extend({type:"RemoteProcessGroup",dimensions:h},G))};if(g.isArray(F)){g.each(F,function(G,H){E(H)})}else{if(j.isDefinedAndNotNull(F)){E(F)}}var C=s();C.enter().call(f,D);C.call(r)},set:function(G,A){var D=false;var E=false;var C=false;if(j.isDefinedAndNotNull(A)){D=j.isDefinedAndNotNull(A.selectAll)?A.selectAll:D;E=j.isDefinedAndNotNull(A.transition)?A.transition:E;C=j.isDefinedAndNotNull(A.overrideRevisionCheck)?A.overrideRevisionCheck:C}var F=function(H){var I=c.get(H.id);if((z.isNewerRevision(I,H)&&!w.has(H.id))||C===true){c.set(H.id,g.extend({type:"RemoteProcessGroup",dimensions:h},H))}};if(g.isArray(G)){g.each(c.keys(),function(I,J){var K=c.get(J);var H=g.grep(G,function(L){return L.id===K.id});if(H.length===0&&!d.has(J)){c.remove(J)}});g.each(G,function(H,I){F(I)})}else{if(j.isDefinedAndNotNull(G)){F(G)}}var B=s();B.enter().call(f,D);B.call(r).call(v.position,E);B.exit().call(i)},get:function(A){if(j.isUndefined(A)){return c.values()}else{return c.get(A)}},refresh:function(A){if(j.isDefinedAndNotNull(A)){y.select("#id-"+A).call(r)}else{y.selectAll("g.remote-process-group").call(r)}},pan:function(){y.selectAll("g.remote-process-group.entering, g.remote-process-group.leaving").call(r)},reload:function(B){if(c.has(B)){var A=c.get(B);return g.ajax({type:"GET",url:A.uri,dataType:"json"}).done(function(C){q.set(C);var D=l.getComponentConnections(B);g.each(D,function(F,E){if(E.permissions.canRead){l.reload(E.id)}})})}},position:function(A){y.select("#id-"+A).call(v.position)},remove:function(B){var A=new Date().getTime();if(g.isArray(B)){g.each(B,function(D,C){w.set(C,A);c.remove(C)})}else{w.set(B,A);c.remove(B)}s().exit().call(i)},removeAll:function(){q.remove(c.keys())},expireCaches:function(B){var A=function(C){C.forEach(function(E,D){if(B>D){C.remove(E)}})};A(d);A(w)}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.ClusterSummary","nf.CanvasUtils"],function(g,f,h,d,c,e){return(nf.Processor=b(g,f,h,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Processor=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.Processor=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(d,y,h,z,g,u){var l;var q;var j;var i;var t;var m=25;var f={width:350,height:130};var w;var x;var b;var r;var p=function(){return r.selectAll("g.processor").data(w.values(),function(A){return A.id})};var c=function(C,B){if(C.empty()){return}var A=C.append("g").attr({id:function(D){return"id-"+D.id},"class":"processor component"}).classed("selected",B).call(u.position);A.append("rect").attr({"class":"border",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},fill:"transparent",stroke:"transparent"});A.append("rect").attr({"class":"body",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});A.append("text").attr({x:75,y:18,width:210,height:14,"class":"processor-name"});A.append("rect").attr({x:0,y:0,width:50,height:50,"class":"processor-icon-container"});A.append("text").attr({x:9,y:35,"class":"processor-icon"}).text("\ue807");A.append("circle").attr({r:9,cx:12,cy:12,"class":"restricted-background"});A.append("text").attr({x:7.75,y:17,"class":"restricted"}).text("\uf132");A.append("circle").attr({r:9,cx:38,cy:36,"class":"is-primary-background"});A.append("text").attr({x:34.75,y:40,"class":"is-primary"}).text("P").append("title").text(function(D){return"This component is only scheduled to execute on the Primary Node"});A.call(j.activate).call(t.activate).call(i.activate)};var v=function(A){if(A.empty()){return}A.select("rect.border").classed("unauthorized",function(B){return B.permissions.canRead===false}).classed("ghost",function(B){return B.permissions.canRead===true&&B.component.extensionMissing===true});A.select("rect.body").classed("unauthorized",function(B){return B.permissions.canRead===false});A.each(function(G){var D=y.select(this);var B=D.select("g.processor-canvas-details");u.editable(D,l,q);if(D.classed("visible")){if(B.empty()){B=D.append("g").attr("class","processor-canvas-details");B.append("text").attr({"class":"run-status-icon",x:55,y:23});B.append("text").attr({"class":"processor-type",x:75,y:32,width:230,height:12});B.append("text").attr({"class":"processor-bundle",x:75,y:45,width:230,height:12});B.append("rect").attr({width:function(){return G.dimensions.width},height:19,x:0,y:50,fill:"#f4f6f7"});B.append("rect").attr({width:function(){return G.dimensions.width},height:1,x:0,y:68,fill:"#c7d2d7"});B.append("rect").attr({width:function(){return G.dimensions.width},height:19,x:0,y:69,fill:"#ffffff"});B.append("rect").attr({width:function(){return G.dimensions.width},height:1,x:0,y:87,fill:"#c7d2d7"});B.append("rect").attr({width:function(){return G.dimensions.width},height:20,x:0,y:88,fill:"#f4f6f7"});B.append("rect").attr({width:function(){return G.dimensions.width},height:1,x:0,y:106,fill:"#c7d2d7"});B.append("rect").attr({width:function(){return G.dimensions.width},height:19,x:0,y:107,fill:"#ffffff"});var J=B.append("g").attr({transform:"translate(10, 55)"});J.append("text").attr({width:73,height:10,y:9,"class":"stats-label"}).text("In");J.append("text").attr({width:73,height:10,y:27,"class":"stats-label"}).text("Read/Write");J.append("text").attr({width:73,height:10,y:46,"class":"stats-label"}).text("Out");J.append("text").attr({width:73,height:10,y:65,"class":"stats-label"}).text("Tasks/Time");var C=B.append("g").attr({transform:"translate(85, 55)"});var I=C.append("text").attr({width:180,height:9,y:9,"class":"processor-in stats-value"});I.append("tspan").attr({"class":"count"});I.append("tspan").attr({"class":"size"});C.append("text").attr({width:180,height:10,y:27,"class":"processor-read-write stats-value"});var E=C.append("text").attr({width:180,height:10,y:46,"class":"processor-out stats-value"});E.append("tspan").attr({"class":"count"});E.append("tspan").attr({"class":"size"});C.append("text").attr({width:180,height:10,y:65,"class":"processor-tasks-time stats-value"});var H=B.append("g").attr("transform","translate(305, 55)");H.append("text").attr({width:25,height:10,y:9,"class":"stats-info"}).text("5 min");H.append("text").attr({width:25,height:10,y:27,"class":"stats-info"}).text("5 min");H.append("text").attr({width:25,height:10,y:46,"class":"stats-info"}).text("5 min");H.append("text").attr({width:25,height:10,y:65,"class":"stats-info"}).text("5 min");B.append("path").attr({"class":"component-comments",transform:"translate("+(G.dimensions.width-2)+", "+(G.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});B.append("text").attr({"class":"active-thread-count-icon",y:45}).text("\ue83f");B.append("text").attr({"class":"active-thread-count",y:45});B.append("rect").attr({"class":"bulletin-background",x:function(K){return G.dimensions.width-24},width:24,height:24});B.append("text").attr({"class":"bulletin-icon",x:function(K){return G.dimensions.width-17},y:17}).text("\uf24a")}if(G.permissions.canRead){D.select("text.processor-name").each(function(L){var K=y.select(this);K.text(null).selectAll("title").remove();u.ellipsis(K,L.component.name)}).append("title").text(function(K){return K.component.name});D.select("text.processor-type").each(function(L){var K=y.select(this);K.text(null).selectAll("title").remove();u.ellipsis(K,h.formatType(L.component))}).append("title").text(function(K){return h.formatType(K.component)});D.select("text.processor-bundle").each(function(L){var K=y.select(this);K.text(null).selectAll("title").remove();u.ellipsis(K,h.formatBundle(L.component.bundle))}).append("title").text(function(K){return h.formatBundle(K.component.bundle)});D.select("path.component-comments").style("visibility",h.isBlank(G.component.config.comments)?"hidden":"visible").each(function(){var K=y.select("#comments-tip-"+G.id);if(h.isBlank(G.component.config.comments)){if(!K.empty()){K.remove()}}else{if(K.empty()){K=y.select("#processor-tooltips").append("div").attr("id",function(){return"comments-tip-"+G.id}).attr("class","tooltip nifi-tooltip")}K.text(G.component.config.comments);u.canvasTooltip(K,y.select(this))}})}else{D.select("text.processor-name").text(null);D.select("text.processor-type").text(null);D.select("text.processor-bundle").text(null);D.select("path.component-comments").style("visibility","hidden");D.call(a)}D.call(e)}else{if(G.permissions.canRead){D.select("text.processor-name").text(function(L){var K=L.component.name;if(K.length>m){return K.substring(0,m)+String.fromCharCode(8230)}else{return K}})}else{D.select("text.processor-name").text(null)}D.call(a);if(!B.empty()){B.remove()}}D.select("rect.processor-icon-container").classed("unauthorized",!G.permissions.canRead);D.select("text.processor-icon").classed("unauthorized",!G.permissions.canRead);D.select("rect.border").classed("unauthorized",!G.permissions.canRead);if(G.permissions.canRead){if(h.isDefinedAndNotNull(G.component.style["background-color"])){var F=G.component.style["background-color"];D.select("rect.processor-icon-container").style("fill",function(K){return F});D.select("rect.border").style("stroke",function(K){return F})}}D.select("text.processor-icon").style("fill",function(L){var K=o.defaultIconColor();if(!L.permissions.canRead){return K}if(h.isDefinedAndNotNull(L.component.style["background-color"])){K=L.component.style["background-color"];if(K.toLowerCase()==="#ffffff"){K=o.defaultIconColor()}else{K=h.determineContrastColor(h.substringAfterLast(K,"#"))}}return K});D.select("circle.restricted-background").style("visibility",k);D.select("text.restricted").style("visibility",k);D.select("circle.is-primary-background").style("visibility",n);D.select("text.is-primary").style("visibility",n)})};var k=function(A){if(!A.permissions.canRead){return"hidden"}return A.component.restricted?"visible":"hidden"};var n=function(A){return g.isClustered()&&A.status.aggregateSnapshot.executionNode==="PRIMARY"?"visible":"hidden"};var e=function(A){if(A.empty()){return}A.select("text.run-status-icon").attr({fill:function(C){var B="#728e9b";if(C.status.aggregateSnapshot.runStatus==="Invalid"){B="#cf9f5d"}else{if(C.status.aggregateSnapshot.runStatus==="Running"){B="#7dc7a0"}else{if(C.status.aggregateSnapshot.runStatus==="Stopped"){B="#d18686"}}}return B},"font-family":function(C){var B="FontAwesome";if(C.status.aggregateSnapshot.runStatus==="Disabled"){B="flowfont"}return B}}).text(function(C){var B="";if(C.status.aggregateSnapshot.runStatus==="Disabled"){B="\ue802"}else{if(C.status.aggregateSnapshot.runStatus==="Invalid"){B="\uf071"}else{if(C.status.aggregateSnapshot.runStatus==="Running"){B="\uf04b"}else{if(C.status.aggregateSnapshot.runStatus==="Stopped"){B="\uf04d"}}}}return B}).each(function(C){var B=y.select("#run-status-tip-"+C.id);if(C.permissions.canRead&&!h.isEmpty(C.component.validationErrors)){if(B.empty()){B=y.select("#processor-tooltips").append("div").attr("id",function(){return"run-status-tip-"+C.id}).attr("class","tooltip nifi-tooltip")}B.html(function(){var D=h.formatUnorderedList(C.component.validationErrors);if(D===null||D.length===0){return""}else{return d("<div></div>").append(D).html()}});u.canvasTooltip(B,y.select(this))}else{if(!B.empty()){B.remove()}}});A.select("text.processor-in tspan.count").text(function(B){return h.substringBeforeFirst(B.status.aggregateSnapshot.input," ")});A.select("text.processor-in tspan.size").text(function(B){return" "+h.substringAfterFirst(B.status.aggregateSnapshot.input," ")});A.select("text.processor-read-write").text(function(B){return B.status.aggregateSnapshot.read+" / "+B.status.aggregateSnapshot.written});A.select("text.processor-out tspan.count").text(function(B){return h.substringBeforeFirst(B.status.aggregateSnapshot.output," ")});A.select("text.processor-out tspan.size").text(function(B){return" "+h.substringAfterFirst(B.status.aggregateSnapshot.output," ")});A.select("text.processor-tasks-time").text(function(B){return B.status.aggregateSnapshot.tasks+" / "+B.status.aggregateSnapshot.tasksDuration});A.each(function(C){var B=y.select(this);u.activeThreadCount(B,C);B.select("rect.bulletin-background").classed("has-bulletins",function(){return !h.isEmpty(C.status.aggregateSnapshot.bulletins)});u.bulletins(B,C,function(){return y.select("#processor-tooltips")},286)})};var s=function(A){if(A.empty()){return}A.call(a).remove()};var a=function(A){A.each(function(B){d("#run-status-tip-"+B.id).remove();d("#bulletin-tip-"+B.id).remove();d("#comments-tip-"+B.id).remove()})};var o={init:function(C,D,A,B,E){l=C;q=D;j=A;t=B;i=E;w=y.map();x=y.map();b=y.map();r=y.select("#canvas").append("g").attr({"pointer-events":"all","class":"processors"})},add:function(A,C){var E=false;if(h.isDefinedAndNotNull(C)){E=h.isDefinedAndNotNull(C.selectAll)?C.selectAll:E}var B=new Date().getTime();var F=function(G){b.set(G.id,B);w.set(G.id,d.extend({type:"Processor",dimensions:f},G))};if(d.isArray(A)){d.each(A,function(G,H){F(H)})}else{if(h.isDefinedAndNotNull(A)){F(A)}}var D=p();D.enter().call(c,E);D.call(v)},set:function(A,B){var E=false;var F=false;var D=false;if(h.isDefinedAndNotNull(B)){E=h.isDefinedAndNotNull(B.selectAll)?B.selectAll:E;F=h.isDefinedAndNotNull(B.transition)?B.transition:F;D=h.isDefinedAndNotNull(B.overrideRevisionCheck)?B.overrideRevisionCheck:D}var G=function(I){var H=w.get(I.id);if((z.isNewerRevision(H,I)&&!x.has(I.id))||D===true){w.set(I.id,d.extend({type:"Processor",dimensions:f},I))}};if(d.isArray(A)){d.each(w.keys(),function(I,J){var K=w.get(J);var H=d.grep(A,function(L){return L.id===K.id});if(H.length===0&&!b.has(J)){w.remove(J)}});d.each(A,function(H,I){G(I)})}else{if(h.isDefinedAndNotNull(A)){G(A)}}var C=p();C.enter().call(c,E);C.call(v).call(u.position,F);C.exit().call(s)},get:function(A){if(h.isUndefined(A)){return w.values()}else{return w.get(A)}},refresh:function(A){if(h.isDefinedAndNotNull(A)){y.select("#id-"+A).call(v)}else{y.selectAll("g.processor").call(v)}},position:function(A){y.select("#id-"+A).call(u.position)},pan:function(){y.selectAll("g.processor.entering, g.processor.leaving").call(v)},reload:function(B){if(w.has(B)){var A=w.get(B);return d.ajax({type:"GET",url:A.uri,dataType:"json"}).done(function(C){o.set(C)})}},remove:function(B){var A=new Date().getTime();if(d.isArray(B)){d.each(B,function(C,D){x.set(D,A);w.remove(D)})}else{x.set(B,A);w.remove(B)}p().exit().call(s)},removeAll:function(){o.remove(w.keys())},expireCaches:function(B){var A=function(C){C.forEach(function(E,D){if(B>D){C.remove(E)}})};A(b);A(x)},defaultFillColor:function(){return"#FFFFFF"},defaultIconColor:function(){return"#ad9897"}};return o}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Processor","nf.ClusterSummary","nf.CustomUi","nf.UniversalCapture","nf.Connection"],function(f,l,c,e,n,d,g,m,k,j,h,i){return(nf.ProcessorConfiguration=b(f,l,c,e,n,d,g,m,k,j,h,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorConfiguration=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ClusterSummary"),require("nf.CustomUi"),require("nf.UniversalCapture"),require("nf.Connection")))}else{nf.ProcessorConfiguration=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Processor,a.nf.ClusterSummary,a.nf.CustomUi,a.nf.UniversalCapture,a.nf.Connection)}}}(this,function(d,f,h,m,w,t,x,l,g,b,s,i){var j=[0,25,50,100,250,500,1000,2000];var n=function(y){var z=[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Processor will be scheduled to run on an interval defined by the run schedule."}];if(y.supportsEventDriven===true){z.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental."})}else{if(y.config.schedulingStrategy==="EVENT_DRIVEN"){z.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental.",disabled:true})}}if(y.config.schedulingStrategy==="PRIMARY_NODE_ONLY"){z.push({text:"On primary node",value:"PRIMARY_NODE_ONLY",description:"Processor will be scheduled on the primary node on an interval defined by the run schedule. This option has been deprecated, please use the Execution setting below.",disabled:true})}z.push({text:"CRON driven",value:"CRON_DRIVEN",description:"Processor will be scheduled to run on at specific times based on the specified CRON string."});return z};var e=function(y){return[{text:"All nodes",value:"ALL",description:"Processor will be scheduled to run on all nodes"},{text:"Primary node",value:"PRIMARY",description:"Processor will be scheduled to run only on the primary node",disabled:!g.isClustered()&&y.config.executionNode==="PRIMARY"}]};var a=function(B,y,z){if(B.status===400){var C=B.responseText.split("\n");var A;if(C.length===1){A=d("<span></span>").text(C[0])}else{A=h.formatUnorderedList(C)}m.showOkDialog({dialogContent:A,headerText:"Processor Configuration"})}else{f.handleAjaxError(B,y,z)}};var o=function(D){var y=d('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(D.name);var A=d('<span class="relationship-name-value hidden"></span>').text(D.name);var B=d('<div class="processor-relationship nf-checkbox"></div>');if(D.autoTerminate===true){B.addClass("checkbox-checked")}else{B.addClass("checkbox-unchecked")}var C=d('<div class="processor-relationship-container"></div>').append(B).append(y).append(A).appendTo("#auto-terminate-relationship-names");if(!h.isBlank(D.description)){var z=d('<div class="relationship-description"></div>').text(D.description);C.append(z)}return C};var v=function(){var A=d("#processor-configuration").data("processorDetails");var B=false;var C=q();d.each(A.relationships,function(E,F){if(F.autoTerminate===true){if(d.inArray(F.name,C)===-1){B=true;return false}}else{if(F.autoTerminate===false){if(d.inArray(F.name,C)>=0){B=true;return false}}}});if(B){return true}var D=d("#scheduling-strategy-combo").combo("getSelectedOption").value;if(D!==(A.config.schedulingStrategy+"")){return true}if(A.supportsParallelProcessing===true){var y;if(D==="EVENT_DRIVEN"){y=d("#event-driven-concurrently-schedulable-tasks")}else{if(D==="CRON_DRIVEN"){y=d("#cron-driven-concurrently-schedulable-tasks")}else{y=d("#timer-driven-concurrently-schedulable-tasks")}}if(y.val()!==(A.config.concurrentlySchedulableTaskCount+"")){return true}}var z;if(D==="CRON_DRIVEN"){z=d("#cron-driven-scheduling-period")}else{if(D!=="EVENT_DRIVEN"){z=d("#timer-driven-scheduling-period")}}if(h.isDefinedAndNotNull(z)&&z.val()!==(A.config.schedulingPeriod+"")){return true}if(d("#execution-node-combo").combo("getSelectedOption").value!==(A.config.executionNode+"")){return true}if(d("#processor-name").val()!==A.name){return true}if(d("#processor-enabled").hasClass("checkbox-checked")&&A.state==="DISABLED"){return true}else{if(d("#processor-enabled").hasClass("checkbox-unchecked")&&(A.state==="RUNNING"||A.state==="STOPPED")){return true}}if(d("#penalty-duration").val()!==(A.config.penaltyDuration+"")){return true}if(d("#yield-duration").val()!==(A.config.yieldDuration+"")){return true}if(d("#bulletin-level-combo").combo("getSelectedOption").value!==(A.config.bulletinLevel+"")){return true}if(d("#processor-comments").val()!==A.config.comments){return true}return d("#processor-properties").propertytable("isSaveRequired")};var k=function(A){var C={};var y=d("#scheduling-strategy-combo").combo("getSelectedOption").value;var F;if(y==="EVENT_DRIVEN"){F=d("#event-driven-concurrently-schedulable-tasks")}else{if(y==="CRON_DRIVEN"){F=d("#cron-driven-concurrently-schedulable-tasks")}else{F=d("#timer-driven-concurrently-schedulable-tasks")}}if(!F.is(":disabled")){C.concurrentlySchedulableTaskCount=F.val()}var D;if(y==="CRON_DRIVEN"){D=d("#cron-driven-scheduling-period")}else{if(y!=="EVENT_DRIVEN"){D=d("#timer-driven-scheduling-period")}}if(h.isDefinedAndNotNull(D)){C.schedulingPeriod=D.val()}C.executionNode=d("#execution-node-combo").combo("getSelectedOption").value;C.penaltyDuration=d("#penalty-duration").val();C.yieldDuration=d("#yield-duration").val();C.bulletinLevel=d("#bulletin-level-combo").combo("getSelectedOption").value;C.schedulingStrategy=y;C.comments=d("#processor-comments").val();if(A.supportsBatching===true){var z=d("#run-duration-slider").slider("value");C.runDurationMillis=j[z]}C.autoTerminatedRelationships=q();var E=d("#processor-properties").propertytable("marshalProperties");if(d.isEmptyObject(E)===false){C.properties=E}var B={};B.id=d("#processor-id").text();B.name=d("#processor-name").val();B.config=C;if(d("#processor-enabled").hasClass("checkbox-unchecked")){B.state="DISABLED"}else{if(d("#processor-enabled").hasClass("checkbox-checked")){B.state="STOPPED"}}var G={};G.component=B;return G};var q=function(){var z=d("#auto-terminate-relationship-names");var y=[];d.each(z.children(),function(A,D){var C=d(D);var B=C.children("div.processor-relationship");if(B.hasClass("checkbox-checked")){y.push(C.children("span.relationship-name-value").text())}});return y};var u=function(z){var B=[];var A=z.component;var y=A.config;if(h.isDefinedAndNotNull(y.concurrentlySchedulableTaskCount)&&!d.isNumeric(y.concurrentlySchedulableTaskCount)){B.push("Concurrent tasks must be an integer value")}if(h.isDefinedAndNotNull(y.schedulingPeriod)&&h.isBlank(y.schedulingPeriod)){B.push("Run schedule must be specified")}if(h.isBlank(y.penaltyDuration)){B.push("Penalty duration must be specified")}if(h.isBlank(y.yieldDuration)){B.push("Yield duration must be specified")}if(B.length>0){m.showOkDialog({dialogContent:h.formatUnorderedList(B),headerText:"Processor Configuration"});return false}else{return true}};var c=function(z){var y=i.getComponentConnections(z.id);d.each(y,function(B,A){if(A.permissions.canRead){if(A.sourceId===z.id){i.reload(A.id)}}})};var p=function(){return d.Deferred(function(y){d("#processor-properties").propertytable("saveRow");if(v()){m.showYesNoDialog({headerText:"Processor Configuration",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){y.resolve()},yesHandler:function(){var z=d("#processor-configuration").data("processorDetails");r(z).done(function(){y.resolve()}).fail(function(){y.reject()})}})}else{y.resolve()}}).promise()};var r=function(y){var z=k(y);if(u(z)){var A=l.get(y.id);z.revision=w.getRevision(A);return d.ajax({type:"PUT",data:JSON.stringify(z),url:A.uri,dataType:"json",contentType:"application/json"}).done(function(B){l.set(B)}).fail(a)}else{return d.Deferred(function(B){B.reject()}).promise()}};return{init:function(){d("#processor-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"processor-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"processor-scheduling-tab-content"},{name:"Properties",tabContentId:"processor-properties-tab-content"},{name:"Comments",tabContentId:"processor-comments-tab-content"}],select:function(){s.removeAllPropertyDetailDialogs();if(d(this).text()==="Properties"){d("#processor-properties").propertytable("resetTableSize")}d("#processor-properties").propertytable("saveRow");var y=d("#auto-terminate-relationship-names");if(y.is(":visible")&&y.get(0).scrollHeight>Math.round(y.innerHeight())){y.css("border-width","1px")}}});d("#processor-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Processor",handler:{close:function(){d("#auto-terminate-relationship-names").css("border-width","0").empty();d("#processor-properties").propertytable("cancelEdit").propertytable("clear");d("#processor-configuration").removeData("processorDetails")},open:function(){h.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});d("#bulletin-level-combo").combo({options:[{text:"DEBUG",value:"DEBUG"},{text:"INFO",value:"INFO"},{text:"WARN",value:"WARN"},{text:"ERROR",value:"ERROR"},{text:"NONE",value:"NONE"}]});d("#run-duration-slider").slider({min:0,max:j.length-1,change:function(z,A){var y=d("#processor-configuration").data("processorDetails");if(A.value>0&&(y.inputRequirement==="INPUT_FORBIDDEN"||y.inputRequirement==="INPUT_ALLOWED")){d("#run-duration-data-loss").show()}else{d("#run-duration-data-loss").hide()}}});d("#processor-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-processor-property-container",descriptorDeferred:function(y){var z=d("#processor-configuration").data("processorDetails");var A=l.get(z.id);return d.ajax({type:"GET",url:A.uri+"/descriptors",data:{propertyName:y},dataType:"json"}).fail(f.handleAjaxError)},goToServiceDeferred:p})},showConfiguration:function(z){if(t.isProcessor(z)){var A=z.datum();var y=A.component;var B=[];B.push(l.reload(y.id));B.push(d.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"}));d.when.apply(window,B).done(function(K,N){var L=K[0];y=L.component;var H=N[0].componentHistory;d("#processor-configuration").data("processorDetails",y);var G="checkbox-checked";if(y.state==="DISABLED"){G="checkbox-unchecked"}d("#processor-id").text(y.id);d("#processor-type").text(h.formatType(y));d("#processor-bundle").text(h.formatBundle(y.bundle));d("#processor-name").val(y.name);d("#processor-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(G);d("#penalty-duration").val(y.config.penaltyDuration);d("#yield-duration").val(y.config.yieldDuration);d("#processor-comments").val(y.config.comments);if(y.supportsBatching===true){d("#run-duration-setting-container").show();var M=j.indexOf(y.config.runDurationMillis);d("#run-duration-slider").slider("value",M)}else{d("#run-duration-setting-container").hide()}d("#bulletin-level-combo").combo("setSelectedOption",{value:y.config.bulletinLevel});var E=y.config.schedulingStrategy;d("#scheduling-strategy-combo").combo({options:n(y),selectedOption:{value:E},select:function(P){if(P.value==="EVENT_DRIVEN"){d("#event-driven-warning").show();d("#timer-driven-options").hide();d("#event-driven-options").show();d("#cron-driven-options").hide()}else{d("#event-driven-warning").hide();if(P.value==="CRON_DRIVEN"){d("#timer-driven-options").hide();d("#event-driven-options").hide();d("#cron-driven-options").show()}else{d("#timer-driven-options").show();d("#event-driven-options").hide();d("#cron-driven-options").hide()}}}});var D=y.config.executionNode;d("#execution-node-combo").combo({options:e(y),selectedOption:{value:D}});if(g.isClustered()||D==="PRIMARY"){d("#execution-node-options").show()}else{d("#execution-node-options").hide()}var O=y.config.defaultConcurrentTasks;d("#timer-driven-concurrently-schedulable-tasks").val(O.TIMER_DRIVEN);d("#event-driven-concurrently-schedulable-tasks").val(O.EVENT_DRIVEN);d("#cron-driven-concurrently-schedulable-tasks").val(O.CRON_DRIVEN);var J;if(E==="EVENT_DRIVEN"){J=d("#event-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}else{if(E==="CRON_DRIVEN"){J=d("#cron-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}else{J=d("#timer-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}}if(h.isDefinedAndNotNull(J)){if(y.supportsParallelProcessing===true){J.prop("disabled",false)}else{J.prop("disabled",true)}}var F=y.config.defaultSchedulingPeriod;d("#cron-driven-scheduling-period").val(F.CRON_DRIVEN);d("#timer-driven-scheduling-period").val(F.TIMER_DRIVEN);if(y.config.schedulingStrategy==="CRON_DRIVEN"){d("#cron-driven-scheduling-period").val(y.config.schedulingPeriod)}else{if(y.config.schedulingStrategy!=="EVENT_DRIVEN"){d("#timer-driven-scheduling-period").val(y.config.schedulingPeriod)}}if(!h.isEmpty(y.relationships)){d.each(y.relationships,function(P,Q){o(Q)})}else{d("#auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}var I=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#processor-properties").propertytable("saveRow");r(y).done(function(P){c(y);d("#processor-configuration").modal("hide");x.digest()})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){d("#processor-configuration").modal("hide")}}}];if(h.isDefinedAndNotNull(y.config.customUiUrl)&&y.config.customUiUrl!==""){I.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var P=function(){d("#processor-configuration").modal("hide");b.showCustomUi(L,y.config.customUiUrl,true).done(function(){l.reload(y.id);c(y)})};d("#processor-properties").propertytable("saveRow");if(v()){m.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:P,yesHandler:function(){r(y).done(function(Q){P()})}})}else{P()}}}})}d("#processor-configuration").modal("setButtonModel",I);d("#processor-properties").propertytable("setGroupId",y.parentGroupId).propertytable("loadProperties",y.config.properties,y.config.descriptors,H.propertyHistory);d("#processor-configuration").modal("show");d("#processor-configuration div.relationship-name").ellipsis();var C=d("#auto-terminate-relationship-names");if(C.is(":visible")&&C.get(0).scrollHeight>Math.round(C.innerHeight())){C.css("border-width","1px")}}).fail(f.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary"],function(f,g,i,e,h,d,c){return(nf.ProcessorDetails=b(f,g,i,e,h,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary)}}}(this,function(e,f,h,d,g,c,a){var b=function(l){var i=e('<div class="relationship-name ellipsis"></div>').text(l.name);if(l.autoTerminate===true){i.css("font-weight","bold")}var k=e('<div class="processor-relationship-container"></div>').append(i).appendTo("#read-only-auto-terminate-relationship-names");if(!f.isBlank(l.description)){var j=e('<div class="relationship-description"></div>').text(l.description);k.append(j)}return k};return{init:function(i){e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){h.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}var j=e("#read-only-auto-terminate-relationship-names");if(j.is(":visible")&&j.get(0).scrollHeight>Math.round(j.innerHeight())){j.css("border-width","1px")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-terminate-relationship-names").css("border-width","0").empty();e("#read-only-processor-properties").propertytable("clear");f.clearField("read-only-processor-id");f.clearField("read-only-processor-type");f.clearField("read-only-processor-name");f.clearField("read-only-concurrently-schedulable-tasks");f.clearField("read-only-scheduling-period");f.clearField("read-only-penalty-duration");f.clearField("read-only-yield-duration");f.clearField("read-only-run-duration");f.clearField("read-only-bulletin-level");f.clearField("read-only-execution-node");f.clearField("read-only-execution-status");f.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory")},open:function(){f.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});e("#read-only-processor-properties").propertytable({supportsGoTo:i,readOnly:true})},showDetails:function(k,l){var j=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(l),dataType:"json"}).done(function(n){if(f.isDefinedAndNotNull(n.component)){var o=n.component;e("#processor-details").data("processorDetails",o);f.populateField("read-only-processor-id",o.id);f.populateField("read-only-processor-type",f.formatType(o));f.populateField("read-only-processor-bundle",f.formatBundle(o.bundle));f.populateField("read-only-processor-name",o.name);f.populateField("read-only-concurrently-schedulable-tasks",o.config.concurrentlySchedulableTaskCount);f.populateField("read-only-scheduling-period",o.config.schedulingPeriod);f.populateField("read-only-penalty-duration",o.config.penaltyDuration);f.populateField("read-only-yield-duration",o.config.yieldDuration);f.populateField("read-only-run-duration",f.formatDuration(o.config.runDurationMillis));f.populateField("read-only-bulletin-level",o.config.bulletinLevel);f.populateField("read-only-processor-comments",o.config.comments);var m=true;var q=o.config.schedulingStrategy;if(q==="EVENT_DRIVEN"){m=false;q="Event driven"}else{if(q==="CRON_DRIVEN"){q="CRON driven"}else{if(q==="TIMER_DRIVEN"){q="Timer driven"}else{q="On primary node"}}}f.populateField("read-only-scheduling-strategy",q);if(m===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var p=o.config.executionNode;if(a.isClustered()||p==="PRIMARY"){if(p==="ALL"){p="All nodes"}else{if(p==="PRIMARY"){p="Primary node only"}}f.populateField("read-only-execution-node",p);e("#read-only-execution-node-options").show()}else{e("#read-only-execution-node-options").hide()}if(!f.isEmpty(o.relationships)){e.each(o.relationships,function(r,s){b(s)})}else{e("#read-only-auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}}});var i=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(l),dataType:"json"}).done(function(m){var n=m.componentHistory;e("#processor-details").data("processorHistory",n)});e.when(j,i).done(function(t,o){var q=t[0];var n=q.component;var m=o[0];var s=m.componentHistory;e("#read-only-processor-properties").propertytable("loadProperties",n.config.properties,n.config.descriptors,s.propertyHistory);var p=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&f.isDefinedAndNotNull(c)&&f.isDefinedAndNotNull(n.config.customUiUrl)&&n.config.customUiUrl!==""){p.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");c.showCustomUi(q,n.config.customUiUrl,false)}}})}e("#processor-details").modal("setButtonModel",p).modal("show");e("#processor-details div.relationship-name").ellipsis();var r=e("#read-only-auto-terminate-relationship-names");if(r.is(":visible")&&r.get(0).scrollHeight>Math.round(r.innerHeight())){r.css("border-width","1px")}}).fail(function(o,m,n){if(o.status===400||o.status===404||o.status===409){d.showOkDialog({headerText:"Error",dialogContent:f.escapeHtml(o.responseText)})}else{g.handleAjaxError(o,m,n)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Label"],function(g,f,i,h,d,e,c,j){return(nf.LabelConfiguration=b(g,f,i,h,d,e,c,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.LabelConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Label")))}else{nf.LabelConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Label)}}}(this,function(e,h,g,b,i,c,f,d){var a="";return{init:function(){e("#label-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Label",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=h.select("#id-"+a).datum();var m=e("#label-value").val();var o=e("#label-font-size").combo("getSelectedOption");var l={revision:i.getRevision(n),component:{id:a,label:m,style:{"font-size":o.value}}};e.ajax({type:"PUT",url:n.uri,data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(p){d.set(p);f.digest()}).fail(g.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){a=""},open:function(){e("#label-value").focus()}}});var k=[];for(var j=12;j<=24;j+=2){k.push({text:j+"px",value:j+"px"})}e("#label-font-size").combo({options:k,selectedOption:{value:"12px"},select:function(m){var l=e("#label-value");l.css({"font-size":m.value,"line-height":m.value}).val(l.val())}})},showConfiguration:function(k){if(c.isLabel(k)){var m=k.datum();var j="";if(b.isDefinedAndNotNull(m.component.label)){j=m.component.label}var l="12px";if(b.isDefinedAndNotNull(m.component.style["font-size"])){l=m.component.style["font-size"]}a=m.id;e("#label-value").val(j);e("#label-font-size").combo("setSelectedOption",{value:l});e("#label-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Port"],function(g,j,i,c,e,k,d,h,f){return(nf.PortConfiguration=b(g,j,i,c,e,k,d,h,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Port")))}else{nf.PortConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Port)}}}(this,function(f,i,h,b,d,j,c,g,e){var a=function(){f("#port-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Port",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=f("#port-id").text();var l=i.select("#id-"+n).datum();var k={id:n,name:f("#port-name").val(),comments:f("#port-comments").val()};if(f("#port-concurrent-task-container").is(":visible")){k.concurrentlySchedulableTaskCount=f("#port-concurrent-tasks").val()}if(f("#port-enabled").hasClass("checkbox-unchecked")){k.state="DISABLED"}else{if(f("#port-enabled").hasClass("checkbox-checked")){k.state="STOPPED"}}var m={revision:j.getRevision(l),component:k};f.ajax({type:"PUT",data:JSON.stringify(m),url:l.uri,dataType:"json",contentType:"application/json"}).done(function(o){e.set(o);g.digest();f("#port-configuration").modal("hide")}).fail(function(r,o,p){if(r.status===400){var s=r.responseText.split("\n");var q;if(s.length===1){q=f("<span></span>").text(s[0])}else{q=b.formatUnorderedList(s)}d.showOkDialog({dialogContent:q,headerText:"Port Configuration"})}else{f("#port-configuration").modal("hide");h.handleAjaxError(r,o,p)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#port-configuration").modal("hide")}}}],handler:{close:function(){f("#port-id").text("");f("#port-name").val("");f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked");f("#port-concurrent-tasks").val("");f("#port-comments").val("")}}})};return{init:function(){a()},showConfiguration:function(l){if(c.isInputPort(l)||c.isOutputPort(l)){var m=l.datum();var k="checkbox-checked";if(m.component.state==="DISABLED"){k="checkbox-unchecked"}if(c.getParentGroupId()===null){f("#port-concurrent-task-container").show()}else{f("#port-concurrent-task-container").hide()}f("#port-id").text(m.id);f("#port-name").val(m.component.name);f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(k);f("#port-concurrent-tasks").val(m.component.concurrentlySchedulableTaskCount);f("#port-comments").val(m.component.comments);f("#port-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.PortDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.PortDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#port-details").modal({scrollableContentStyle:"scrollable",headerText:"Port Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#port-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-port-name");c.clearField("read-only-port-id");c.clearField("read-only-port-comments")}}})},showDetails:function(d){if(a.isInputPort(d)||a.isOutputPort(d)){var e=d.datum();c.populateField("read-only-port-name",e.component.name);c.populateField("read-only-port-id",e.id);c.populateField("read-only-port-comments",e.component.comments);b("#port-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,j,i,f,g,k,c,d,e){return(nf.ProcessGroupConfiguration=b(h,j,i,f,g,k,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(d,q,e,g,i,r,f,o,l){var c;var p={urls:{api:"../nifi-api"}};var j=function(){};var b=function(){return d("#process-group-controller-services-table")};var a=function(s,u){var t={revision:r.getRevision({revision:{version:s}}),component:{id:u,name:d("#process-group-name").val(),comments:d("#process-group-comments").val()}};d.ajax({type:"PUT",data:JSON.stringify(t),url:p.urls.api+"/process-groups/"+encodeURIComponent(u),dataType:"json",contentType:"application/json"}).done(function(v){if(v.permissions.canRead&&v.component.parentGroupId===l.getGroupId()){f.set(v)}i.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});d("#process-group-configuration-save").off("click").on("click",function(){a(v.revision.version,u)});l.reload()}).fail(e.handleAjaxError)};var k=function(u){var x=function(){d("#read-only-process-group-name").addClass("unset").text("Unauthorized");d("#read-only-process-group-comments").addClass("unset").text("Unauthorized")};var w=function(y){if(y){d("#process-group-configuration div.editable").show();d("#process-group-configuration div.read-only").hide();d("#process-group-configuration-save").show()}else{d("#process-group-configuration div.editable").hide();d("#process-group-configuration div.read-only").show();d("#process-group-configuration-save").hide()}};d("#process-group-id").text(u);d("#process-group-configuration-refresh-button").off("click").on("click",function(){k(u)});d("#add-process-group-configuration-controller-service").off("click").on("click",function(){var z=d("#process-group-configuration-tabs li.selected-tab").text();if(z==="Controller Services"){var y=p.urls.api+"/process-groups/"+encodeURIComponent(u)+"/controller-services";c.promptNewControllerService(y,b())}});var v=d.Deferred(function(y){d.ajax({type:"GET",url:p.urls.api+"/process-groups/"+encodeURIComponent(u),dataType:"json"}).done(function(z){d("#process-group-configuration").data("process-group",z);var A=z.component;if(z.permissions.canWrite){d("#process-group-name").removeClass("unset").val(A.name);d("#process-group-comments").removeClass("unset").val(A.comments);d("#process-group-configuration-header-text").text(A.name+" Configuration");w(true);d("#process-group-configuration-save").off("click").on("click",function(){a(z.revision.version,z.id)})}else{if(z.permissions.canRead){d("#read-only-process-group-name").removeClass("unset").text(A.name);d("#read-only-process-group-comments").removeClass("unset").text(A.comments);d("#process-group-configuration-header-text").text(A.name+" Configuration")}else{x()}w(false)}y.resolve()}).fail(function(B,z,A){if(B.status===403){if(u===l.getGroupId()){d("#process-group-configuration").data("process-group",{permissions:{canRead:false,canWrite:l.canWriteCurrentGroup()}})}else{d("#process-group-configuration").data("process-group",f.get(u))}x();w(false);y.resolve()}else{y.reject(B,z,A)}})}).promise();var s=p.urls.api+"/flow/process-groups/"+encodeURIComponent(u)+"/controller-services";var t=c.loadControllerServices(s,b());return d.when(v,t).done(function(A,z){var y=z[0];d("#process-group-configuration-last-refreshed").text(y.currentTime)}).fail(e.handleAjaxError)};var m=function(){o.showContent("#process-group-configuration").done(function(){n()});d("#process-group-configuration-tabs").find(".selected-tab").click();h.resetTableSize()};var n=function(){d("#process-group-configuration").removeData("process-group");d("#process-group-configuration-save").mouseout();d("#process-group-id").text("");d("#process-group-name").val("");d("#process-group-comments").val("");d("#process-group-configuration-header-text").text("Process Group Configuration")};var h={init:function(s){c=s;d("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var u=d("#process-group-configuration").data("process-group");var v=g.isDefinedAndNotNull(u)?u.permissions.canWrite:false;var t=d(this).text();if(t==="General"){d("#flow-cs-availability").hide();d("#add-process-group-configuration-controller-service").hide();if(v){d("#process-group-configuration-save").show()}else{d("#process-group-configuration-save").hide()}}else{d("#flow-cs-availability").show();d("#process-group-configuration-save").hide();if(v){d("#add-process-group-configuration-controller-service").show();d("#process-group-controller-services-tab-content").css("top","32px")}else{d("#add-process-group-configuration-controller-service").hide();d("#process-group-controller-services-tab-content").css("top","0")}h.resetTableSize()}}});j();c.init(b())},resetTableSize:function(){c.resetTableSize(b())},showConfiguration:function(s){return k(s).done(m)},loadConfiguration:function(s){return k(s)},selectControllerService:function(s){var t=b().data("gridInstance");var u=t.getData();var v=u.getRowById(s);t.setSelectedRows([v]);t.scrollRowIntoView(v);d("#process-group-configuration-tabs").find("li:eq(1)").click()}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Canvas","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Client","nf.Common","nf.ng.Bridge","nf.Processor","nf.ProcessGroup","nf.ProcessGroupConfiguration"],function(i,n,f,m,g,l,h,o,e,j,k,c,d){return(nf.ComponentState=b(i,n,f,m,g,l,h,o,e,j,k,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("d3"),require("Slick"),require("nf.Canvas"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Client"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration")))}else{nf.VariableRegistry=b(a.$,a.d3,a.Slick,a.nf.Canvas,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Client,a.nf.Common,a.nf.ng.Bridge,a.nf.Processor,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration)}}}(this,function(z,H,b,u,J,e,h,g,G,n,s,x,A){var C=null;var i=function(P){var Q=this;var M="";var N;var S;var R;var O;this.init=function(){var U=z("body");N=P.item[P.column.field];S=z("<div></div>").addClass("slickgrid-editor").css({"z-index":100000,position:"absolute","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",overflow:"hidden",padding:"10px 20px",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).appendTo(U);O=z('<textarea hidefocus rows="5"/>').css({height:"80px",width:P.position.width+"px","min-width":"212px","margin-bottom":"5px","margin-top":"10px","white-space":"pre"}).tab().on("keydown",Q.handleKeyDown).appendTo(S);S.draggable({cancel:".button, textarea, .nf-checkbox",containment:"parent"});var T=z('<div class="string-check-container">');T.appendTo(S);R=z('<div class="nf-checkbox string-check"/>').appendTo(T);z('<span class="string-check-label nf-checkbox-label">&nbsp;Set empty string</span>').appendTo(T);var V=z('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",Q.save);var W=z('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){z(this).css("background","#C7D2D7")},function(){z(this).css("background","#E3E8EB")}).on("click",Q.cancel);z("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px",clear:"both","float":"right"}).append(V).append(W).append('<div class="clear"></div>').appendTo(S);Q.position(P.position);O.focus().select()};this.handleKeyDown=function(T){if(T.which===z.ui.keyCode.ENTER&&!T.shiftKey){Q.save()}else{if(T.which===z.ui.keyCode.ESCAPE){Q.cancel();T.stopImmediatePropagation();T.preventDefault()}}};this.save=function(){P.commitChanges()};this.cancel=function(){O.val(M);P.cancelChanges()};this.hide=function(){S.hide()};this.show=function(){S.show()};this.position=function(T){S.css({top:T.top-27,left:T.left-20})};this.destroy=function(){S.remove()};this.focus=function(){O.focus()};this.loadValue=function(U){var V=false;if(G.isDefinedAndNotNull(U[P.column.field])){M=U[P.column.field];V=M===""}var T=V?"checkbox-checked":"checkbox-unchecked";R.addClass(T);O.val(M);O.select()};this.serializeValue=function(){if(O.val()===""){if(R.hasClass("checkbox-checked")){return""}else{return null}}else{return O.val()}};this.applyValue=function(T,U){T[P.column.field]=U};this.isValueChanged=function(){return Q.serializeValue()!==N};this.validate=function(){return{valid:true,msg:null}};this.init()};var k=function(O,S,U,T){var P=z(S.getCellNode(U,T));var Q=P.offset();var M=z('<div class="property-detail"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:Q.top-26,left:Q.left-20}).draggable({containment:"parent"}).appendTo("body");z('<textarea hidefocus rows="5" readonly="readonly"/>').css({height:"80px",resize:"both",width:P.width()+"px",margin:"10px 0px","white-space":"pre"}).text(O.value).on("keydown",function(V){if(V.which===z.ui.keyCode.ESCAPE){N();V.stopImmediatePropagation();V.preventDefault()}}).appendTo(M);var N=function(){M.hide().remove()};var R=z('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",function(){N()});z("<div></div>").append(R).append('<div class="clear"></div>').appendTo(M)};var y={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:true,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24};var m=function(M){var P=J.getSelection();if(P.empty()===false){var Q=P.datum();if(Q.id===M){if(Q.permissions.canRead){return G.escapeHtml(Q.component.name)}else{return G.escapeHtml(Q.id)}}}var N=n.injector.get("breadcrumbsCtrl").getBreadcrumbs();var O=M;z.each(N,function(R,S){if(S.id===M){O=S.label;return false}});return O};var a=function(){var O=z("#variable-registry-table");var Q=function(Y,V,X,W,U){return G.escapeHtml(X)};var N=function(Y,V,X,W,U){if(U.isOverridden){return'<div class="overridden" title="This value has been overridden by another variable in a descendant Process Group">'+G.escapeHtml(X)+"</div>"}else{if(X===""){return'<span class="table-cell blank">Empty string set</span>'}else{if(X===null){return'<span class="unset">No value set</span>'}else{return G.escapeHtml(X)}}}};var T=function(Y,V,X,W,U){if(G.isDefinedAndNotNull(X)){return G.escapeHtml(m(X))}else{return"Controller"}};var P=function(aa,V,Z,Y,U){var X="";if(U.isEditable===true){X+='<div title="Delete" class="delete-variable pointer fa fa-trash" style="margin-top: 2px;" ></div>'}else{var W=z("#variable-registry-process-group-id").text();if(U.processGroupId!==W){X+='<div title="Go To" class="go-to-variable pointer fa fa-long-arrow-right" style="margin-top: 2px;" ></div>'}}return X};var R=[{id:"scope",name:"Scope",field:"processGroupId",formatter:T,sortable:true,resizable:true},{id:"name",name:"Name",field:"name",formatter:Q,sortable:true,resizable:true},{id:"value",name:"Value",field:"value",formatter:N,sortable:true,resizable:true,cssClass:"pointer"},{id:"actions",name:"&nbsp;",resizable:false,formatter:P,sortable:false,width:45,maxWidth:45}];var M=new b.Data.DataView({inlineFilters:false});M.setFilterArgs({searchString:"",property:"hidden"});M.setFilter(function(V,U){return V.hidden===false});M.getItemMetadata=function(U){return{columns:{value:{editor:i}}}};L({columnId:"name",sortAsc:true},M);var S=new b.Grid(O,M,R,y);S.setSelectionModel(new b.RowSelectionModel());S.registerPlugin(new b.AutoTooltips());S.setSortColumn("name",true);S.onSort.subscribe(function(V,U){L({columnId:U.sortCol.id,sortAsc:U.sortAsc},M)});S.onClick.subscribe(function(Y,V){var U=M.getItem(V.row);if(S.getColumns()[V.cell].id==="value"){if(U.isEditable===true){S.gotoCell(V.row,V.cell,true)}else{S.setSelectedRows([V.row]);k(U,S,V.row,V.cell)}Y.stopImmediatePropagation()}else{if(S.getColumns()[V.cell].id==="actions"){var X=z(Y.target);if(X.hasClass("delete-variable")){M.updateItem(U.id,z.extend(U,{hidden:true}));var Z=M.getItems();z.each(Z,function(aa,ab){if(ab.isOverridden===true&&!f(Z,ab)){M.updateItem(ab.id,z.extend(ab,{isOverridden:false}))}});var W=S.getSelectedRows();if(W.length===0){S.setSelectedRows([0])}Y.stopImmediatePropagation()}else{if(X.hasClass("go-to-variable")){v().done(function(){var aa=n.injector.get("breadcrumbsCtrl").getBreadcrumbs();z.each(aa,function(ab,ac){if(ac.id===U.processGroupId){if(G.isDefinedAndNotNull(ac.parentBreadcrumb)){J.showComponent(ac.parentBreadcrumb.id,ac.id).done(function(){setTimeout(function(){w(U.processGroupId,U.name)},500)})}else{J.getComponentByType("ProcessGroup").enterGroup(ac.id).done(function(){setTimeout(function(){w(U.processGroupId,U.name)},500)})}return false}})})}}}}});S.onSelectedRowsChanged.subscribe(function(W,V){if(z.isArray(V.rows)&&V.rows.length===1){if(S.getDataLength()>0){var X=V.rows[0];var U=S.getDataItem(X);if(C===null||C!==U.id){z("#affected-components-context").removeClass("unset").text(U.name);D(U.affectedComponents);C=U.id}}}});M.onRowCountChanged.subscribe(function(V,U){S.updateRowCount();S.render()});M.onRowsChanged.subscribe(function(V,U){S.invalidateRows(U.rows);S.render()});M.syncGridSelection(S,true);O.data("gridInstance",S)};var v=function(){var N=z("#variable-registry-table").data("gridInstance");if(G.isDefinedAndNotNull(N)){var M=N.getEditController();M.commitCurrentEdit()}return z.Deferred(function(O){if(z("#variable-update-status").is(":visible")){E();O.resolve()}else{var P=p();if(z.isEmptyObject(P)){E();O.resolve()}else{h.showYesNoDialog({headerText:"Variables",dialogContent:"Save changes before leaving variable configuration?",noHandler:function(){E();O.resolve()},yesHandler:function(){K().done(function(){O.resolve()}).fail(function(){O.reject()})}})}}}).promise()};var L=function(M,O){var N=function(R,P){if(M.columnId==="scope"){var U=G.isDefinedAndNotNull(R.processGroupId)?m(R.processGroupId):"";var T=G.isDefinedAndNotNull(P.processGroupId)?m(P.processGroupId):"";return U===T?0:U>T?1:-1}else{var Q=G.isDefinedAndNotNull(R[M.columnId])?R[M.columnId]:"";var S=G.isDefinedAndNotNull(P[M.columnId])?P[M.columnId]:"";return Q===S?0:Q>S?1:-1}};O.sort(N,M.sortAsc)};var I=function(N,M){return N.component.name.localeCompare(M.component.name)};var o=function(N,M){var P=z('<li class="affected-component-container"></li>').appendTo(M);var O=N.component;z('<div class="referencing-component-state"></div>').addClass(function(){if(G.isDefinedAndNotNull(O.state)){var Q=z(this);var S=O.state.toLowerCase();if(S==="stopped"&&!G.isEmpty(O.validationErrors)){S="invalid";var R=G.formatUnorderedList(O.validationErrors);Q.qtip(z.extend({},J.config.systemTooltipConfig,{content:R}))}return S}else{return""}}).appendTo(P);z('<span class="referencing-component-name link"></span>').text(O.name).on("click",function(){v().done(function(){J.showComponent(O.processGroupId,O.id)})}).appendTo(P);z('<div class="referencing-component-bulletins"></div>').addClass(O.id+"-affected-bulletins").appendTo(P);z('<span class="referencing-component-active-thread-count"></span>').text(function(){if(G.isDefinedAndNotNull(O.activeThreadCount)&&O.activeThreadCount>0){return"("+O.activeThreadCount+")"}else{return""}}).appendTo(P)};var d=function(O,N){var P=z('<li class="affected-component-container"></li>').appendTo(N);var M=O.component;z('<div class="referencing-component-state"></div>').addClass(function(){if(G.isDefinedAndNotNull(M.state)){var Q=z(this);var S=M.state==="ENABLED"?"enabled":"disabled";if(S==="disabled"&&!G.isEmpty(M.validationErrors)){S="invalid";var R=G.formatUnorderedList(M.validationErrors);Q.qtip(z.extend({},J.config.systemTooltipConfig,{content:R}))}return S}else{return""}}).appendTo(P);z('<div class="referencing-component-bulletins"></div>').addClass(M.id+"-affected-bulletins").appendTo(P);z('<span class="referencing-component-name link"></span>').text(M.name).on("click",function(){v().done(function(){A.showConfiguration(M.processGroupId).done(function(){A.selectControllerService(M.id)})})}).appendTo(P)};var D=function(Q){var N=[];var O=[];var M=[];var T=z("#variable-registry-affected-processors");G.cleanUpTooltips(T,"div.referencing-component-state");G.cleanUpTooltips(T,"div.referencing-component-bulletins");T.empty();var S=z("#variable-registry-affected-controller-services");G.cleanUpTooltips(S,"div.referencing-component-state");G.cleanUpTooltips(S,"div.referencing-component-bulletins");S.empty();var P=z("#variable-registry-affected-unauthorized-components").empty();if(G.isUndefined(Q)){z('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(T);z('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(S);z('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(P)}else{var R=[];z.each(Q,function(U,V){if(V.permissions.canRead===true&&V.permissions.canWrite===true){R.push(V.id);if(V.component.referenceType==="PROCESSOR"){N.push(V)}else{O.push(V)}}else{if(V.permissions.canRead===true){R.push(V.id)}M.push(V)}});if(N.length===0){z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(T)}else{N.sort(I);z.each(N,function(U,V){o(V,T)})}if(O.length===0){z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(S)}else{O.sort(I);z.each(O,function(U,V){d(V,S)})}if(M.length===0){z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(P)}else{M.sort(function(V,U){if(V.permissions.canRead===true&&U.permissions.canRead===true){var W=V.component.referenceType===U.component.referenceType?0:V.component.referenceType>U.component.referenceType?-1:1;if(W===0){W=V.component.name===U.component.name?0:V.component.name>U.component.name?1:-1}return W}else{if(V.permissions.canRead===false&&U.permissions.canRead===false){return V.id>U.id?1:-1}else{if(V.permissions.canRead===true){return -1}else{return 1}}}});z.each(M,function(W,U){if(U.permissions.canRead===true){if(U.component.referenceType==="PROCESSOR"){o(U,P)}else{d(U,P)}}else{var V=z('<li class="affected-component-container"></li>').appendTo(P);z('<span class="unset"></span>').text(U.id).appendTo(V)}})}if(R.length>0){J.queryBulletins(R).done(function(V){var W=V.bulletinBoard.bulletins;var U=H.nest().key(function(X){return X.sourceId}).map(W,H.map);U.forEach(function(Y,X){z("div."+Y+"-affected-bulletins").each(function(){var aa=z(this);if(X.length>0){var Z=G.getFormattedBulletins(X);var ab=G.formatUnorderedList(Z);aa.addClass("has-bulletins").show().qtip(z.extend({},J.config.systemTooltipConfig,{content:ab}))}})})})}}};var w=function(M,N){return z.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(M)+"/variable-registry",dataType:"json"}).done(function(O){z("#process-group-variable-registry").text(m(M));z("#variable-registry-process-group-id").text(M).data("revision",O.processGroupRevision);l(O.variableRegistry,N);z("#variable-registry-dialog").modal("show")}).fail(e.handleAjaxError)};var f=function(S,R){var Q=[];z.each(S,function(U,T){if(R.name===T.name&&T.hidden===false){Q.push(T)}});var P=false;if(Q.length>1){var O=[];var N=n.injector.get("breadcrumbsCtrl").getBreadcrumbs();z.each(N,function(T,U){O.push(U.id)});var M=z("#variable-registry-process-group-id").text();if(O.indexOf(M)===-1){O.push(M)}z.each(O,function(U,T){for(var V=0;V<Q.length;V++){if(T===Q[V].processGroupId){if(R===Q[V]){P=true}Q.splice(V,1);if(Q.length===1){return false}}}})}return P};var c=function(O){if(O.canWrite===true){var N=z("#variable-registry-process-group-id").text();if(O.processGroupId===N){var P=J.getSelection();if(P.empty()===false&&nf.CanvasUtils.isProcessGroup(P)){var R=P.datum();if(R.id===N){return R.permissions.canWrite===true}}var Q=false;var M=n.injector.get("breadcrumbsCtrl").getBreadcrumbs();z.each(M,function(S,T){if(T.id===N){Q=T.permissions.canWrite===true;return false}});return Q}}return false};var l=function(P,S){if(G.isDefinedAndNotNull(P)){var Q=0;var R=0;var T=z("#variable-registry-table").data("gridInstance");var N=T.getData();N.beginUpdate();var U=[];z.each(P.variables,function(Y,W){var X=W.variable;U.push({id:Q++,hidden:false,canWrite:W.canWrite,name:X.name,value:X.value,previousValue:X.value,processGroupId:X.processGroupId,affectedComponents:X.affectedComponents})});z.each(U,function(X,W){N.addItem(z.extend({isOverridden:f(U,W),isEditable:c(W)},W))});N.endUpdate();N.reSort();if(G.isDefinedAndNotNull(S)){z.each(U,function(X,W){if(P.processGroupId===W.processGroupId&&W.name===S){R=N.getRowById(W.id)}})}if(U.length===0){var M=z("#variable-registry-affected-processors");G.cleanUpTooltips(M,"div.referencing-component-state");G.cleanUpTooltips(M,"div.referencing-component-bulletins");M.empty();var V=z("#variable-registry-affected-controller-services");G.cleanUpTooltips(V,"div.referencing-component-state");G.cleanUpTooltips(V,"div.referencing-component-bulletins");V.empty();var O=z("#variable-registry-affected-unauthorized-components").empty();z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(M);z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(V);z('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(O);z("#affected-components-context").addClass("unset").text("None")}else{T.setSelectedRows([R])}}};var q=function(P,O,N){var M=z("#variable-update-steps").empty();z.each(P,function(S,R){var Q=z("<li></li>").text(R.description).appendTo(M);z('<div class="variable-step"></div>').addClass(function(){if(G.isDefinedAndNotNull(R.failureReason)){return"ajax-error"}else{if(R.complete===true){return"ajax-complete"}else{return O===true||N===true?"ajax-error":"ajax-loading"}}}).appendTo(Q);z('<div class="clear"></div>').appendTo(Q)})};var K=function(){var O=p();if(O.length===0){E();return}var N=O.map(function(P){return P.variable.name});z("#affected-components-context").removeClass("unset").text(N.join(", "));var M=z("#variable-registry-process-group-id").text();return z.Deferred(function(P){var S=function(){z("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){P.resolve();E()}}}])};var Q=false;z("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){Q=true;S()}}}]);var T;var R=function(W,U,V){if(G.isDefinedAndNotNull(T)){F(M,T)}z("#variable-update-steps").find("div.variable-step.ajax-loading").removeClass("ajax-loading").addClass("ajax-error");S()};t(M,O).done(function(U){var V=function(Y){var X=Y.request;var W=G.isDefinedAndNotNull(X.failureReason);T=X.requestId;D(X.affectedComponents);q(X.updateSteps,Q,W);if(Q){F(X.processGroupId,T)}else{if(X.complete===true){if(W){h.showOkDialog({headerText:"Variable Update Error",dialogContent:"Unable to complete variable update request: "+G.escapeHtml(X.failureReason)})}z.each(X.affectedComponents,function(Z,ab){if(ab.permissions.canRead===true){var aa=ab.component;if(aa.referenceType==="PROCESSOR"&&J.getGroupId()===aa.processGroupId){s.reload(aa.id)}}});if(J.getGroupId()!==X.processGroupId){x.reload(X.processGroupId)}F(X.processGroupId,T);S()}else{setTimeout(function(){r(X.processGroupId,T).done(function(Z){V(Z)}).fail(R)},2000)}}};z("#variable-registry-table, #add-variable").hide();z("#variable-update-status").show();V(U)}).fail(R)}).promise()};var t=function(M,P){var O=z("#variable-registry-process-group-id").data("revision");var N={processGroupRevision:g.getRevision({revision:{version:O.version}}),variableRegistry:{processGroupId:M,variables:P}};return z.ajax({type:"POST",data:JSON.stringify(N),url:"../nifi-api/process-groups/"+encodeURIComponent(M)+"/variable-registry/update-requests",dataType:"json",contentType:"application/json"}).fail(e.handleAjaxError)};var r=function(M,N){return z.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(M)+"/variable-registry/update-requests/"+encodeURIComponent(N),dataType:"json"}).fail(e.handleAjaxError)};var F=function(M,N){return z.ajax({type:"DELETE",url:"../nifi-api/process-groups/"+encodeURIComponent(M)+"/variable-registry/update-requests/"+encodeURIComponent(N),dataType:"json"}).fail(e.handleAjaxError)};var p=function(){var O=[];var N=z("#variable-registry-table").data("gridInstance");var M=N.getData();z.each(M.getItems(),function(){var Q={name:this.name};var P=false;if(this.hidden===true&&this.previousValue!==null){Q.value=null;P=true}else{if(this.value!==this.previousValue){Q.value=this.value;P=true}}if(P){O.push({variable:Q})}});return O};var B=function(){var U=z("#variable-registry-process-group-id").text();var S=z.trim(z("#new-variable-name").val());if(S!==""){var R=z("#variable-registry-table").data("gridInstance");var O=R.getData();var P=[];var V=null;z.each(O.getItems(),function(W,X){if(S===X.name){if(U===X.processGroupId){V=X}else{P.push(X)}}});if(V===null){var N=O.getLength();O.addItem({id:N,hidden:false,canWrite:true,name:S,value:null,previousValue:null,processGroupId:U,isEditable:true,isOverridden:false});z.each(P,function(W,X){O.updateItem(X.id,z.extend(X,{isOverridden:true}))});O.reSort();var T=O.getRowById(N);R.setActiveCell(T,R.getColumnIndex("value"));R.editActiveCell()}else{if(V.hidden===true){O.updateItem(V.id,z.extend(V,{hidden:false,value:null}));var Q=O.getRowById(V.id);R.setActiveCell(Q,R.getColumnIndex("value"));R.editActiveCell()}else{h.showOkDialog({headerText:"Variable Exists",dialogContent:"A variable with this name already exists."});var M=O.getRowById(V.id);R.setSelectedRows([M]);R.scrollRowIntoView(M)}}}else{h.showOkDialog({headerText:"Variable Name",dialogContent:"Variable name must be specified."})}z("#new-variable-dialog").modal("hide")};var E=function(){z("#variable-registry-dialog").modal("hide")};var j=function(){z("#variable-registry-table, #add-variable").show();z("#variable-update-status").hide();z("#process-group-variable-registry").text("");z("#variable-registry-process-group-id").text("").removeData("revision");z("#affected-components-context").removeClass("unset").text("");var P=z("#variable-registry-table").data("gridInstance");var M=P.getData();M.setItems([]);var O=z("#variable-registry-affected-processors");G.cleanUpTooltips(O,"div.referencing-component-state");G.cleanUpTooltips(O,"div.referencing-component-bulletins");O.empty();var N=z("#variable-registry-affected-controller-services");G.cleanUpTooltips(N,"div.referencing-component-state");G.cleanUpTooltips(N,"div.referencing-component-bulletins");N.empty();z("#variable-registry-affected-unauthorized-components").empty();C=null};return{init:function(){z("#variable-registry-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Variables",handler:{close:function(){j()},open:function(){var M=z("#variable-registry-table").data("gridInstance");if(G.isDefinedAndNotNull(M)){M.resizeCanvas()}}}});z("#new-variable-dialog").modal({headerText:"New Variable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){B()}}}],handler:{close:function(){z("#new-variable-name").val("")},open:function(){z("#new-variable-name").focus()}}});z("#new-variable-name").on("keydown",function(N){var M=N.keyCode?N.keyCode:N.which;if(M===z.ui.keyCode.ENTER){B();N.stopImmediatePropagation();N.preventDefault()}});z("#add-variable").on("click",function(){z("#new-variable-dialog").modal("show")});a()},showVariables:function(M){z("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){K()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){E()}}}]);return w(M)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ProcessGroupConfiguration","nf.ng.Bridge"],function(g,j,i,h,e,f,d,c){return(nf.ComponentState=b(g,i,h,e,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common",require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration"),require("nf.ng.Bridge"))))}else{nf.ComponentVersion=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration,a.nf.ng.Bridge)}}}(this,function(h,j,e,m,f,c,i){var a;var d;var b=function(n){if(n.type==="ReportingTask"){return"../nifi-api/flow/reporting-task-types"}else{if(n.type==="ControllerService"){return"../nifi-api/flow/controller-service-types"}else{return"../nifi-api/flow/processor-types"}}};var g=function(n){if(n.type==="ReportingTask"){return"reportingTaskTypes"}else{if(n.type==="ControllerService"){return"controllerServiceTypes"}else{return"processorTypes"}}};var l=function(){var n=a.keys();h.each(n,function(p,o){a.remove(o)});h("#component-version-controller-service-apis").empty();h("#component-version-controller-service-apis-container").hide();h("#component-version-name").text("");h("#component-version-bundle").text("");h("#component-version-tags").text("");h("#component-version-restriction").removeClass("unset").text("");h("#component-version-description").text("");h("#component-version-selector").combo("destroy");h("#component-version-dialog").removeData("component")};var k=function(p){var q=a.get(p.value);if(e.isDefinedAndNotNull(q.usageRestriction)){h("#component-version-restriction").text(q.usageRestriction)}else{h("#component-version-restriction").addClass("unset").text("No restriction")}if(!e.isEmpty(q.controllerServiceApis)){var n=e.getFormattedServiceApis(q.controllerServiceApis);var o=e.formatUnorderedList(n);h("#component-version-controller-service-apis").empty().append(o);h("#component-version-controller-service-apis-container").show()}h("#component-version-tags").text(q.tags.join(", "));h("#component-version-description").text(q.description)};return{init:function(n){a=d3.map();d=n;h("#component-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component Version",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var q=h("#component-version-selector").combo("getSelectedOption");var r=a.get(q.value);var p=h("#component-version-dialog").data("component");var o={revision:m.getRevision(p),component:{id:p.id,bundle:{group:r.bundle.group,artifact:r.bundle.artifact,version:r.bundle.version}}};h.ajax({type:"PUT",url:p.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){if(p.type==="Processor"){f.getComponentByType(p.type).set(t);i.digest()}else{if(p.type==="ControllerService"){var s=p.component.parentGroupId;h.Deferred(function(u){if(e.isDefinedAndNotNull(s)){if(h("#process-group-configuration").is(":visible")){c.loadConfiguration(s).done(function(){u.resolve()})}else{c.showConfiguration(s).done(function(){u.resolve()})}}else{if(h("#settings").is(":visible")){d.loadSettings().done(function(){u.resolve()})}else{d.showSettings().done(function(){u.resolve()})}}}).done(function(){if(e.isDefinedAndNotNull(s)){c.selectControllerService(p.id)}else{d.selectControllerService(p.id)}})}else{if(p.type==="ReportingTask"){h.Deferred(function(u){if(h("#settings").is(":visible")){d.loadSettings().done(function(){u.resolve()})}else{d.showSettings().done(function(){u.resolve()})}}).done(function(){d.selectReportingTask(p.id)})}}}}).fail(j.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){l()}}})},promptForVersionChange:function(n){var o={bundleGroupFilter:n.component.bundle.group,bundleArtifactFilter:n.component.bundle.artifact};if(g(n)==="controllerServiceTypes"){o.typeFilter=n.component.type}else{o.type=n.component.type}return h.ajax({type:"GET",url:b(n)+"?"+h.param(o),dataType:"json"}).done(function(p){var q=[];var r;h.each(p[g(n)],function(s,v){var u=v.type;a.set(v.bundle.version,v);var t={text:v.bundle.version,value:v.bundle.version,description:e.escapeHtml(v.description)};if(v.bundle.version===n.component.bundle.version){r=t}q.push(t)});q.sort(function(t,s){return -e.sortVersion(t.text,s.text)});h("#component-version-name").text(n.component.name);h("#component-version-bundle").text(e.formatBundle(n.component.bundle));h("#component-version-selector").combo({options:q,selectedOption:r,select:k});h("#component-version-dialog").data("component",n).modal("show")}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,j,i,d,f,k,e,h,c){return(nf.RemoteProcessGroupConfiguration=b(g,j,i,d,f,k,e,h,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(e,h,g,b,d,i,c,f,a){return{init:function(){e("#remote-process-group-configuration").modal({headerText:"Configure Remote Process Group",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var j=e("#remote-process-group-id").text();var k=h.select("#id-"+j).datum();var l={revision:i.getRevision(k),component:{id:j,targetUris:e("#remote-process-group-urls").val(),communicationsTimeout:e("#remote-process-group-timeout").val(),yieldDuration:e("#remote-process-group-yield-duration").val(),transportProtocol:e("#remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,proxyHost:e("#remote-process-group-proxy-host").val(),proxyPort:e("#remote-process-group-proxy-port").val(),proxyUser:e("#remote-process-group-proxy-user").val(),proxyPassword:e("#remote-process-group-proxy-password").val(),localNetworkInterface:e("#remote-process-group-local-network-interface").val()}};e.ajax({type:"PUT",data:JSON.stringify(l),url:k.uri,dataType:"json",contentType:"application/json"}).done(function(m){a.set(m);f.digest();e("#remote-process-group-configuration").modal("hide")}).fail(function(p,m,n){if(p.status===400){var q=p.responseText.split("\n");var o;if(q.length===1){o=e("<span></span>").text(q[0])}else{o=b.formatUnorderedList(q)}d.showOkDialog({dialogContent:o,headerText:"Remote Process Group Configuration"})}else{g.handleAjaxError(p,m,n)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#remote-process-group-configuration").modal("hide")}}}],handler:{close:function(){e("#remote-process-group-id").text("");e("#remote-process-group-name").text("");e("#remote-process-group-urls").val("");e("#remote-process-group-timeout").val("");e("#remote-process-group-yield-duration").val("");e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#remote-process-group-local-network-interface").val("");e("#remote-process-group-proxy-host").val("");e("#remote-process-group-proxy-port").val("");e("#remote-process-group-proxy-user").val("");e("#remote-process-group-proxy-password").val("")}}});e("#remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},showConfiguration:function(j){if(c.isRemoteProcessGroup(j)){var k=j.datum();e("#remote-process-group-id").text(k.id);e("#remote-process-group-name").text(k.component.name);e("#remote-process-group-urls").val(k.component.targetUris);e("#remote-process-group-timeout").val(k.component.communicationsTimeout);e("#remote-process-group-yield-duration").val(k.component.yieldDuration);e("#remote-process-group-proxy-host").val(k.component.proxyHost);e("#remote-process-group-proxy-port").val(k.component.proxyPort);e("#remote-process-group-proxy-user").val(k.component.proxyUser);e("#remote-process-group-proxy-password").val(k.component.proxyPassword);e("#remote-process-group-local-network-interface").val(k.component.localNetworkInterface);e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:k.component.transportProtocol});e("#remote-process-group-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.RemoteProcessGroupDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroupDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#remote-process-group-details").modal({headerText:"Remote Process Group Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#remote-process-group-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-remote-process-group-id");c.clearField("read-only-remote-process-group-name");c.clearField("read-only-remote-process-group-urls");c.clearField("read-only-remote-process-group-timeout");c.clearField("read-only-remote-process-group-yield-duration");c.clearField("read-only-remote-process-group-transport-protocol");c.clearField("read-only-remote-process-group-local-network-interface");c.clearField("read-only-remote-process-group-proxy-host");c.clearField("read-only-remote-process-group-proxy-port");c.clearField("read-only-remote-process-group-proxy-user");c.clearField("read-only-remote-process-group-proxy-password")}}})},showDetails:function(d){if(a.isRemoteProcessGroup(d)){var e=d.datum();c.populateField("read-only-remote-process-group-id",e.id);c.populateField("read-only-remote-process-group-name",e.component.name);c.populateField("read-only-remote-process-group-urls",e.component.targetUris);c.populateField("read-only-remote-process-group-timeout",e.component.communicationsTimeout);c.populateField("read-only-remote-process-group-yield-duration",e.component.yieldDuration);c.populateField("read-only-remote-process-group-transport-protocol",e.component.transportProtocol);c.populateField("read-only-remote-process-group-local-network-interface",e.component.localNetworkInterface);c.populateField("read-only-remote-process-group-proxy-host",e.component.proxyHost);c.populateField("read-only-remote-process-group-proxy-port",e.component.proxyPort);c.populateField("read-only-remote-process-group-proxy-user",e.component.proxyUser);c.populateField("read-only-remote-process-group-proxy-password",e.component.proxyPassword);b("#remote-process-group-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,j,i,d,f,k,e,h,c){return(nf.RemoteProcessGroupPorts=b(g,j,i,d,f,k,e,h,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupPorts=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupPorts=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(g,m,k,c,e,n,d,i,b){var h=function(){g("#remote-port-configuration").modal({headerText:"Configure Remote Port",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var q=g("#remote-port-concurrent-tasks").val();var p=g("#remote-port-batch-count").val();var v=new Array();if(!g.isNumeric(q)){v.push("Concurrent tasks must be an integer value.")}if(p&&!g.isNumeric(p)){v.push("Batch Settings: count must be an integer value.")}if(v.length==0){var o=g("#remote-process-group-ports-id").text();var u=m.select("#id-"+o).datum();var t=g("#remote-port-id").text();var s={revision:n.getRevision(u),remoteProcessGroupPort:{id:t,groupId:o,useCompression:g("#remote-port-use-compression").hasClass("checkbox-checked"),concurrentlySchedulableTaskCount:q,batchSettings:{count:p,size:g("#remote-port-batch-size").val(),duration:g("#remote-port-batch-duration").val()}}};var r="/output-ports/";if(g("#remote-port-type").text()==="input"){r="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(s),url:u.uri+r+encodeURIComponent(t),dataType:"json",contentType:"application/json"}).done(function(w){u.revision=w.revision;var x=w.remoteProcessGroupPort;var z="No";if(x.useCompression===true){z="Yes"}g("#"+t+"-concurrent-tasks").text(x.concurrentlySchedulableTaskCount);g("#"+t+"-compression").text(z);var y=a(x);g("#"+t+"-batch-count").text(y.count);g("#"+t+"-batch-size").text(y.size);g("#"+t+"-batch-duration").text(y.duration)}).fail(function(z,w,x){if(z.status===400){var A=z.responseText.split("\n");var y;if(A.length===1){y=g("<span></span>").text(A[0])}else{y=c.formatUnorderedList(A)}e.showOkDialog({dialogContent:y,headerText:"Remote Process Group Ports"})}else{k.handleAjaxError(z,w,x)}}).always(function(){g("#remote-port-configuration").modal("hide")})}else{e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:v.reduce(function(w,x){return typeof(w)==="string"?w+" "+x:x})});g("#remote-port-configuration").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#remote-port-configuration").modal("hide")}}}],handler:{close:function(){g("#remote-port-id").text("");g("#remote-port-name").text("");g("#remote-port-concurrent-tasks").val("");g("#remote-port-use-compression").removeClass("checkbox-checked checkbox-unchecked");g("#remote-port-batch-count").val("");g("#remote-port-batch-size").val("");g("#remote-port-batch-duration").val("")}}})};var j=function(){g("#remote-process-group-ports").modal({scrollableContentStyle:"scrollable",headerText:"Remote Process Group Ports",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=g("#remote-process-group-ports-id").text();var q=m.select("#id-"+o);var p=q.datum();if(d.canModify(q)){b.reload(p.id)}g("#remote-process-group-ports").modal("hide")}}}],handler:{close:function(){g("#remote-process-group-ports-id").text("");g("#remote-process-group-ports-name").text("");g("#remote-process-group-ports-urls").text("");var o=g("#remote-process-group-ports");c.cleanUpTooltips(o,"div.remote-port-removed");c.cleanUpTooltips(o,"div.concurrent-tasks-info");g("#remote-process-group-input-ports-container").empty();g("#remote-process-group-output-ports-container").empty()}}})};var a=function(p){var o={};var q=p.batchSettings;if(q){o.count=typeof(q.count)==="number"?q.count:"No value set";o.size=q.size?q.size:"No value set";o.duration=q.duration?q.duration:"No value set"}else{o.count="No value set";o.size="No value set";o.duration="No value set"}return o};var f=function(C,A,v){var s=c.escapeHtml(A.id);var w=g('<div class="remote-port-container"></div>').appendTo(C);var H=g('<div class="remote-port-edit-container"></div>').appendTo(w);var t=g('<div class="remote-port-details-container"></div>').appendTo(w);var y=g("#remote-process-group-ports-id").text();var u=m.select("#id-"+y);if(d.canModify(u)){var I=function(K){var L;if(K.connected===true){if(K.transmitting===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope));L.click()}else{if(K.exists===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}else{L=(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}}}else{if(K.transmitting===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}else{L=(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}}return L};var B=I(A);B.appendTo(H);if(A.exists===true&&A.connected===true){var G=g('<button class="button edit-remote-port fa fa-pencil"></button>').click(function(){var O=g("#"+s+"-name").text();var N=g("#"+s+"-concurrent-tasks").text();var K=g("#"+s+"-compression").text()==="Yes";var M=g("#"+s+"-batch-count").text();var L=g("#"+s+"-batch-size").text();var P=g("#"+s+"-batch-duration").text();l(A.id,O,N,K,M,L,P,v)}).appendTo(H);if(A.transmitting===true){G.hide()}else{G.show()}}else{if(A.exists===false){g('<div class="remote-port-removed"/>').appendTo(H).qtip(g.extend({},c.config.tooltipConfig,{content:"This port has been removed."}))}}if(c.isDefinedAndNotNull(B)){var J=function(){var K=g("#remote-process-group-ports-id").text();var N=m.select("#id-"+K).datum();var O=false;if(B.hasClass("enabled-inactive-transmission")){O=true}var M={revision:n.getRevision(N),remoteProcessGroupPort:{id:A.id,groupId:K,transmitting:O}};var L="/output-ports/";if(v==="input"){L="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(M),url:N.uri+L+encodeURIComponent(A.id),dataType:"json",contentType:"application/json"}).done(function(P){N.revision=P.revision;var Q=P.remoteProcessGroupPort;if(Q.exists===false){B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("disabled-inactive-transmission").off("click");if(c.isDefinedAndNotNull(G)){G.hide()}}else{if(Q.transmitting===true){B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-active-transmission");if(c.isDefinedAndNotNull(G)){G.hide()}}else{B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-inactive-transmission");if(c.isDefinedAndNotNull(G)){G.show()}}}}).fail(function(T,P,Q){var S=I(A);S.click(J);B.replaceWith(S);B=S;if(T.status===400){var U=T.responseText.split("\n");var R;if(U.length===1){R=g("<span></span>").text(U[0])}else{R=c.formatUnorderedList(U)}e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:R})}else{k.handleAjaxError(T,P,Q)}})};B.click(J)}}else{if(A.transmitting===true){(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope)).appendTo(H)}else{(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope)).appendTo(H)}}g('<div id="'+s+'-id" class="remote-port-id hidden"></div>').text(A.id).appendTo(t);g('<div id="'+s+'-name" class="remote-port-name ellipsis"></div>').text(A.name).appendTo(t);g('<div class="clear"></div>').appendTo(t);if(c.isBlank(A.comments)){g('<div class="remote-port-description unset">No description specified.</div>').appendTo(t)}else{g('<div class="remote-port-description"></div>').text(A.comments).appendTo(t)}g('<div class="clear"></div>').appendTo(t);var D=g('<div class="concurrent-task-container"></div>').appendTo(t);var x=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-concurrent-tasks"></div>').text(A.concurrentlySchedulableTaskCount));g('<div><div class="setting-name">Concurrent tasks<div class="processor-setting concurrent-tasks-info fa fa-question-circle"></div></div></div>').append(x).appendTo(D).find("div.concurrent-tasks-info").qtip(g.extend({},c.config.tooltipConfig,{content:"The number of tasks that should be concurrently scheduled for this port."}));var p=g('<div class="compression-container"></div>').appendTo(t);var o="No";if(A.useCompression===true){o="Yes"}g('<div><div class="setting-name">Compressed</div><div class="setting-field"><div id="'+s+'-compression">'+o+"</div></div></div>").appendTo(p);g('<div class="clear"></div>').appendTo(t);var r=g('<div class="batch-settings-container"></div>').append(g('<div class="setting-name">Batch Settings<div class="processor-setting batch-settings-info fa fa-question-circle"></div></div>')).appendTo(t);r.find("div.batch-settings-info").qtip(g.extend({},nf.Common.config.tooltipConfig,{content:(v==="input"?"The batch settings to control how this NiFi sends data to the remote input port in a transaction. This NiFi will transfer as much flow files as they are queued in incoming relationships, until any of these limits is met. If none of these setting is specified, this NiFi uses 500 milliseconds batch duration by default.":"The batch settings to tell the remote NiFi how this NiFi prefers to receive data from the remote output port in a transaction. The remote NiFi will use these settings as a hint to control batch data transferring. However, actual behavior depends on the version of remote NiFi instance. Recent version of NiFi uses 5 seconds for batch duration if none of these setting is specified.")}));var F=a(A);var q=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-count"></div>').text(F.count));var E=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-size"></div>').text(F.size));var z=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-duration"></div>').text(F.duration));g('<div class="batch-setting"><div class="setting-name">Count<div class="processor-setting"></div></div></div>').append(q).appendTo(r);g('<div class="batch-setting"><div class="setting-name">Size<div class="processor-setting"></div></div></div>').append(E).appendTo(r);g('<div class="batch-setting"><div class="setting-name">Duration<div class="processor-setting"></div></div></div>').append(z).appendTo(r);g('<div class="clear"></div>').appendTo(w);w.find(".ellipsis").ellipsis();i.digest()};var l=function(r,s,u,v,p,t,q,o){g("#remote-port-id").text(r);g("#remote-port-type").text(o);var w="checkbox-unchecked";if(v===true){w="checkbox-checked"}g("#remote-port-use-compression").addClass(w);g("#remote-port-concurrent-tasks").val(u);g("#remote-port-batch-count").val(p==="No value set"?null:p);g("#remote-port-batch-size").val(t==="No value set"?null:t);g("#remote-port-batch-duration").val(q==="No value set"?null:q);g("#remote-port-name").text(s).ellipsis();g("#remote-port-configuration").modal("show")};return{init:function(){h();j()},showPorts:function(o){if(d.isRemoteProcessGroup(o)){var p=o.datum();g.ajax({type:"GET",url:p.uri,dataType:"json"}).done(function(s){var v=s.component;b.set(s);g("#remote-process-group-ports-id").text(v.id);g("#remote-process-group-ports-name").text(v.name);g("#remote-process-group-ports-urls").text(v.targetUris);var q=v.contents;if(c.isDefinedAndNotNull(q)){var z=[];var t=[];var r=function(B,A){var D=B.name.toUpperCase();var C=A.name.toUpperCase();return D<C?-1:(D>C?1:0)};var x=g("#remote-process-group-input-ports-container");g.each(q.inputPorts,function(B,A){if(A.connected===true){z.push(A)}else{t.push(A)}});z.sort(r);t.sort(r);g.each(z,function(B,A){f(x,A,"input")});g.each(t,function(B,A){f(x,A,"input")});if(c.isEmpty(z)&&c.isEmpty(t)){g('<div class="unset"></div>').text("No ports to display").appendTo(x)}var u=[];var y=[];var w=g("#remote-process-group-output-ports-container");g.each(q.outputPorts,function(A,B){if(B.connected===true){u.push(B)}else{y.push(B)}});u.sort(r);y.sort(r);g.each(u,function(A,B){f(w,B,"output")});g.each(y,function(A,B){f(w,B,"output")});if(c.isEmpty(u)&&c.isEmpty(y)){g('<div class="unset"></div>').text("No ports to display").appendTo(w)}}g("#remote-process-group-ports").modal("show")}).fail(k.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.Connection"],function(g,e,j,h,f,c,d,i){return(nf.ConnectionConfiguration=b(g,e,j,h,f,c,d,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Connection")))}else{nf.ConnectionConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.Connection)}}}(this,function(s,C,c,B,h,f,G,K){var d;var o;var l=75;var F=200;var x={urls:{api:"../nifi-api",prioritizers:"../nifi-api/flow/prioritizers"}};var g=function(){C.select("path.connector").remove()};var r=function(){s("div.available-relationship").bind("change",function(){s("#connection-configuration").modal("refreshButtons")})};var b=function(L){if(G.isProcessor(L)){return s.Deferred(function(M){A(L).done(function(O){if(!B.isEmpty(O.relationships)){s.each(O.relationships,function(P,Q){t(Q.name)});r();var N=s("#relationship-names").children("div");if(N.length===1){N.children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}s("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return q().length===0},handler:{click:function(){y(q());s("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){s("#connection-configuration").modal("hide")}}}]);M.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+B.escapeHtml(O.name)+"' does not support any relationships."});j();M.reject()}}).fail(function(){M.reject()})}).promise()}else{return s.Deferred(function(N){var M;if(G.isInputPort(L)){M=z(L)}else{if(G.isRemoteProcessGroup(L)){M=e(L)}else{if(G.isProcessGroup(L)){M=D(L)}else{M=k(L)}}}M.done(function(){s("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){y();s("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){s("#connection-configuration").modal("hide")}}}]);N.resolve()}).fail(function(){N.reject()})}).promise()}};var z=function(L){return s.Deferred(function(N){var M=L.datum();var O=M.permissions.canRead?M.component.name:M.id;s("#input-port-source").show();s("#input-port-source-name").text(O).attr("title",O);s("#connection-source-id").val(M.id);s("#connection-source-component-id").val(M.id);s("#connection-source-group-id").val(G.getGroupId());s("#connection-source-group-name").text(G.getGroupName());N.resolve()}).promise()};var k=function(L){return s.Deferred(function(N){var M=L.datum();s("#funnel-source").show();s("#connection-source-id").val(M.id);s("#connection-source-component-id").val(M.id);s("#connection-source-group-id").val(G.getGroupId());s("#connection-source-group-name").text(G.getGroupName());N.resolve()}).promise()};var A=function(L){return s.Deferred(function(N){var M=L.datum();var O=M.permissions.canRead?M.component.name:M.id;var P=M.permissions.canRead?B.substringAfterLast(M.component.type,"."):"Processor";s("#processor-source").show();s("#processor-source-name").text(O).attr("title",O);s("#processor-source-type").text(P).attr("title",P);s("#connection-source-id").val(M.id);s("#connection-source-component-id").val(M.id);s("#connection-source-group-id").val(G.getGroupId());s("#connection-source-group-name").text(G.getGroupName());s("#relationship-names-container").show();N.resolve(M.component)})};var D=function(L){return s.Deferred(function(M){var N=L.datum();s.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(N.id),dataType:"json"}).done(function(O){var S=O.processGroupFlow;var R=O.permissions.canRead?S.breadcrumb.breadcrumb.name:S.id;var T=S.flow;var P=[];s.each(T.outputPorts,function(V,W){if(W.permissions.canRead&&W.permissions.canWrite){var U=W.component;P.push({text:U.name,value:U.id,description:B.escapeHtml(U.comments)})}});if(!B.isEmpty(P)){s("#output-port-source").show();P.sort(function(V,U){return V.text.localeCompare(U.text)});s("#output-port-options").combo({options:P,maxHeight:300,select:function(U){s("#connection-source-id").val(U.value)}});s("#connection-source-component-id").val(S.id);s("#connection-source-group-id").val(S.id);s("#connection-source-group-name").text(R);M.resolve()}else{var Q="'"+B.escapeHtml(R)+"' does not have any output ports.";if(B.isEmpty(T.outputPorts)===false){Q="Not authorized for any output ports in '"+B.escapeHtml(R)+"'."}h.showOkDialog({headerText:"Connection Configuration",dialogContent:Q});j();M.reject()}}).fail(function(Q,O,P){c.handleAjaxError(Q,O,P);M.reject()})}).promise()};var e=function(L){return s.Deferred(function(M){var N=L.datum();s.ajax({type:"GET",url:N.uri,dataType:"json"}).done(function(O){var Q=O.component;var R=Q.contents;if(!B.isEmpty(R.outputPorts)){s("#output-port-source").show();var P=[];s.each(R.outputPorts,function(S,T){P.push({text:T.name,value:T.id,disabled:T.exists===false,description:B.escapeHtml(T.comments)})});P.sort(function(T,S){return T.text.localeCompare(S.text)});s("#output-port-options").combo({options:P,maxHeight:300,select:function(S){s("#connection-source-id").val(S.value)}});s("#connection-source-component-id").val(Q.id);s("#connection-source-group-id").val(Q.id);s("#connection-source-group-name").text(Q.name);M.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+B.escapeHtml(Q.name)+"' does not have any output ports."});j();M.reject()}}).fail(function(Q,O,P){c.handleAjaxError(Q,O,P);M.reject()})}).promise()};var a=function(L){if(G.isOutputPort(L)){return m(L)}else{if(G.isProcessor(L)){return w(L)}else{if(G.isRemoteProcessGroup(L)){return H(L)}else{if(G.isFunnel(L)){return p(L)}else{return J(L)}}}}};var m=function(L){return s.Deferred(function(M){var O=L.datum();var N=O.permissions.canRead?O.component.name:O.id;s("#output-port-destination").show();s("#output-port-destination-name").text(N).attr("title",N);s("#connection-destination-id").val(O.id);s("#connection-destination-component-id").val(O.id);s("#connection-destination-group-id").val(G.getGroupId());s("#connection-destination-group-name").text(G.getGroupName());M.resolve()}).promise()};var p=function(L){return s.Deferred(function(N){var M=L.datum();s("#funnel-destination").show();s("#connection-destination-id").val(M.id);s("#connection-destination-component-id").val(M.id);s("#connection-destination-group-id").val(G.getGroupId());s("#connection-destination-group-name").text(G.getGroupName());N.resolve()}).promise()};var w=function(L){return s.Deferred(function(N){var M=L.datum();var O=M.permissions.canRead?M.component.name:M.id;var P=M.permissions.canRead?B.substringAfterLast(M.component.type,"."):"Processor";s("#processor-destination").show();s("#processor-destination-name").text(O).attr("title",O);s("#processor-destination-type").text(P).attr("title",P);s("#connection-destination-id").val(M.id);s("#connection-destination-component-id").val(M.id);s("#connection-destination-group-id").val(G.getGroupId());s("#connection-destination-group-name").text(G.getGroupName());N.resolve()}).promise()};var J=function(L){return s.Deferred(function(M){var N=L.datum();s.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(N.id),dataType:"json"}).done(function(O){var R=O.processGroupFlow;var Q=O.permissions.canRead?R.breadcrumb.breadcrumb.name:R.id;var S=R.flow;var P=[];s.each(S.inputPorts,function(U,T){P.push({text:T.permissions.canRead?T.component.name:T.id,value:T.id,description:T.permissions.canRead?B.escapeHtml(T.component.comments):null})});if(!B.isEmpty(P)){s("#input-port-destination").show();P.sort(function(U,T){return U.text.localeCompare(T.text)});s("#input-port-options").combo({options:P,maxHeight:300,select:function(T){s("#connection-destination-id").val(T.value)}});s("#connection-destination-component-id").val(R.id);s("#connection-destination-group-id").val(R.id);s("#connection-destination-group-name").text(Q);M.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+B.escapeHtml(Q)+"' does not have any input ports."});j();M.reject()}}).fail(function(Q,O,P){c.handleAjaxError(Q,O,P);M.reject()})}).promise()};var H=function(L,M){return s.Deferred(function(N){var O=L.datum();s.ajax({type:"GET",url:O.uri,dataType:"json"}).done(function(P){var R=P.component;var S=R.contents;if(!B.isEmpty(S.inputPorts)){s("#input-port-destination").show();var Q=[];s.each(S.inputPorts,function(U,T){Q.push({text:T.name,value:T.id,disabled:T.exists===false,description:B.escapeHtml(T.comments)})});Q.sort(function(U,T){return U.text.localeCompare(T.text)});s("#input-port-options").combo({options:Q,maxHeight:300,select:function(T){s("#connection-destination-id").val(T.value)}});s("#connection-destination-component-id").val(R.id);s("#connection-destination-group-id").val(R.id);s("#connection-destination-group-name").text(R.name);N.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+B.escapeHtml(R.name)+"' does not have any input ports."});j();N.reject()}}).fail(function(R,P,Q){c.handleAjaxError(R,P,Q);N.reject()})}).promise()};var I=function(L){return s.Deferred(function(N){var O=L.datum();var M=O.permissions.canRead?O.component.name:O.id;s("#read-only-output-port-source").show();s("#connection-source-component-id").val(O.id);s("#connection-source-group-id").val(O.id);s("#connection-source-group-name").text(M);N.resolve()}).promise()};var i=function(L){if(G.isProcessor(L)){return A(L)}else{if(G.isInputPort(L)){return z(L)}else{if(G.isFunnel(L)){return k(L)}else{return I(L)}}}};var u=function(L,M){if(G.isProcessor(L)){return w(L)}else{if(G.isOutputPort(L)){return m(L)}else{if(G.isRemoteProcessGroup(L)){return H(L,M)}else{if(G.isFunnel(L)){return p(L)}else{return J(L)}}}}};var t=function(M){var L=s('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(M);var N=s('<span class="relationship-name-value hidden"></span>').text(M);return s('<div class="available-relationship-container"><div class="available-relationship nf-checkbox checkbox-unchecked"></div></div>').append(L).append(N).appendTo("#relationship-names")};var y=function(N){var ah=s("#connection-source-id").val();var ae=s("#connection-destination-id").val();var al=s("#connection-source-component-id").val();var ab=C.select("#id-"+al);var af=s("#connection-destination-component-id").val();var U=C.select("#id-"+af);var at=ab.datum();var V=U.datum();var O=[];if(al===af){var aa={x:at.position.x+(at.dimensions.width),y:at.position.y+(at.dimensions.height/2)};var ag=K.config.selfLoopXOffset;var ai=K.config.selfLoopYOffset;O.push({x:(aa.x+ag),y:(aa.y-ai)});O.push({x:(aa.x+ag),y:(aa.y+ai)})}else{var aq=[];var ak=K.getComponentConnections(al);s.each(ak,function(aw,az){var ax=G.getConnectionSourceComponentId(az);var ay=G.getConnectionDestinationComponentId(az);if((ax===al&&ay===af)||(ay===al&&ax===af)){aq.push(az)}});if(aq.length>0){var P=false;s.each(aq,function(aw,ax){if(B.isEmpty(ax.bends)){P=true;return false}});if(P===true){var ac=[at.position.x+(at.dimensions.width/2),at.position.y+(at.dimensions.height/2)];var M=[V.position.x+(V.dimensions.width/2),V.position.y+(V.dimensions.height/2)];var Z=((ac[1]-M[1])/(ac[0]-M[0]));var ao=Z<=1&&Z>=-1;var aj=function(aw,ay){var ax=false;s.each(aq,function(az,aA){if(!B.isEmpty(aA.bends)){if(ao){if(aA.bends[0].y===ay){ax=true;return false}}else{if(aA.bends[0].x===aw){ax=true;return false}}}});return ax};var S=(ac[0]+M[0])/2;var W=(ac[1]+M[1])/2;var an=ao?0:F;var Y=ao?l:0;var ap=false;while(ap===false){if(aj(S-an,W-Y)===false){O.push({x:(S-an),y:(W-Y)});ap=true}else{if(aj(S+an,W+Y)===false){O.push({x:(S+an),y:(W+Y)});ap=true}}if(ao){Y+=l}else{an+=F}}}}}var R=s("#connection-source-group-id").val();var L=s("#connection-destination-group-id").val();var au=G.getConnectableTypeForSource(ab);var X=G.getConnectableTypeForDestination(U);var T=s("#connection-name").val();var Q=s("#flow-file-expiration").val();var ar=s("#back-pressure-object-threshold").val();var av=s("#back-pressure-data-size-threshold").val();var ad=s("#prioritizer-selected").sortable("toArray");if(E()){var am={revision:f.getRevision({revision:{version:0}}),component:{name:T,source:{id:ah,groupId:R,type:au},destination:{id:ae,groupId:L,type:X},selectedRelationships:N,flowFileExpiration:Q,backPressureDataSizeThreshold:av,backPressureObjectThreshold:ar,bends:O,prioritizers:ad}};s.ajax({type:"POST",url:x.urls.api+"/process-groups/"+encodeURIComponent(G.getGroupId())+"/connections",data:JSON.stringify(am),dataType:"json",contentType:"application/json"}).done(function(aw){o.add({connections:[aw]},{selectAll:true});G.reloadConnectionSourceAndDestination(al,af);o.updateVisibility();d.refresh()}).fail(function(ay,aw,ax){c.handleAjaxError(ay,aw,ax)})}};var v=function(R){var S=s("#connection-id").text();var N=s("#connection-uri").val();var aa=s("#connection-source-component-id").val();var V=s("#connection-destination-component-id").val();var X=C.select("#id-"+V);var T=G.getConnectableTypeForDestination(X);var L=s("#connection-destination-id").val();var U=s("#connection-destination-group-id").val();var Q=s("#connection-name").val();var O=s("#flow-file-expiration").val();var Z=s("#back-pressure-object-threshold").val();var P=s("#back-pressure-data-size-threshold").val();var Y=s("#prioritizer-selected").sortable("toArray");if(E()){var W=K.get(S);var M={revision:f.getRevision(W),component:{id:S,name:Q,destination:{id:L,groupId:U,type:T},selectedRelationships:R,flowFileExpiration:O,backPressureDataSizeThreshold:P,backPressureObjectThreshold:Z,prioritizers:Y}};return s.ajax({type:"PUT",url:N,data:JSON.stringify(M),dataType:"json",contentType:"application/json"}).done(function(ab){K.set(ab);G.reloadConnectionSourceAndDestination(aa,V)}).fail(function(ad,ab,ac){if(ad.status===400||ad.status===404||ad.status===409){h.showOkDialog({headerText:"Connection Configuration",dialogContent:B.escapeHtml(ad.responseText),})}else{c.handleAjaxError(ad,ab,ac)}})}else{return s.Deferred(function(ab){ab.reject()}).promise()}};var q=function(){var M=s("#relationship-names");var L=[];s.each(M.children(),function(N,Q){var P=s(Q);var O=P.children("div.available-relationship");if(O.hasClass("checkbox-checked")){L.push(P.children("span.relationship-name-value").text())}});return L};var E=function(){var L=[];if(B.isBlank(s("#flow-file-expiration").val())){L.push("File expiration must be specified")}if(!s.isNumeric(s("#back-pressure-object-threshold").val())){L.push("Back pressure object threshold must be an integer value")}if(B.isBlank(s("#back-pressure-data-size-threshold").val())){L.push("Back pressure data size threshold must be specified")}if(L.length>0){h.showOkDialog({headerText:"Connection Configuration",dialogContent:B.formatUnorderedList(L)});return false}else{return true}};var j=function(){var N=s("#prioritizer-selected");var L=s("#prioritizer-available");N.children().detach().appendTo(L);var M=L.children("li").get();M.sort(function(P,O){var R=s(P).text().toUpperCase();var Q=s(O).text().toUpperCase();return(R<Q)?-1:(R>Q)?1:0});s.each(M,function(){s(this).detach()});s.each(M,function(){s(this).appendTo(L)});s("#connection-name").val("");s("#relationship-names").css("border-width","0").empty();s("#relationship-names-container").hide();B.clearField("connection-id");s("#processor-source").hide();s("#input-port-source").hide();s("#output-port-source").hide();s("#read-only-output-port-source").hide();s("#funnel-source").hide();s("#processor-destination").hide();s("#input-port-destination").hide();s("#output-port-destination").hide();s("#funnel-destination").hide();s("#connection-source-id").val("");s("#connection-source-component-id").val("");s("#connection-source-group-id").val("");s("#connection-destination-id").val("");s("#connection-destination-component-id").val("");s("#connection-destination-group-id").val("");s("#output-port-options").empty();s("#input-port-options").empty();g()};var n={init:function(M,L){d=M;o=L;s("#relationship-names-container").hide();s("#connection-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Connection",handler:{close:function(){j()},open:function(){B.toggleScrollable(s("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});s("#connection-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"connection-details-tab-content"},{name:"Settings",tabContentId:"connection-settings-tab-content"}]});s.ajax({type:"GET",url:x.urls.prioritizers,dataType:"json"}).done(function(N){s.each(N.prioritizerTypes,function(O,P){n.addAvailablePrioritizer("#prioritizer-available",P)});s("#prioritizer-available, #prioritizer-selected").sortable({containment:s("#connection-settings-tab-content").find(".settings-right"),connectWith:"ul",placeholder:"ui-state-highlight",scroll:true,opacity:0.6});s("#prioritizer-available, #prioritizer-selected").disableSelection()}).fail(c.handleAjaxError)},addAvailablePrioritizer:function(Q,O){var N=O.type;var M=B.substringAfterLast(N,".");var P=s(Q);var L=s("<li></li>").append(s('<span style="float: left;"></span>').text(M)).attr("id",N).addClass("ui-state-default").appendTo(P);if(B.isDefinedAndNotNull(O.description)){s('<div class="fa fa-question-circle" style="float: right; margin-right: 5px;""></div>').appendTo(L).qtip(s.extend({content:B.escapeHtml(O.description)},B.config.tooltipConfig))}},createConnection:function(N,O){var M=C.select("#id-"+N);var L=C.select("#id-"+O);if(M.empty()||L.empty()){return}s.when(b(M),a(L)).done(function(){s("#flow-file-expiration").val("0 sec");s("#back-pressure-object-threshold").val("10000");s("#back-pressure-data-size-threshold").val("1 GB");s("#connection-configuration-tabs").find("li:first").click();s("#connection-configuration").modal("setHeaderText","Create Connection").modal("show");s("#connection-configuration div.relationship-name").ellipsis();B.populateField("connection-id",null);var P=s("#relationship-names");if(P.is(":visible")&&P.get(0).scrollHeight>Math.round(P.innerHeight())){P.css("border-width","1px")}}).fail(function(){g()})},showConfiguration:function(M,L){return s.Deferred(function(O){var P=M.datum();var N=P.component;var S=G.getConnectionSourceComponentId(P);var Q=C.select("#id-"+S);if(B.isUndefinedOrNull(L)){var R=G.getConnectionDestinationComponentId(P);L=C.select("#id-"+R)}s.when(i(Q),u(L,N.destination)).done(function(){var V=N.availableRelationships;var U=N.selectedRelationships;if(B.isDefinedAndNotNull(V)||B.isDefinedAndNotNull(U)){s.each(V,function(Y,X){t(X)});r();s.each(U,function(Z,X){if(s.inArray(X,V)===-1){var aa=t(X);s(aa).children("div.relationship-name").addClass("undefined")}var Y=s("#relationship-names").children("div");s.each(Y,function(ab,ad){var ac=s(ad).children("span.relationship-name-value");if(ac.text()===X){s(ad).children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}})})}if(G.isProcessGroup(Q)||G.isRemoteProcessGroup(Q)){s("#connection-source-id").val(N.source.id);s("#read-only-output-port-name").text(N.source.name).attr("title",N.source.name)}if(G.isProcessGroup(L)||G.isRemoteProcessGroup(L)){var T=L.datum();if(N.destination.groupId===T.id){s("#input-port-options").combo("setSelectedOption",{value:N.destination.id})}}s("#connection-name").val(N.name);s("#flow-file-expiration").val(N.flowFileExpiration);s("#back-pressure-object-threshold").val(N.backPressureObjectThreshold);s("#back-pressure-data-size-threshold").val(N.backPressureDataSizeThreshold);B.populateField("connection-id",N.id);s.each(N.prioritizers,function(X,Y){s("#prioritizer-available").children('li[id="'+Y+'"]').detach().appendTo("#prioritizer-selected")});s("#connection-uri").val(P.uri);s("#connection-configuration").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(G.isProcessor(Q)){return q().length===0}return false},handler:{click:function(){if(G.isProcessor(Q)){v(q()).done(function(){O.resolve()}).fail(function(){O.reject()})}else{v(undefined).done(function(){O.resolve()}).fail(function(){O.reject()})}s("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){s("#connection-configuration").modal("hide");O.reject()}}}]);s("#connection-configuration").modal("setHeaderText","Configure Connection").modal("show");s("#connection-configuration div.relationship-name").ellipsis();var W=s("#relationship-names");if(W.is(":visible")&&W.get(0).scrollHeight>Math.round(W.innerHeight())){W.css("border-width","1px")}}).fail(function(){O.reject()})}).promise()}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group-name").text("");d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group-name").text("");d("#read-only-relationship-names").css("border-width","0").empty();d("#read-only-flow-file-expiration").text("");d("#read-only-back-pressure-object-threshold").text("");d("#read-only-back-pressure-data-size-threshold").text("");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ng.Bridge"],function(f,e,g,d,c){return(nf.ContextMenu=b(f,e,g,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ContextMenu=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ng.Bridge")))}else{nf.ContextMenu=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ng.Bridge)}}}(this,function(F,S,O,X,o){var y;var I=function(ab){return X.getParentGroupId()!==null&&ab.empty()};var V=function(ab){return X.isConfigurable(ab)};var Z=function(ab){return ab.empty()||X.isProcessGroup(ab)};var G=function(ab){return X.hasDetails(ab)};var t=function(ab){return X.areDeletable(ab)};var P=function(ab){return X.canWriteCurrentGroup()&&(ab.empty()||X.canRead(ab))};var c=function(ab){return X.canWriteCurrentGroup()&&ab.empty()};var W=function(ab){return X.getComponentByType("Connection").isDisconnected(ab)&&X.canModify(ab)};var H=function(ab){return X.canEnable(ab)};var B=function(ab){return X.canDisable(ab)};var D=function(ab){return X.isManagedAuthorizer()&&X.canManagePolicies(ab)};var p=function(ab){return X.areRunnable(ab)};var L=function(ab){return X.areStoppable(ab)};var l=function(ab){if(ab.size()!==1){return false}return X.isProcessor(ab)||X.isProcessGroup(ab)||X.isRemoteProcessGroup(ab)||X.isConnection(ab)};var M=function(ab){if(ab.size()!==1){return false}if(X.canRead(ab)===false){return false}return X.isProcessor(ab)};var u=function(ab){return ab.size()===1&&!X.isConnection(ab)};var h=function(ab){return X.isCopyable(ab)};var d=function(ab){return X.isPastable()};var T=function(ab){return ab.empty()};var x=function(ab){if(ab.size()!==1){return false}if(X.canModify(ab)===false){return false}return X.isConnection(ab)};var q=function(ab){return X.canAlign(ab)};var w=function(ab){return X.isColorable(ab)};var Y=function(ab){if(ab.size()!==1){return false}return X.isConnection(ab)};var n=function(ab){if(ab.size()!==1){return false}return X.isFunnel(ab)||X.isProcessor(ab)||X.isProcessGroup(ab)||X.isRemoteProcessGroup(ab)||X.isInputPort(ab)||(X.isOutputPort(ab)&&X.getParentGroupId()!==null)};var s=function(ab){if(ab.size()!==1){return false}return X.isFunnel(ab)||X.isProcessor(ab)||X.isProcessGroup(ab)||X.isRemoteProcessGroup(ab)||X.isOutputPort(ab)||(X.isInputPort(ab)&&X.getParentGroupId()!==null)};var m=function(ac){if(ac.size()!==1){return false}if(X.canRead(ac)===false||X.canModify(ac)===false){return false}if(X.isProcessor(ac)){var ab=ac.datum();return ab.component.persistsState===true}else{return false}};var J=function(ac){if(ac.size()!==1){return false}if(X.canRead(ac)===false||X.canModify(ac)===false){return false}if(X.isProcessor(ac)){var ab=ac.datum();return ab.component.multipleVersionsAvailable===true}else{return false}};var a=function(ab){if(ab.size()!==1){return false}return X.isProcessGroup(ab)};var K=function(ab){if(O.canVersionFlows()===false){return false}if(ab.empty()){if(X.getParentGroupId()===null){return false}return X.canReadCurrentGroup()&&X.canWriteCurrentGroup()}if(a(ab)===true){return X.canRead(ab)&&X.canModify(ab)}return false};var Q=function(ac){if(K(ac)===false){return false}if(ac.empty()){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ab.length>0){var ad=ab[ab.length-1];if(ad.permissions.canRead){return O.isUndefinedOrNull(ad.breadcrumb.versionControlInformation)}else{return false}}else{return false}}var ae=ac.datum();return O.isUndefinedOrNull(ae.component.versionControlInformation)};var N=function(ac){if(K(ac)===false){return false}var ae;if(ac.empty()){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ab.length>0){var ad=ab[ab.length-1];if(ad.permissions.canRead){ae=ad.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var af=ac.datum();ae=af.component.versionControlInformation}if(O.isUndefinedOrNull(ae)){return false}return ae.state==="LOCALLY_MODIFIED"};var e=function(ac){if(K(ac)===false){return false}var ae;if(ac.empty()){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ab.length>0){var ad=ab[ab.length-1];if(ad.permissions.canRead){ae=ad.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var af=ac.datum();ae=af.component.versionControlInformation}if(O.isUndefinedOrNull(ae)){return false}return ae.state==="LOCALLY_MODIFIED"||ae.state==="LOCALLY_MODIFIED_AND_STALE"};var aa=function(ac){if(K(ac)===false){return false}var ae;if(ac.empty()){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ab.length>0){var ad=ab[ab.length-1];if(ad.permissions.canRead){ae=ad.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var af=ac.datum();ae=af.component.versionControlInformation}if(O.isUndefinedOrNull(ae)){return false}return ae.state!=="LOCALLY_MODIFIED"&&ae.state!=="LOCALLY_MODIFIED_AND_STALE"&&ae.state!=="SYNC_FAILURE"};var E=function(ac){if(K(ac)===false){return false}if(ac.empty()){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ab.length>0){var ad=ab[ab.length-1];if(ad.permissions.canRead){return O.isDefinedAndNotNull(ad.breadcrumb.versionControlInformation)}else{return false}}else{return false}}var ae=ac.datum();return O.isDefinedAndNotNull(ae.component.versionControlInformation)};var r=function(ab){if(ab.size()!==1){return false}return !X.isLabel(ab)&&!X.isConnection(ab)&&!X.isProcessGroup(ab)&&!X.isRemoteProcessGroup(ab)&&O.canAccessProvenance()};var b=function(ab){if(ab.size()!==1){return false}if(X.canRead(ab)===false){return false}return X.isRemoteProcessGroup(ab)};var A=function(ab){if(X.canModify(ab)===false){return false}return X.canAllStartTransmitting(ab)};var j=function(ab){if(X.canModify(ab)===false){return false}return X.canAllStopTransmitting(ab)};var U=function(ab){return Y(ab)};var k=function(ab){return Y(ab)};var v=function(ab){if(X.canModify(ab)===false){return false}return !ab.empty()&&X.getComponentByType("Connection").isDisconnected(ab)&&X.getParentGroupId()!==null};var C=function(ab){ab.remove().find(".group-menu-item").each(function(){var ac=F(this).attr("id");C(F("#"+ac+"-sub-menu"))})};var i=function(ac,ae){var ad=F('<div class="context-menu-item"></div>').attr("id",ae.id).on("mouseenter",function(){F(this).addClass("hover");ac.find(".group-menu-item").not("#"+ae.id).each(function(){var af=F(this).attr("id");C(F("#"+af+"-sub-menu"))})}).on("mouseleave",function(){F(this).removeClass("hover")}).appendTo(ac);var ab=F('<div class="context-menu-item-img"></div>').addClass(ae.clazz).appendTo(ad);if(O.isDefinedAndNotNull(ae.imgStyle)){ab.addClass(ae.imgStyle)}F('<div class="context-menu-item-text"></div>').text(ae.text).appendTo(ad);if(ae.isGroup){F('<div class="fa fa-caret-right context-menu-group-item-img"></div>').appendTo(ad)}F('<div class="clear"></div>').appendTo(ad);return ad};var f=function(ac,ab){ac.css({left:ab.x+"px",top:ab.y+"px"}).show()};var R=function(ad,ac,ab){y[ad](ac,ab);z.hide()};var g=[{id:"reload-menu-item",condition:T,menuItem:{clazz:"fa fa-refresh",text:"Refresh",action:"reload"}},{id:"leave-group-menu-item",condition:I,menuItem:{clazz:"fa fa-level-up",text:"Leave group",action:"leaveGroup"}},{separator:true},{id:"show-configuration-menu-item",condition:V,menuItem:{clazz:"fa fa-gear",text:"Configure",action:"showConfiguration"}},{id:"show-details-menu-item",condition:G,menuItem:{clazz:"fa fa-gear",text:"View configuration",action:"showDetails"}},{id:"variable-registry-menu-item",condition:Z,menuItem:{clazz:"fa",text:"Variables",action:"openVariableRegistry"}},{separator:true},{id:"version-menu-item",groupMenuItem:{clazz:"fa",text:"Version"},menuItems:[{id:"start-version-control-menu-item",condition:Q,menuItem:{clazz:"fa fa-upload",text:"Start version control",action:"saveFlowVersion"}},{separator:true},{id:"commit-menu-item",condition:N,menuItem:{clazz:"fa fa-upload",text:"Commit local changes",action:"saveFlowVersion"}},{id:"local-changes-menu-item",condition:e,menuItem:{clazz:"fa",text:"Show local changes",action:"showLocalChanges"}},{id:"revert-menu-item",condition:e,menuItem:{clazz:"fa fa-undo",text:"Revert local changes",action:"revertLocalChanges"}},{id:"change-version-menu-item",condition:aa,menuItem:{clazz:"fa",text:"Change version",action:"changeFlowVersion"}},{separator:true},{id:"stop-version-control-menu-item",condition:E,menuItem:{clazz:"fa",text:"Stop version control",action:"stopVersionControl"}}]},{separator:true},{id:"enter-group-menu-item",condition:a,menuItem:{clazz:"fa fa-sign-in",text:"Enter group",action:"enterGroup"}},{separator:true},{id:"start-menu-item",condition:p,menuItem:{clazz:"fa fa-play",text:"Start",action:"start"}},{id:"stop-menu-item",condition:L,menuItem:{clazz:"fa fa-stop",text:"Stop",action:"stop"}},{id:"enable-menu-item",condition:H,menuItem:{clazz:"fa fa-flash",text:"Enable",action:"enable"}},{id:"disable-menu-item",condition:B,menuItem:{clazz:"icon icon-enable-false",text:"Disable",action:"disable"}},{id:"enable-transmission-menu-item",condition:A,menuItem:{clazz:"fa fa-bullseye",text:"Enable transmission",action:"enableTransmission"}},{id:"disable-transmission-menu-item",condition:j,menuItem:{clazz:"icon icon-transmit-false",text:"Disable transmission",action:"disableTransmission"}},{separator:true},{id:"data-provenance-menu-item",condition:r,menuItem:{clazz:"icon icon-provenance",imgStyle:"context-menu-provenance",text:"View data provenance",action:"openProvenance"}},{id:"show-stats-menu-item",condition:l,menuItem:{clazz:"fa fa-area-chart",text:"View status history",action:"showStats"}},{id:"view-state-menu-item",condition:m,menuItem:{clazz:"fa fa-tasks",text:"View state",action:"viewState"}},{id:"list-queue-menu-item",condition:k,menuItem:{clazz:"fa fa-list",text:"List queue",action:"listQueue"}},{id:"show-usage-menu-item",condition:M,menuItem:{clazz:"fa fa-book",text:"View usage",action:"showUsage"}},{id:"view-menu-item",groupMenuItem:{clazz:"icon icon-connect",text:"View connections"},menuItems:[{id:"show-upstream-menu-item",condition:s,menuItem:{clazz:"icon",text:"Upstream",action:"showUpstream"}},{id:"show-downstream-menu-item",condition:n,menuItem:{clazz:"icon",text:"Downstream",action:"showDownstream"}}]},{separator:true},{id:"refresh-remote-flow-menu-item",condition:b,menuItem:{clazz:"fa fa-refresh",text:"Refresh remote",action:"refreshRemoteFlow"}},{separator:true},{id:"remote-ports-menu-item",condition:b,menuItem:{clazz:"fa fa-cloud",text:"Manage remote ports",action:"remotePorts"}},{id:"manage-policies-menu-item",condition:D,menuItem:{clazz:"fa fa-key",text:"Manage access policies",action:"managePolicies"}},{id:"change-version-menu-item",condition:J,menuItem:{clazz:"fa fa-exchange",text:"Change version",action:"changeVersion"}},{separator:true},{id:"show-source-menu-item",condition:Y,menuItem:{clazz:"fa fa-long-arrow-left",text:"Go to source",action:"showSource"}},{id:"show-destination-menu-item",condition:Y,menuItem:{clazz:"fa fa-long-arrow-right",text:"Go to destination",action:"showDestination"}},{separator:true},{id:"align-menu-item",groupMenuItem:{clazz:"fa",text:"Align"},menuItems:[{id:"align-horizontal-menu-item",condition:q,menuItem:{clazz:"fa fa-align-center fa-rotate-90",text:"Horizontally",action:"alignHorizontal"}},{id:"align-vertical-menu-item",condition:q,menuItem:{clazz:"fa fa-align-center",text:"Vertically",action:"alignVertical"}}]},{id:"to-front-menu-item",condition:x,menuItem:{clazz:"fa fa-clone",text:"Bring to front",action:"toFront"}},{id:"center-menu-item",condition:u,menuItem:{clazz:"fa fa-crosshairs",text:"Center in view",action:"center"}},{id:"fill-color-menu-item",condition:w,menuItem:{clazz:"fa fa-paint-brush",text:"Change color",action:"fillColor"}},{id:"open-uri-menu-item",condition:b,menuItem:{clazz:"fa fa-external-link",text:"Go to",action:"openUri"}},{separator:true},{id:"move-into-parent-menu-item",condition:v,menuItem:{clazz:"fa fa-arrows",text:"Move to parent group",action:"moveIntoParent"}},{id:"group-menu-item",condition:W,menuItem:{clazz:"icon icon-group",text:"Group",action:"group"}},{separator:true},{id:"upload-template-menu-item",condition:c,menuItem:{clazz:"icon icon-template-import",text:"Upload template",action:"uploadTemplate"}},{id:"template-menu-item",condition:P,menuItem:{clazz:"icon icon-template-save",text:"Create template",action:"template"}},{separator:true},{id:"copy-menu-item",condition:h,menuItem:{clazz:"fa fa-copy",text:"Copy",action:"copy"}},{id:"paste-menu-item",condition:d,menuItem:{clazz:"fa fa-paste",text:"Paste",action:"paste"}},{separator:true},{id:"empty-queue-menu-item",condition:U,menuItem:{clazz:"fa fa-minus-circle",text:"Empty queue",action:"emptyQueue"}},{id:"delete-menu-item",condition:t,menuItem:{clazz:"fa fa-trash",text:"Delete",action:"delete"}}];var z={init:function(ab){y=ab;F("#context-menu").on("contextmenu",function(ac){ac.preventDefault();ac.stopPropagation()})},show:function(){nf.ContextMenu.hide();var af=F("#context-menu").empty();var ai=F("#canvas-body").get(0);var an=F("#banner-footer").get(0);var ag=F("#breadcrumbs").get(0);var al=X.getSelection();var aj=S.mouse(ai);var ac=function(ao,ap){return ao+ap.width()>ai.clientWidth};var ad=function(ap,ao){return ap+ao.height()>(ai.clientHeight-ag.clientHeight-an.clientHeight)};var am=function(ap,aq,ao){i(ap,{id:aq,clazz:ao.clazz,imgStyle:ao.imgStyle,text:ao.text,isGroup:false}).on("click",function(ar){R(ao.action,al,ar)}).on("contextmenu",function(ar){R(ao.action,al,ar);ar.preventDefault();ar.stopPropagation()})};var ak=function(aq,ap,ao,ar){i(aq,{id:ap,clazz:ao.clazz,imgStyle:ao.imgStyle,text:ao.text,isGroup:true}).addClass("group-menu-item").on("mouseenter",function(){if(F("#"+ap+"-sub-menu").length==0){var ax=F(this);var au=aq.position();var aw=ax.position();var at=au.left+aw.left+ax.width();var ay=au.top+aw.top;var av=F('<div class="context-menu unselectable sub-menu"></div>').attr("id",ap+"-sub-menu").appendTo("body");ab(av,ar);if(ac(at,av)){at-=(av.width()+ax.width()-4)}if(ad(ay,av)){ay-=(av.height()-ax.height())}av.css({top:ay+"px",left:at+"px"}).show()}})};var ah=function(ap){if(ap.separator){return true}else{if(ap.menuItem){return ap.condition(al)}else{var ao=[];F.each(ap.menuItems,function(aq,ar){if(ah(ar)){ao.push(ar)}});return ao.length>0}}};var ab=function(ar,ao){var ap=false;F.each(ao,function(at,au){if(au.separator&&ap){F('<div class="context-menu-item-separator"></div>').appendTo(ar);ap=false}else{if(ae(ar,au)){ap=true}}});var aq=ar.children().last();if(aq.hasClass("context-menu-item-separator")){aq.remove()}};var ae=function(aq,ao){var ap=false;if(ao.menuItem){ap=ao.condition(al);if(ap){am(aq,ao.id,ao.menuItem)}}else{if(ao.groupMenuItem){var at=[];F.each(ao.menuItems,function(av,au){if(ah(au)){at.push(au)}});var ar=F.grep(at,function(au){return O.isUndefinedOrNull(au.separator)});ap=ar.length>0;if(ap){ak(aq,ao.id,ao.groupMenuItem,at)}}}return ap};ab(af,g);if(ac(aj[0],af)){aj[0]=ai.clientWidth-af.width()-2}if(ad(aj[1],af)){aj[1]=ai.clientHeight-ag.clientHeight-an.clientHeight-af.height()-9}f(af,{x:aj[0],y:aj[1]});o.digest()},hide:function(){F("#context-menu").hide();F("div.context-menu.sub-menu").remove()},activate:function(ab){ab.on("contextmenu.selection",function(){z.show();S.event.preventDefault();S.event.stopPropagation()})}};return z}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.CanvasUtils"],function(d,c){return(nf.QuickSelect=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QuickSelect=b(require("d3"),require("nf.CanvasUtils")))}else{nf.QuickSelect=b(a.d3,a.nf.CanvasUtils)}}}(this,function(d,c){var b;var a={init:function(e){b=e},quickSelect:function(){var e=c.getSelection();if(c.isConfigurable(e)){b.showConfiguration(e)}else{if(c.hasDetails(e)){b.showDetails(e)}}d.event.preventDefault();d.event.stopPropagation()},activate:function(e){e.on("dblclick",function(){a.quickSelect()})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.ng.Bridge","nf.ContextMenu","nf.CanvasUtils"],function(f,d,c,e){return(nf.Selectable=b(f,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Selectable=b(require("d3"),require("nf.ng.Bridge"),require("nf.ContextMenu"),require("nf.CanvasUtils")))}else{nf.Selectable=b(a.d3,a.nf.ng.Bridge,a.nf.ContextMenu,a.nf.CanvasUtils)}}}(this,function(d,b,a,c){var e={select:function(f){a.hide();if(!f.classed("selected")){if(!d.event.shiftKey){d.selectAll("g.selected").classed("selected",false)}f.classed("selected",true)}else{if(d.event.shiftKey){f.classed("selected",false)}}b.digest();d.event.stopPropagation()},activate:function(f){f.on("mousedown.selection",function(){e.select(d.select(this));c.setURLParameters()})}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ContextMenu","nf.Label"],function(f,e,g,d,c,h){return(nf.Birdseye=b(f,e,g,d,c,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Birdseye=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.Label")))}else{nf.Birdseye=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.Label)}}}(this,function(g,l,d,e,k,f){var h;var c;var j;var i=function(F){var D=e.translateCanvasView();var U=e.scaleCanvasView();D=[D[0]/U,D[1]/U];var x=l.select("#canvas").node().getBoundingClientRect();var m=(x.left/U)-D[0];var z=((x.top-e.getCanvasOffset())/U)-D[1];var E=(x.right/U)-D[0];var s=(x.bottom/U)-D[1];var H=g("#canvas-container");var I=H.width()/U;var S=H.height()/U;var y=-D[0];var M=-D[1];var T=y+I;var v=M+S;var K=Math.min(m,y);var N=Math.min(z,M);var p=Math.max(E,T);var Q=Math.max(s,v);var R=p-K;var n=Q-N;var C=g("#birdseye");var B=C.width();var u=C.height();var L=B/R;var t=u/n;var J=Math.min(L,t);var r=[0,0];var o=[0,0];if(D[0]<0&&D[1]<0){r=[0,0];o=[-D[0],-D[1]]}else{if(D[0]>=0&&D[1]<0){r=[D[0],0];o=[0,-D[1]]}else{if(D[0]<0&&D[1]>=0){r=[0,D[1]];o=[-D[0],0]}else{r=[D[0],D[1]];o=[0,0]}}}var P=0;var w=-m;if(D[0]<0){if(D[0]<w){P=w}else{P=w-(w-D[0])}}else{if(D[0]<w){P=w-D[0]}}var O=0;var G=-z;if(D[1]<0){if(D[1]<G){O=G}else{O=G-(G-D[1])}}else{if(D[1]<G){O=G-D[1]}}r=[r[0]+P,r[1]+O];o=[o[0]+P,o[1]+O];c.attr("transform","scale("+J+")");j.attr("transform","translate("+r+")");l.select("rect.birdseye-brush").attr({width:I,height:S,"stroke-width":(2/J),transform:function(V){V.x=o[0];V.y=o[1];return"translate("+o+")"}});var A=l.select("#birdseye-canvas").node();var q=A.getContext("2d");q.save();q.setTransform(1,0,0,1,0,0);q.clearRect(0,0,A.width,A.height);q.restore();q.save();q.translate(r[0]*J,r[1]*J);q.scale(J,J);g.each(F.labels,function(W,X){var V=f.defaultColor();if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"]}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.fillStyle="#ad9897";g.each(F.funnels,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#bbdcde";g.each(F.ports,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#728e9b";g.each(F.remoteProcessGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processors,function(W,X){var V="#dde4eb";if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"];if(V==="#ffffff"){V="#dde4eb"}}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.restore()};var b=true;var a={init:function(m){h=m;var p=g("#birdseye");l.select("#birdseye").append("canvas").attr("id","birdseye-canvas").attr("width",p.width()).attr("height",p.height());var o=l.select("#birdseye").append("svg").attr("width",p.width()).attr("height",p.height());c=o.append("g").attr("class","birdseye");j=c.append("g").attr("pointer-events","none");var n=l.behavior.drag().origin(function(q){return{x:q.x,y:q.y}}).on("dragstart",function(){k.hide()}).on("drag",function(s){s.x+=l.event.dx;s.y+=l.event.dy;l.select(this).attr("transform",function(){return"translate("+s.x+", "+s.y+")"});var r=e.scaleCanvasView();var q=e.translateCanvasView();q=[(-l.event.dx*r)+q[0],(-l.event.dy*r)+q[1]];e.translateCanvasView(q);e.refreshCanvasView({persist:false,transition:false,refreshComponents:false,refreshBirdseye:false})}).on("dragend",function(){h.updateVisibility();e.persistUserView();a.refresh()});c.append("g").attr({"pointer-events":"all","class":"birdseye-brush-container"}).append("rect").attr("class","birdseye-brush moveable").datum({x:0,y:0}).call(n)},refresh:function(){if(b){i(h.get())}},updateBirdseyeVisibility:function(m){var n=g("#birdseye");if(m){n.show();b=true;i(h.get())}else{n.hide();b=false}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler"],function(g,j,i,c,e,d,f,k,h){return(nf.Draggable=b(g,j,i,c,e,d,f,k,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Draggable=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler")))}else{nf.Draggable=b(a.$,a.d3,a.nf.Connection,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler)}}}(this,function(g,m,k,a,d,c,f,n,j){var l;var h;var i=function(p){var s=m.map();var r=p.datum();var t={x:r.x-r.original.x,y:r.y-r.original.y};if(t.x===0&&t.y===0){return}var o=m.selectAll("g.connection.selected");var q=m.selectAll("g.component.selected");if(d.canModify(o)===false||d.canModify(q)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}o.each(function(v){var u=e.updateConnectionPosition(v,t);if(u!==null){s.set(v.id,u)}});q.each(function(v){var u=k.getComponentConnections(v.id);g.each(u,function(y,x){if(!s.has(x.id)&&d.getConnectionSourceComponentId(x)===d.getConnectionDestinationComponentId(x)){var w=e.updateConnectionPosition(k.get(x.id),t);if(w!==null){s.set(x.id,w)}}});s.set(v.id,e.updateComponentPosition(v,t))});e.refreshConnections(s)};var b=function(p){var o=m.selectAll("g.component.selected, g.connection.selected").classed("selected",false);if(d.canModify(o)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}if(d.canModify(p)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Not authorized to modify the destination group."});return}d.moveComponents(o,p)};var e={init:function(o){l=o;h=m.behavior.drag().on("dragstart",function(){m.event.sourceEvent.stopPropagation()}).on("drag",function(){var q=m.select("rect.drag-selection");if(q.empty()){var r=m.selectAll("g.component.selected");var p=null,t=null,u=null,s=null;r.each(function(x){if(p===null||x.position.x<p){p=x.position.x}if(u===null||x.position.y<u){u=x.position.y}var w=x.position.x+x.dimensions.width;var v=x.position.y+x.dimensions.height;if(t===null||w>t){t=w}if(s===null||v>s){s=v}});m.select("#canvas").append("rect").attr("rx",6).attr("ry",6).attr("x",p).attr("y",u).attr("class","drag-selection").attr("pointer-events","none").attr("width",t-p).attr("height",s-u).attr("stroke-width",function(){return 1/d.scaleCanvasView()}).attr("stroke-dasharray",function(){return 4/d.scaleCanvasView()}).datum({original:{x:p,y:u},x:p,y:u})}else{q.attr("x",function(v){v.x+=m.event.dx;return v.x}).attr("y",function(v){v.y+=m.event.dy;return v.y})}}).on("dragend",function(){m.event.sourceEvent.stopPropagation();var p=m.select("rect.drag-selection");if(p.empty()){return}var q=m.select("g.drop").classed("drop",false);if(q.empty()){i(p)}else{b(q)}p.remove()})},updateComponentPosition:function(q,r){var p={x:q.position.x+r.x,y:q.position.y+r.y};var o={revision:n.getRevision(q),component:{id:q.id,position:p}};return g.Deferred(function(s){g.ajax({type:"PUT",url:q.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){d.getComponentByType(q.type).set(t);s.resolve({type:q.type,id:q.id})}).fail(function(v,t,u){if(v.status===400||v.status===404||v.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(v.responseText)})}else{j.handleAjaxError(v,t,u)}s.reject()})}).promise()},updateConnectionPosition:function(q,r){if(q.bends.length===0){return null}var p=g.map(q.bends,function(s){return{x:s.x+r.x,y:s.y+r.y}});var o={revision:n.getRevision(q),component:{id:q.id,bends:p}};return g.Deferred(function(s){g.ajax({type:"PUT",url:q.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){k.set(t);s.resolve({type:q.type,id:q.id})}).fail(function(v,t,u){if(v.status===400||v.status===404||v.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(v.responseText)})}else{j.handleAjaxError(v,t,u)}s.reject()})}).promise()},refreshConnections:function(o){if(o.size()>0){g.when.apply(window,o.values()).done(function(){var p=g.makeArray(arguments);var q=m.set();g.each(p,function(t,s){if(s.type==="Connection"){q.add(s.id)}else{var r=k.getComponentConnections(s.id);g.each(r,function(v,u){q.add(u.id)})}});q.forEach(function(r){k.refresh(r)})}).always(function(){a.refresh()})}},activate:function(o){o.classed("moveable",true).call(h)},deactivate:function(o){o.classed("moveable",false).on(".drag",null)}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils"],function(d,f,e,c){return(nf.Connectable=b(d,f,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connectable=b(require("d3"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils")))}else{nf.Connectable=b(a.d3,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils)}}}(this,function(f,h,g,e){var c;var d;var b;var a=function(){return !f.event.shiftKey&&f.select("rect.drag-selection").empty()&&f.select("rect.selection").empty()};return{init:function(){d=f.select("#canvas");c=f.behavior.drag().origin(function(i){b=f.mouse(d.node());return{x:b[0],y:b[1]}}).on("dragstart",function(l){f.event.sourceEvent.stopPropagation();e.getSelection().classed("selected",false);var k=f.select(this.parentNode).classed("selected",true);f.select(this).classed("dragging",true);var j=k.datum();var i=f.mouse(d.node());d.insert("path",":first-child").datum({sourceId:j.id,sourceWidth:j.dimensions.width,x:i[0],y:i[1]}).attr({"class":"connector",d:function(m){return"M"+m.x+" "+m.y+"L"+m.x+" "+m.y}});f.select(this).attr("transform",function(){return"translate("+i[0]+", "+(i[1]+20)+")"});d.node().appendChild(this)}).on("drag",function(j){f.select(this).attr("transform",function(){return"translate("+f.event.x+", "+(f.event.y+50)+")"});var i=f.select("g.hover").classed("connectable-destination",function(){return(Math.abs(b[0]-f.event.x)>10||Math.abs(b[1]-f.event.y)>10)&&e.isValidConnectionDestination(f.select(this))});f.select("path.connector").classed("connectable",function(){if(i.empty()){return false}return i.classed("connectable-destination")}).attr("d",function(r){if(!i.empty()&&i.classed("connectable-destination")){var m=i.datum();if(r.sourceId===m.id){var k=r.x;var q=r.y;var o=r.sourceWidth/2;var n=h.config.selfLoopXOffset;var p=h.config.selfLoopYOffset;return"M"+k+" "+q+"L"+(k+o+n)+" "+(q-p)+"L"+(k+o+n)+" "+(q+p)+"Z"}else{var l=e.getPerimeterPoint(r,{x:m.position.x,y:m.position.y,width:m.dimensions.width,height:m.dimensions.height});return"M"+r.x+" "+r.y+"L"+l.x+" "+l.y}}else{return"M"+r.x+" "+r.y+"L"+f.event.x+" "+f.event.y}})}).on("dragend",function(o){f.event.sourceEvent.stopPropagation();var q=f.select(this);var l=f.select("path.connector");var j=l.datum();var p=f.select("g.connectable-destination");if(p.empty()){var i=f.select("#id-"+j.sourceId);var m=i.datum();var n=f.mouse(i.node());if(n[0]<0||n[0]>m.dimensions.width||n[1]<0||n[1]>m.dimensions.height){q.remove()}else{q.classed("dragging",false).attr("transform",function(){return"translate("+o.origX+", "+o.origY+")"});i.node().appendChild(this)}l.remove()}else{q.remove();var k=p.datum();g.createConnection(j.sourceId,k.id)}})},activate:function(i){i.classed("connectable",true).on("mouseenter.connectable",function(m){if(a()){var k=f.select(this);if(e.isValidConnectionSource(k)){var l=f.select("text.add-connect");if(l.empty()){var j=(m.dimensions.width/2)-14;var n=(m.dimensions.height/2)+14;k.append("text").datum({origX:j,origY:n}).call(c).attr({"class":"add-connect",transform:"translate("+j+", "+n+")"}).text("\ue834")}}}}).on("mouseleave.connectable",function(){var j=f.select(this).select("text.add-connect");if(!j.empty()&&!j.classed("dragging")){j.remove()}}).on("mouseover.connectable",function(){f.select(this).classed("hover",function(){return a()})}).on("mouseout.connection",function(){f.select(this).classed("hover connectable-destination",false)})},deactivate:function(i){i.classed("connectable",false).on("mouseenter.connectable",null).on("mouseleave.connectable",null).on("mouseover.connectable",null).on("mouseout.connectable",null)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.ng.Bridge","nf.Label","nf.Funnel","nf.Port","nf.RemoteProcessGroup","nf.ProcessGroup","nf.Processor","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils","nf.Connectable","nf.Draggable","nf.Selectable","nf.ContextMenu","nf.QuickSelect"],function(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g){return(nf.Graph=b(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Graph=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Label"),require("nf.Funnel"),require("nf.Port"),require("nf.RemoteProcessGroup"),require("nf.ProcessGroup"),require("nf.Processor"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils"),require("nf.Connectable"),require("nf.Draggable"),require("nf.Selectable"),require("nf.ContextMenu"),require("nf.QuickSelect")))}else{nf.Graph=b(a.$,a.d3,a.nf.Common,a.nf.ng.Bridge,a.nf.Label,a.nf.Funnel,a.nf.Port,a.nf.RemoteProcessGroup,a.nf.ProcessGroup,a.nf.Processor,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils,a.nf.Connectable,a.nf.Draggable,a.nf.Selectable,a.nf.ContextMenu,a.nf.QuickSelect)}}}(this,function(b,u,e,v,j,q,a,l,d,k,g,r,s,i,n,h,o,f){var p=function(w){if(e.isDefinedAndNotNull(w.inputPorts)&&e.isDefinedAndNotNull(w.outputPorts)){return w.inputPorts.concat(w.outputPorts)}else{if(e.isDefinedAndNotNull(w.inputPorts)){return w.inputPorts}else{if(e.isDefinedAndNotNull(w.outputPorts)){return w.outputPorts}else{return[]}}}};var m=function(w){if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)&&e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.inputPortStatusSnapshots.concat(w.outputPortStatusSnapshots)}else{if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)){return w.inputPortStatusSnapshots}else{if(e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.outputPortStatusSnapshots}else{return[]}}}};var t=function(){var E=b("#canvas-container");var z=s.translateCanvasView();var A=s.scaleCanvasView();z=[z[0]/A,z[1]/A];var w=E.width()/A;var x=E.height()/A;var B=-z[0]-w;var y=-z[1]-x;var G=B+(w*3);var I=y+(x*3);var D=function(N){if(!s.shouldRenderPerScale()){return false}var M=N.position.x;var L=N.position.y;var K=M+N.dimensions.width;var J=L+N.dimensions.height;return B<K&&G>M&&y<J&&I>L};var F=function(L){if(!s.shouldRenderPerScale()){return false}var J,M;if(L.bends.length>0){var K=Math.min(Math.max(0,L.labelIndex),L.bends.length-1);J=L.bends[K].x;M=L.bends[K].y}else{J=(L.start.x+L.end.x)/2;M=(L.start.y+L.end.y)/2}return B<J&&G>J&&y<M&&I>M};var C=function(N,J){var L=u.select("#id-"+N.id);var M=J(N);var K=L.classed("visible");L.classed("visible",M).classed("entering",function(){return M&&!K}).classed("leaving",function(){return !M&&K})};var H=c.get();b.each(H.processors,function(J,K){C(K,D)});b.each(H.ports,function(J,K){C(K,D)});b.each(H.processGroups,function(J,K){C(K,D)});b.each(H.remoteProcessGroups,function(J,K){C(K,D)});b.each(H.connections,function(J,K){C(K,F)})};var c={init:function(){j.init(i,n,h,o,f);q.init(i,n,h,o);a.init(i,n,h,o,f);l.init(i,n,h,o,f);d.init(i,n,h,o);k.init(i,n,h,o,f);g.init(h,o,f,r);return s.showDeepLink(true)},add:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.add(y.labels,w);q.add(y.funnels,w);l.add(y.remoteProcessGroups,w);a.add(z,w);d.add(y.processGroups,w);k.add(y.processors,w);g.add(y.connections,w);if(x){v.digest()}},set:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.set(y.labels,w);q.set(y.funnels,w);l.set(y.remoteProcessGroups,w);a.set(z,w);d.set(y.processGroups,w);k.set(y.processors,w);g.set(y.connections,w);if(x){v.digest()}},expireCaches:function(w){j.expireCaches(w);q.expireCaches(w);l.expireCaches(w);a.expireCaches(w);d.expireCaches(w);k.expireCaches(w);g.expireCaches(w)},get:function(){return{labels:j.get(),funnels:q.get(),ports:a.get(),remoteProcessGroups:l.get(),processGroups:d.get(),processors:k.get(),connections:g.get()}},getComponentByType:function(w){switch(w){case"Label":return j;break;case"Funnel":return q;break;case"Port":return a;break;case"RemoteProcessGroup":return l;break;case"ProcessGroup":return d;break;case"Processor":return k;break;case"Connection":return g;break;default:throw new Error("Unknown component type.");break}},removeAll:function(){j.removeAll();q.removeAll();a.removeAll();l.removeAll();d.removeAll();k.removeAll();g.removeAll()},pan:function(){a.pan();l.pan();d.pan();k.pan();g.pan()},updateVisibility:function(){t();c.pan();s.setURLParameters()},getSelection:function(){return u.selectAll("g.component.selected, g.connection.selected")},reload:function(w){var x=w.datum();if(x.permissions.canRead){if(s.isProcessor(w)){k.reload(x.id)}else{if(s.isInputPort(w)){a.reload(x.id)}else{if(s.isRemoteProcessGroup(w)){l.reload(x.id)}}}}}};return c}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ng.Bridge","nf.ErrorHandler","nf.Dialog","nf.Common","nf.Client","nf.CanvasUtils","nf.ProcessGroup","nf.ProcessGroupConfiguration","nf.Graph","nf.Birdseye"],function(i,j,l,h,f,m,g,d,e,k,c){return(nf.FlowVersion=b(i,j,l,h,f,m,g,d,e,k,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FlowVerison=b(require("jquery"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("nf.Graph"),require("nf.Birdseye")))}else{nf.FlowVersion=b(a.$,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a.nf.Graph,a.nf.Birdseye)}}}(this,function(t,j,b,h,C,f,I,p,x,m,d){var n=null;var s={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var J=function(){t("#save-flow-version-registry-combo").combo("destroy").hide();t("#save-flow-version-bucket-combo").combo("destroy").hide();t("#save-flow-version-label").text("");t("#save-flow-version-registry").text("").hide();t("#save-flow-version-bucket").text("").hide();t("#save-flow-version-name").text("").hide();t("#save-flow-version-description").removeClass("unset blank").text("").hide();t("#save-flow-version-name-field").val("").hide();t("#save-flow-version-description-field").val("").hide();t("#save-flow-version-change-comments").val("");t("#save-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("")};var B=function(){t("#revert-local-changes-process-group-id").text("");y(t("#revert-local-changes-table"),t("#revert-local-changes-filter"),t("#displayed-revert-local-changes-entries"),t("#total-revert-local-changes-entries"))};var a=function(){y(t("#show-local-changes-table"),t("#show-local-changes-filter"),t("#displayed-show-local-changes-entries"),t("#total-show-local-changes-entries"))};var y=function(U,Q,S,T){var P=U.data("gridInstance");if(C.isDefinedAndNotNull(P)){P.setSelectedRows([]);P.resetActiveCell();var R=P.getData();R.setItems([]);R.setFilterArgs({searchString:""})}Q.val("");S.text("0");T.text("0")};var l=function(){var P=t("#import-flow-version-table").data("gridInstance");if(C.isDefinedAndNotNull(P)){P.setSelectedRows([]);P.resetActiveCell();var Q=P.getData();Q.setItems([])}};var O=function(){t("#import-flow-version-dialog").removeData("pt");t("#import-flow-version-registry-combo").combo("destroy").hide();t("#import-flow-version-bucket-combo").combo("destroy").hide();t("#import-flow-version-name-combo").combo("destroy").hide();t("#import-flow-version-registry").text("").hide();t("#import-flow-version-bucket").text("").hide();t("#import-flow-version-name").text("").hide();l();t("#import-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("");t("#import-flow-version-container").hide();t("#import-flow-version-label").text("")};var M=function(R,P,T,Q,S,U){return t.ajax({type:"GET",url:"../nifi-api/flow/registries",dataType:"json"}).done(function(V){var W=[];if(C.isDefinedAndNotNull(V.registries)&&V.registries.length>0){V.registries.sort(function(Y,X){return Y.registry.name>X.registry.name});t.each(V.registries,function(Y,Z){var X=Z.registry;W.push({text:X.name,value:X.id,description:C.escapeHtml(X.description)})})}else{W.push({text:"No available registries",value:null,optionClass:"unset",disabled:true})}P.combo({options:W,select:function(X){k(R,X,T,Q,S,U)}})}).fail(b.handleAjaxError)};var N=function(P,S,Q,R,T){return t.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(P)+"/buckets",dataType:"json"}).done(function(U){var V=[];if(C.isDefinedAndNotNull(U.buckets)&&U.buckets.length>0){U.buckets.sort(function(X,W){if(X.permissions.canRead===false&&W.permissions.canRead===false){return 0}else{if(X.permissions.canRead===false){return -1}else{if(W.permissions.canRead===false){return 1}}}return X.bucket.name>W.bucket.name});t.each(U.buckets,function(X,W){if(W.permissions.canRead===true){var Y=W.bucket;if(T(W)){V.push({text:Y.name,value:Y.id,description:C.escapeHtml(Y.description)})}}})}if(V.length===0){V.push({text:"No available buckets",value:null,optionClass:"unset",disabled:true});if(C.isDefinedAndNotNull(Q)){Q.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}}S.combo("destroy").combo({options:V,select:R})}).fail(b.handleAjaxError)};var k=function(Q,T,S,P,R,V){var U=function(){S.combo("destroy").combo({options:[{text:"No available buckets",value:null,optionClass:"unset",disabled:true}]});if(C.isDefinedAndNotNull(P)){P.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}Q.modal("refreshButtons")};if(T.disabled===true){U()}else{S.combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]});if(C.isDefinedAndNotNull(P)){P.combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});l()}N(T.value,S,P,R,V).fail(function(){U()})}};var c=function(P){t("#save-flow-version-dialog").modal("refreshButtons")};var v=function(){var P=t("#save-flow-version-process-group-id").text();var R=t("#save-flow-version-process-group-id").data("revision");var U={processGroupRevision:f.getRevision({revision:{version:R.version}})};var S=t("#save-flow-version-process-group-id").data("versionControlInformation");if(C.isDefinedAndNotNull(S)){U.versionedFlow={registryId:S.registryId,bucketId:S.bucketId,flowId:S.flowId,comments:t("#save-flow-version-change-comments").val()}}else{var Q=t("#save-flow-version-registry-combo").combo("getSelectedOption");var T=t("#save-flow-version-bucket-combo").combo("getSelectedOption");U.versionedFlow={registryId:Q.value,bucketId:T.value,flowName:t("#save-flow-version-name-field").val(),description:t("#save-flow-version-description-field").val(),comments:t("#save-flow-version-change-comments").val()}}return t.ajax({type:"POST",data:JSON.stringify(U),url:"../nifi-api/versions/process-groups/"+encodeURIComponent(P),dataType:"json",contentType:"application/json"}).fail(b.handleAjaxError)};var K=function(P,R){var Q=function(T,S){var V=C.isBlank(T[P.columnId]);var U=C.isBlank(S[P.columnId]);if(V&&U){return 0}else{if(V){return 1}else{if(U){return -1}}}return T[P.columnId]===S[P.columnId]?0:T[P.columnId]>S[P.columnId]?1:-1};R.sort(Q,P.sortAsc)};var r=function(){var U=t("#import-flow-version-table");var R=function(Z,W,Y,X,V){return C.escapeHtml(Y)};var Q=function(ac,W,ab,Y,V){var aa=new Date();var X=aa.getTimezoneOffset()*60*1000;var Z=new Date(V.timestamp+X+n);return C.formatDateTime(Z)};var P=[{id:"version",name:"Version",field:"version",formatter:R,sortable:true,resizable:true,width:75,maxWidth:75},{id:"timestamp",name:"Created",field:"timestamp",formatter:Q,sortable:true,resizable:true,width:175,maxWidth:175},{id:"changeComments",name:"Comments",field:"comments",sortable:true,resizable:true,formatter:R}];var T=new Slick.Data.DataView({inlineFilters:false});K({columnId:"version",sortAsc:false},T);var S=new Slick.Grid(U,T,P,s);S.setSelectionModel(new Slick.RowSelectionModel());S.registerPlugin(new Slick.AutoTooltips());S.setSortColumn("version",false);S.onSort.subscribe(function(W,V){K({columnId:V.sortCol.id,sortAsc:V.sortAsc},T)});S.onSelectedRowsChanged.subscribe(function(W,V){t("#import-flow-version-dialog").modal("refreshButtons")});S.onDblClick.subscribe(function(W,V){if(t("#import-flow-version-label").is(":visible")){q()}else{z().always(function(){t("#import-flow-version-dialog").modal("hide")})}});T.onRowCountChanged.subscribe(function(W,V){S.updateRowCount();S.render()});T.onRowsChanged.subscribe(function(W,V){S.invalidateRows(V.rows);S.render()});T.syncGridSelection(S,true);U.data("gridInstance",S)};var H=function(W,T,Y,Q){var X=function(){return T.val()};var S=function(){var ab=W.data("gridInstance");if(C.isDefinedAndNotNull(ab)){var ac=ab.getData();ac.setFilterArgs({searchString:X()});ac.refresh()}};var R=function(ae,ab){if(ab.searchString===""){return true}try{var ai=new RegExp(ab.searchString,"i")}catch(ag){return false}var ac=ae.componentId.search(ai)>=0;var ah=ae.differenceType.search(ai)>=0;var ad=ae.difference.search(ai)>=0;var af=false;if(C.isDefinedAndNotNull(ae.componentName)){af=ae.componentName.search(ai)>=0}return ac||af||ah||ad};T.on("keyup",function(){S()});var V=function(af,ac,ae,ad,ab){return C.escapeHtml(ae)};var aa=function(ag,ac,af,ae,ab){var ad="";if(ab.differenceType!=="Component Removed"&&C.isDefinedAndNotNull(ab.processGroupId)){ad+='<div class="pointer go-to-component fa fa-long-arrow-right" title="Go To" style="margin-top: 2px" ></div>'}return ad};var Z=[{id:"componentName",name:"Component Name",field:"componentName",formatter:V,sortable:true,resizable:true},{id:"differenceType",name:"Change Type",field:"differenceType",formatter:V,sortable:true,resizable:true},{id:"difference",name:"Difference",field:"difference",formatter:V,sortable:true,resizable:true},{id:"actions",name:"&nbsp;",formatter:aa,sortable:false,resizable:false,width:25}];var P=new Slick.Data.DataView({inlineFilters:false});P.setFilterArgs({searchString:X()});P.setFilter(R);K({columnId:"componentName",sortAsc:true},P);var U=new Slick.Grid(W,P,Z,s);U.setSelectionModel(new Slick.RowSelectionModel());U.registerPlugin(new Slick.AutoTooltips());U.setSortColumn("componentName",true);U.onSort.subscribe(function(ac,ab){K({columnId:ab.sortCol.id,sortAsc:ab.sortAsc},P)});U.onClick.subscribe(function(ae,ac){var ad=t(ae.target);var ab=P.getItem(ac.row);if(U.getColumns()[ac.cell].id==="actions"){if(ad.hasClass("go-to-component")){if(ab.componentType==="Controller Service"){x.showConfiguration(ab.processGroupId).done(function(){x.selectControllerService(ab.componentId);W.closest(".large-dialog").modal("hide")})}else{I.showComponent(ab.processGroupId,ab.componentId).done(function(){W.closest(".large-dialog").modal("hide")})}}}});P.onRowCountChanged.subscribe(function(ac,ab){U.updateRowCount();U.render();Y.text(C.formatInteger(ab.current))});P.onRowsChanged.subscribe(function(ac,ab){U.invalidateRows(ab.rows);U.render()});P.syncGridSelection(U,true);W.data("gridInstance",U);Y.text("0");Q.text("0")};var F=function(){var S=t("#new-process-group-dialog").data("pt");t("#import-flow-version-dialog").data("pt",S);var P=t("#import-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var R=t("#import-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();var Q=t("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]}).show();M(t("#import-flow-version-dialog"),P,R,Q,D,function(T){return true}).done(function(){t("#import-flow-version-dialog").modal("setHeaderText","Import Version").modal("setButtonModel",[{buttonText:"Import",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:L,handler:{click:function(){z().always(function(){t("#import-flow-version-dialog").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){t(this).modal("hide")}}}]).modal("show");t("#new-process-group-dialog").modal("hide")})};var w=function(Q,T,P){var R=t("#import-flow-version-table").data("gridInstance");var S=R.getData();S.beginUpdate();R.setSelectedRows([]);R.resetActiveCell();S.setItems([]);return t.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(Q)+"/buckets/"+encodeURIComponent(T)+"/flows/"+encodeURIComponent(P)+"/versions",dataType:"json"}).done(function(U){if(C.isDefinedAndNotNull(U.versionedFlowSnapshotMetadataSet)&&U.versionedFlowSnapshotMetadataSet.length>0){t.each(U.versionedFlowSnapshotMetadataSet,function(W,V){S.addItem(t.extend({id:V.versionedFlowSnapshotMetadata.version},V.versionedFlowSnapshotMetadata))})}else{h.showOkDialog({headerText:"Flow Versions",dialogContent:"This flow does not have any versions available."})}}).fail(b.handleAjaxError).always(function(){S.endUpdate();S.reSort();R.invalidate()})};var E=function(P,Q,R){return t.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(P)+"/buckets/"+encodeURIComponent(Q)+"/flows",dataType:"json"}).done(function(S){var T=[];if(C.isDefinedAndNotNull(S.versionedFlows)&&S.versionedFlows.length>0){S.versionedFlows.sort(function(V,U){return V.versionedFlow.flowName>U.versionedFlow.flowName});t.each(S.versionedFlows,function(V,U){var W=U.versionedFlow;T.push({text:W.flowName,value:W.flowId,description:C.escapeHtml(W.description)})})}else{T.push({text:"No available flows",value:null,optionClass:"unset",disabled:true})}t("#import-flow-version-name-combo").combo("destroy").combo({options:T,select:function(U){if(C.isDefinedAndNotNull(U.value)){R(P,Q,U.value)}else{var V=t("#import-flow-version-table").data("gridInstance");var W=V.getData();W.beginUpdate();W.setItems([]);W.endUpdate()}}})}).fail(b.handleAjaxError)};var o=function(Q,R,P){w(Q,R,P).done(function(){t("#import-flow-version-dialog").modal("refreshButtons")})};var D=function(Q){l();if(C.isDefinedAndNotNull(Q.value)){t("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});var P=t("#import-flow-version-registry-combo").combo("getSelectedOption");E(P.value,Q.value,o)}else{t("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}};var z=function(){var V=t("#import-flow-version-dialog").data("pt");var S=t("#import-flow-version-registry-combo").combo("getSelectedOption");var W=t("#import-flow-version-bucket-combo").combo("getSelectedOption");var P=t("#import-flow-version-name-combo").combo("getSelectedOption");var R=t("#import-flow-version-table").data("gridInstance");var Q=R.getSelectedRows();var U=R.getDataItem(Q[0]);var T={revision:f.getRevision({revision:{version:0}}),component:{position:{x:V.x,y:V.y},versionControlInformation:{registryId:S.value,bucketId:W.value,flowId:P.value,version:U.version}}};return t.ajax({type:"POST",data:JSON.stringify(T),url:"../nifi-api/process-groups/"+encodeURIComponent(I.getGroupId())+"/process-groups",dataType:"json",contentType:"application/json"}).done(function(X){m.add({processGroups:[X]},{selectAll:true});m.updateVisibility();d.refresh()}).fail(b.handleAjaxError)};var L=function(){var R=t("#import-flow-version-table").data("gridInstance");if(C.isDefinedAndNotNull(R)){var S=R.getSelectedRows();if(t("#import-flow-version-label").is(":visible")){if(S.length===1){var Q=R.getDataItem(S[0]);var P=parseInt(t("#import-flow-version-label").text(),10);return P===Q.version}else{return true}}else{return S.length!==1}}else{return true}};var q=function(){var aa=null;var R=null;var U=false;var Q=t("#import-flow-version-process-group-id").text();var ab=t("#import-flow-version-process-group-id").data("revision");var ac=t("#import-flow-version-process-group-id").data("versionControlInformation");var P=t("#import-flow-version-table").data("gridInstance");var Y=P.getSelectedRows();var V=P.getDataItem(Y[0]);t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){U=true;t("#change-version-status-dialog").modal("setButtonModel",[]);if(aa!==null){clearTimeout(aa);Z()}}}}]);t("#import-flow-version-dialog").modal("hide");var S=function(){var ad={processGroupRevision:f.getRevision({revision:{version:ab.version}}),versionControlInformation:{groupId:Q,registryId:ac.registryId,bucketId:ac.bucketId,flowId:ac.flowId,version:V.version}};return t.ajax({type:"POST",data:JSON.stringify(ad),url:"../nifi-api/versions/update-requests/process-groups/"+encodeURIComponent(Q),dataType:"json",contentType:"application/json"}).done(function(){g(0);t("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var W=function(){X().done(T)};var X=function(){return t.ajax({type:"GET",url:R.uri,dataType:"json"}).fail(Z).fail(b.handleAjaxError)};var Z=function(){if(U===true){t("#change-version-status-message").text("The change version request has been cancelled.");t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){t(this).modal("hide")}}}])}if(C.isDefinedAndNotNull(R)){t.ajax({type:"DELETE",url:R.uri,dataType:"json"}).done(function(ad){R=ad.request;e(Q);if(C.isDefinedAndNotNull(R.failureReason)){t("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Change Version",dialogContent:C.escapeHtml(R.failureReason)})}else{g(R.percentCompleted);t("#change-version-status-message").text("This Process Group version has changed.");t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){t(this).modal("hide")}}}])}})}};var T=function(ad){R=ad.request;if(R.complete===true||U===true){Z()}else{g(R.percentCompleted);t("#change-version-status-message").text(R.state);aa=setTimeout(function(){aa=null;W()},2000)}};S().done(T)};var A=function(P){return t.Deferred(function(Q){if(P===I.getGroupId()){t.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(P),dataType:"json"}).done(function(S){Q.resolve(S)}).fail(function(){Q.reject()})}else{var R=p.get(P);if(R.permissions.canRead===true&&R.permissions.canWrite===true){Q.resolve({processGroupRevision:R.revision,versionControlInformation:R.component.versionControlInformation})}else{Q.reject()}}}).promise()};var G=function(P,Q){if(I.getGroupId()===P){j.injector.get("breadcrumbsCtrl").updateVersionControlInformation(P,Q);j.digest()}else{p.reload(P)}};var e=function(P){if(I.getGroupId()===P){t.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(P),dataType:"json"}).done(function(R){m.set(R.processGroupFlow.flow);m.updateVisibility();var Q=j.injector.get("breadcrumbsCtrl");Q.resetBreadcrumbs();Q.generateBreadcrumbs(R.processGroupFlow.breadcrumb);j.digest()}).fail(b.handleAjaxError)}else{p.reload(P)}};var g=function(Q){var R=t("#change-version-percent-complete");R.find("div.progress-label").remove();R.find("md-progress-linear").remove();var P=t('<div class="progress-label"></div>').text(Q+"%");(j.injector.get("$compile")(t('<md-progress-linear ng-cloak ng-value="'+Q+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(j.rootScope)).appendTo(R);R.append(P)};var u=function(P,Q,W,V){var R=W.data("gridInstance");var S=R.getData();S.beginUpdate();R.setSelectedRows([]);R.resetActiveCell();S.setItems([]);var U=A(P).done(function(X){if(C.isDefinedAndNotNull(X.versionControlInformation)){var Y=X.versionControlInformation;Q.text("The following changes have been made to "+Y.flowName+" (Version "+Y.version+").")}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."})}});var T=t.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(P)+"/local-modifications",dataType:"json"}).done(function(X){if(C.isDefinedAndNotNull(X.componentDifferences)&&X.componentDifferences.length>0){var Y=0;t.each(X.componentDifferences,function(aa,Z){t.each(Z.differences,function(ab,ac){S.addItem({id:Y++,componentId:Z.componentId,componentName:Z.componentName,componentType:Z.componentType,processGroupId:Z.processGroupId,differenceType:ac.differenceType,difference:ac.difference})})});S.endUpdate();S.reSort();R.invalidate();V.text(C.formatInteger(Y))}else{h.showOkDialog({headerText:"Local Changes",dialogContent:"This Process Group does not have any local changes."})}}).fail(b.handleAjaxError);return t.when(U,T)};var i=function(P){A(P).done(function(T){if(C.isDefinedAndNotNull(T.versionControlInformation)){var Y=null;var X=null;var U=false;t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){U=true;t("#change-version-status-dialog").modal("setButtonModel",[]);if(Y!==null){clearTimeout(Y);W()}}}}]);t("#import-flow-version-dialog").modal("hide");var R=function(){var Z={processGroupRevision:f.getRevision({revision:{version:T.processGroupRevision.version}}),versionControlInformation:T.versionControlInformation};return t.ajax({type:"POST",data:JSON.stringify(Z),url:"../nifi-api/versions/revert-requests/process-groups/"+encodeURIComponent(P),dataType:"json",contentType:"application/json"}).done(function(){g(0);t("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var S=function(){V().done(Q)};var V=function(){return t.ajax({type:"GET",url:X.uri,dataType:"json"}).fail(W).fail(b.handleAjaxError)};var W=function(){if(U===true){t("#change-version-status-message").text("The revert request has been cancelled.");t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){t(this).modal("hide")}}}])}if(C.isDefinedAndNotNull(X)){t.ajax({type:"DELETE",url:X.uri,dataType:"json"}).done(function(Z){X=Z.request;e(P);if(C.isDefinedAndNotNull(X.failureReason)){t("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Revert Local Changes",dialogContent:C.escapeHtml(X.failureReason)})}else{g(X.percentCompleted);t("#change-version-status-message").text("This Process Group version has changed.");t("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){t(this).modal("hide")}}}])}})}};var Q=function(Z){X=Z.request;if(X.complete===true||U===true){W()}else{g(X.percentCompleted);t("#change-version-status-message").text(X.state);Y=setTimeout(function(){Y=null;S()},2000)}};R().done(Q)}else{h.showOkDialog({headerText:"Revert Changes",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)};return{init:function(P){n=P;t("#save-flow-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Save Flow Version",buttons:[{buttonText:"Save",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(t("#save-flow-version-registry-combo").is(":visible")){var Q=t("#save-flow-version-registry-combo").combo("getSelectedOption");var R=t("#save-flow-version-bucket-combo").combo("getSelectedOption");if(C.isDefinedAndNotNull(Q)&&C.isDefinedAndNotNull(R)){return Q.disabled===true||R.disabled===true}else{return true}}else{return false}},handler:{click:function(){var Q=t("#save-flow-version-process-group-id").text();v().done(function(R){G(Q,R.versionControlInformation)});t(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){t(this).modal("hide")}}}],handler:{close:function(){J()}}});t("#import-flow-version-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){O()}}});t("#change-version-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Change Flow Version",handler:{close:function(){t("#change-version-status-dialog").modal("setButtonModel",[])}}});t("#revert-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Revert Local Changes",buttons:[{buttonText:"Revert",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var Q=t("#revert-local-changes-process-group-id").text();i(Q);t(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){t(this).modal("hide")}}}],handler:{close:function(){B()}}});t("#show-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Show Local Changes",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){t(this).modal("hide")}}}],handler:{close:function(){a()}}});t("#import-process-group-link").on("click",function(){F()});r();H(t("#revert-local-changes-table"),t("#revert-local-changes-filter"),t("#displayed-revert-local-changes-entries"),t("#total-revert-local-changes-entries"));H(t("#show-local-changes-table"),t("#show-local-changes-filter"),t("#displayed-show-local-changes-entries"),t("#total-show-local-changes-entries"))},showFlowVersionDialog:function(P){var Q=true;return t.Deferred(function(R){A(P).done(function(S){if(C.isDefinedAndNotNull(S.versionControlInformation)){var V=S.versionControlInformation;t("#save-flow-version-registry").text(V.registryName).show();t("#save-flow-version-bucket").text(V.bucketName).show();t("#save-flow-version-label").text(V.version+1);t("#save-flow-version-name").text(V.flowName).show();C.populateField("save-flow-version-description",V.flowDescription);t("#save-flow-version-description").show();t("#save-flow-version-process-group-id").data("versionControlInformation",V);t("#save-flow-version-label").css("margin-top","-15px");Q=false;R.resolve()}else{var T=t("#save-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var U=t("#save-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();t("#save-flow-version-label").text(1);t("#save-flow-version-name-field").show();t("#save-flow-version-description-field").show();t("#save-flow-version-label").css("margin-top","0");M(t("#save-flow-version-dialog"),T,U,null,c,function(W){return W.permissions.canWrite===true}).done(function(){R.resolve()}).fail(function(){R.reject()})}t("#save-flow-version-process-group-id").data("revision",S.processGroupRevision).text(P)}).fail(b.handleAjaxError)}).done(function(){t("#save-flow-version-dialog").modal("show");if(Q){t("#save-flow-version-name-field").focus()}else{t("#save-flow-version-change-comments").focus()}}).fail(function(){t("#save-flow-version-dialog").modal("refreshButtons")}).promise()},revertLocalChanges:function(P){u(P,t("#revert-local-changes-message"),t("#revert-local-changes-table"),t("#total-revert-local-changes-entries")).done(function(){t("#revert-local-changes-process-group-id").text(P);t("#revert-local-changes-dialog").modal("show")})},showLocalChanges:function(P){u(P,t("#show-local-changes-message"),t("#show-local-changes-table"),t("#total-show-local-changes-entries")).done(function(){t("#show-local-changes-dialog").modal("show")})},showChangeFlowVersionDialog:function(P){return t.Deferred(function(Q){A(P).done(function(R){if(C.isDefinedAndNotNull(R.versionControlInformation)){var S=R.versionControlInformation;t("#import-flow-version-registry").text(S.registryName).show();t("#import-flow-version-bucket").text(S.bucketName).show();t("#import-flow-version-name").text(S.flowName).show();t("#import-flow-version-container").show();t("#import-flow-version-label").text(S.version);t("#import-flow-version-process-group-id").data("versionControlInformation",S).data("revision",R.processGroupRevision).text(P);w(S.registryId,S.bucketId,S.flowId).done(function(){Q.resolve()}).fail(function(){h.showOkDialog({headerText:"Change Version",dialogContent:"Unable to load available versions for this Process Group."});Q.reject()})}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."});Q.reject()}}).fail(b.handleAjaxError)}).done(function(){t("#import-flow-version-dialog").modal("setHeaderText","Change Version").modal("setButtonModel",[{buttonText:"Change",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:L,handler:{click:function(){q()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){t(this).modal("hide")}}}]).modal("show")}).promise()},stopVersionControl:function(P){h.showYesNoDialog({headerText:"Stop Version Control",dialogContent:"Are you sure you want to stop version control?",noText:"Cancel",yesText:"Disconnect",yesHandler:function(){t.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(P),dataType:"json"}).done(function(Q){if(C.isDefinedAndNotNull(Q.versionControlInformation)){var R=f.getRevision({revision:{version:Q.processGroupRevision.version}});t.ajax({type:"DELETE",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(P)+"?"+t.param(R),dataType:"json",contentType:"application/json"}).done(function(S){G(P,undefined);h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is no longer under version control."})}).fail(b.handleAjaxError)}else{h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.FilteredDialogCommon=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FilteredDialogCommon=b(require("jquery")))}else{nf.FilteredDialogCommon=b(a.$)}}}(this,function(a){var b={addKeydownListener:function(e,d,c){var f=[a.ui.keyCode.UP,a.ui.keyCode.PAGE_UP,a.ui.keyCode.DOWN,a.ui.keyCode.PAGE_DOWN];a(e).off("keydown").on("keydown",function(j){var i=j.keyCode?j.keyCode:j.which;if(a.inArray(i,f)===-1||j.shiftKey||j.altKey||j.ctrlKey){return}var h=d.getSelectedRows();if(h.length>0){if(i===a.ui.keyCode.PAGE_UP){d.navigatePageUp();return}if(i===a.ui.keyCode.PAGE_DOWN){d.navigatePageDown();return}var g=h[0];if(i===a.ui.keyCode.UP){g=Math.max(g-1,0)}else{g=Math.min(g+1,c.getLength()-1)}b.choseRow(d,g);d.scrollRowIntoView(g,false)}})},choseFirstRow:function(c){b.choseRow(c,0)},choseRow:function(d,c){d.setSelectedRows([c]);d.setActiveCell(c,0)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(d,x,g,s,f){var w={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api"}};var v={DURATION:function(z){return g.formatDuration(z)},COUNT:function(z){if(z%1===0){return g.formatInteger(z)}else{return g.formatFloat(z)}},DATA_SIZE:function(z){return g.formatDataSize(z)}};var m=null;var n=null;var q=null;var c=null;var j=function(B,F,D,A,E){d("#status-history-last-refreshed").text(D.generated);var z={groupId:B,id:F,type:A,instances:[]};var C=D.fieldDescriptors;z.details=D.componentDetails;z.selectedDescriptor=g.isUndefined(E)?C[0]:E;if(g.isDefinedAndNotNull(D.aggregateSnapshots)&&D.aggregateSnapshots.length>1){z.instances.push({id:w.nifiInstanceId,label:w.nifiInstanceLabel,snapshots:D.aggregateSnapshots})}else{i();return}d.each(D.nodeSnapshots,function(H,G){if(g.isDefinedAndNotNull(G.statusSnapshots)&&G.statusSnapshots.length>1){z.instances.push({id:G.nodeId,label:G.address+":"+G.apiPort,snapshots:G.statusSnapshots})}});if(z.instances.length>0){d("#status-history-dialog").data("status-history",z);r(z,C)}else{i()}};var i=function(){s.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var r=function(z,A){if(c===null){c={}}d.each(z.instances,function(C,B){B.snapshots.forEach(function(F){var E=new Date();var D=E.getTimezoneOffset()*60*1000;F.timestamp=new Date(F.timestamp+D+m)})});l(A,z.selectedDescriptor)};var l=function(B,A){var z=[];d.each(B,function(C,D){z.push({text:D.label,value:D.field,description:g.escapeHtml(D.description)})});d("#status-history-metric-combo").combo({selectedOption:{value:A.field},options:z,select:function(D){var E=null;d.each(B,function(F,G){if(D.value===G.field){E=G;return false}});if(E!==null){if(q===null||q.field!==E.field){n=null}q=E;var C=d("#status-history-dialog").data("status-history");C.selectedDescriptor=E;d("#status-history-dialog").data("status-history",C);k()}}});d("#status-history-dialog").modal("show")};var a=function(){return d("#status-history-chart-container").parent().outerHeight()-d("#status-history-chart-control-container").outerHeight()-parseInt(d("#status-history-chart-control-container").css("margin-top"),10)};var y=function(){return d("body").height()-d("#status-history-chart-control-container").outerHeight()-d("#status-history-refresh-container").outerHeight()-parseInt(d("#status-history-chart-control-container").css("margin-top"),10)-parseInt(d(".dialog-content").css("top"))-parseInt(d(".dialog-content").css("bottom"))};var u=function(){return d("body").width()-d("#status-history-details").innerWidth()-parseInt(d("#status-history-dialog").css("left"),10)-parseInt(d(".dialog-content").css("left"))-parseInt(d(".dialog-content").css("right"))};var k=function(){var ai=d("#status-history-dialog");if(ai.is(":visible")){var ab=ai.data("status-history");var ah=ab.selectedDescriptor;d("#status-history-details").empty();var C=o("Status History");x.map(ab.details).forEach(function(aw,ax){h(C,aw,ax)});var E={top:15,right:20,bottom:25,left:75};var Y=x.scale.category10();var B=[];d.each(ab.instances,function(ax,aw){B.push(aw.label)});Y.domain(B);var at=[];d.each(ab.instances,function(ax,aw){if(g.isUndefinedOrNull(c[aw.id])){c[aw.id]=true}at.push({id:aw.id,label:aw.label,values:d.map(aw.snapshots,function(ay){return{timestamp:ay.timestamp,value:ay.statusMetrics[ah.field]}}),visible:c[aw.id]===true})});var O=x.time.format.multi([[":%S.%L",function(aw){return aw.getMilliseconds()}],[":%S",function(aw){return aw.getSeconds()}],["%H:%M",function(aw){return aw.getMinutes()}],["%H:%M",function(aw){return aw.getHours()}],["%a %d",function(aw){return aw.getDay()&&aw.getDate()!==1}],["%b %d",function(aw){return aw.getDate()!==1}],["%B",function(aw){return aw.getMonth()}],["%Y",function(){return true}]]);var N=d("#status-history-chart-container").empty();if(N.hasClass("ui-resizable")){N.resizable("destroy");N.removeAttr("style")}N.height(a());var z=N.outerWidth()-E.left-E.right;var A=N.outerHeight()-E.top-E.bottom;U=d("#status-history-container").width();if(z>U){z=U}an=y();if(A>an){A=an}var af=x.time.scale().range([0,z]);var T=x.svg.axis().scale(af).ticks(5).tickFormat(O).orient("bottom");var ae=x.scale.linear().range([A,0]);var F=x.svg.axis().scale(ae).tickFormat(v[ah.formatter]).orient("left");var G=x.svg.line().interpolate("monotone").x(function(aw){return af(aw.timestamp)}).y(function(aw){return ae(aw.value)});var M=x.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",N.parent().width()).attr("height",N.innerHeight());var H=M.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",z).attr("height",A);var av=M.append("g").attr("transform","translate("+E.left+", "+E.top+")");var D=x.min(at,function(aw){return x.min(aw.values,function(ax){return ax.timestamp})});var K=x.max(at,function(aw){return x.max(aw.values,function(ax){return ax.timestamp})});h(C,"Start",g.formatDateTime(D));h(C,"End",g.formatDateTime(K));af.domain([D,K]);ae.domain([p(at),t(at)]);av.append("g").attr("class","x axis").attr("transform","translate(0, "+A+")").call(T);av.append("g").attr("class","y axis").call(F).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ah.label);var ac=av.selectAll(".status").data(at).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ac.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return G(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return aw.visible===false}).append("title").text(function(aw){return aw.label});ac.each(function(aw){var ax=x.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+aw.id}).classed("hidden",function(ay){return ay.visible===false});ax.selectAll("circle.mark").data(aw.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("fill",function(){return Y(aw.label)}).attr("r",1.5).append("title").text(function(ay){return aw.label+" -- "+v[ah.formatter](ay.value)})});M.attr("width",N.parent().width()).attr("height",N.innerHeight());H.attr("width",z).attr("height",A);av.select(".x.axis").attr("transform","translate(0, "+A+")");var S=d("#status-history-chart-control-container").empty();var Q=S.innerHeight()-E.top-E.bottom;var al=x.time.scale().range([0,z]);var J=x.svg.axis().scale(al).ticks(5).tickFormat(O).orient("bottom");var ap=x.scale.linear().range([Q,0]);var aj=x.svg.axis().scale(ap).tickValues(ae.domain()).tickFormat(v[ah.formatter]).orient("left");var P=x.svg.line().interpolate("monotone").x(function(aw){return al(aw.timestamp)}).y(function(aw){return ap(aw.value)});var ag=x.select("#status-history-chart-control-container").append("svg").attr("width",N.parent().width()).attr("height",Q+E.top+E.bottom);var W=ag.append("g").attr("transform","translate("+E.left+", "+E.top+")");var V=ae.domain();V[1]*=1.04;al.domain(af.domain());ap.domain(V);W.append("g").attr("class","x axis").attr("transform","translate(0, "+Q+")").call(J);W.append("g").attr("class","y axis").call(aj);var au=W.selectAll(".status").data(at).enter().append("g").attr("class","status");au.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return P(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return c[aw.id]===false}).append("title").text(function(aw){return aw.label});var ar=function(aw,ax){af.domain(aw);ae.domain(ax);ac.selectAll(".chart-line").attr("d",function(ay){return G(ay.values)});ac.selectAll("circle.mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("r",function(){return am.empty()?1.5:4});av.select(".x.axis").call(T);av.select(".y.axis").call(F)};var I=function(){var ax,aw;if(am.empty()){var az=d.grep(at,function(aA){return aA.visible});if(az.length===0){aw=ap.domain()}else{aw=[x.min(az,function(aA){return x.min(aA.values,function(aB){return aB.value})}),x.max(az,function(aA){return x.max(aA.values,function(aB){return aB.value})})]}ax=al.domain();n=null}else{var ay=am.extent();ax=[ay[0][0],ay[1][0]];aw=[ay[0][1],ay[1][1]];n=ay}ar(ax,aw);L()};var am=x.svg.brush().x(al).y(ap).on("brush",I);if(g.isDefinedAndNotNull(n)){am=am.extent(n)}W.append("g").attr("class","brush").call(am);W.select("rect.extent").attr("style","pointer-events: all;").on("dblclick",function(){if(!am.empty()){var aw=am.extent();var ax=ap.domain();am.extent([[aw[0][0],ax[0]],[aw[1][0],ax[1]]]);W.select(".brush").call(am);I()}});var L=function(){var aB=d.map(at,function(aH){var aF=af.domain();var aG=ae.domain();var aI=d.extend({},aH);return d.extend(aI,{values:d.grep(aH.values,function(aJ){return aJ.timestamp.getTime()>=aF[0].getTime()&&aJ.timestamp.getTime()<=aF[1].getTime()&&aJ.value>=aG[0]&&aJ.value<=aG[1]})})});var aw=d.grep(aB,function(aF){return aF.id!==w.nifiInstanceId&&aF.visible&&aF.values.length>0});var aA=aw.length===0?"NA":v[ah.formatter](p(aw));var az=aw.length===0?"NA":v[ah.formatter](e(aw));var ax=aw.length===0?"NA":v[ah.formatter](t(aw));d("#node-aggregate-statistics").text(aA+" / "+ax+" / "+az);var aD=d.grep(aB,function(aF){return aF.id===w.nifiInstanceId&&aF.visible&&aF.values.length>0});var aE=aD.length===0?"NA":v[ah.formatter](p(aD));var aC=aD.length===0?"NA":v[ah.formatter](e(aD));var ay=aD.length===0?"NA":v[ah.formatter](t(aD));d("#cluster-aggregate-statistics").text(aE+" / "+ay+" / "+aC)};var ad=d.grep(at,function(aw){return aw.id!==w.nifiInstanceId}).sort(function(ax,aw){return ax.label<aw.label?-1:ax.label>aw.label?1:0});var aq=function(ax,aw){var az=d("<div></div>").addClass("legend-label nf-checkbox-label").css("color",Y(aw.label)).text(aw.label).ellipsis();var ay=d('<div class="nf-checkbox"></div>').on("click",function(){var aA=x.selectAll("path.chart-line-"+aw.id);var aC=x.select("g.mark-group-"+aw.id);var aB=aC.classed("hidden");aA.classed("hidden",function(){return !aB});aC.classed("hidden",function(){return !aB});aw.visible=aB;c[aw.id]=aw.visible;I()}).addClass(aw.visible?"checkbox-checked":"checkbox-unchecked");d('<div class="legend-entry"></div>').append(ay).append(az).on("mouseenter",function(){x.selectAll("path.chart-line-"+aw.id).classed("over",true)}).on("mouseleave",function(){x.selectAll("path.chart-line-"+aw.id).classed("over",false)}).appendTo(ax)};var aa=d.grep(at,function(aw){return aw.id===w.nifiInstanceId});var ak=o("NiFi");h(ak,"Min / Max / Mean","","cluster-aggregate-statistics");aq(ak,aa[0]);if(ad.length>0){var Z=o("Nodes");h(Z,"Min / Max / Mean","","node-aggregate-statistics");d.each(ad,function(ax,aw){aq(Z,aw)})}I();var U,an,R,X,ao;N.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},start:function(ax,aw){if(!am.empty()){X=am.extent()}},resize:function(ay,ax){ao=d("#status-history-dialog");var aw={};if(g.isDefinedAndNotNull(ao.data("nf-dialog"))){aw=ao.data("nf-dialog")}aw["min-width"]=(ao.width()/d(window).width())*100+"%";aw["min-height"]=(ao.height()/d(window).height())*100+"%";aw.responsive["fullscreen-width"]=ao.outerWidth()+"px";aw.responsive["fullscreen-height"]=ao.outerHeight()+"px";U=u();if(ax.helper.width()>U){ax.helper.width(U);aw.responsive["fullscreen-width"]=d(window).width()+"px";aw["min-width"]="100%"}an=y();if(ax.helper.height()>an){ax.helper.height(an);aw.responsive["fullscreen-height"]=d(window).height()+"px";aw["min-height"]="100%"}R=a();if(ax.helper.height()<R){ax.helper.height(R)}aw["min-width"]=(parseInt(aw["min-width"],10)>=100)?"100%":aw["min-width"];aw["min-height"]=(parseInt(aw["min-height"],10)>=100)?"100%":aw["min-height"];ao.data("nfDialog",aw);ao.css("min-width",(N.outerWidth()+d("#status-history-details").outerWidth()+40));ao.css("min-height",(N.outerHeight()+d("#status-history-refresh-container").outerHeight()+d("#status-history-chart-control-container").outerHeight()+d(".dialog-buttons").outerHeight()+d(".dialog-header").outerHeight()+40+5));ao.center()},stop:k})}};var p=function(z){return x.min(z,function(A){return x.min(A.values,function(B){return B.value})})};var t=function(z){return x.max(z,function(A){return x.max(A.values,function(B){return B.value})})};var e=function(A){var B=0;var z=x.sum(A,function(C){B+=C.values.length;return x.sum(C.values,function(D){return D.value})});return z/B};var o=function(A){var z=d('<div class="status-history-detail"></div>').appendTo("#status-history-details");d('<div class="detail-container-label"></div>').text(A).appendTo(z);return d("<div></div>").appendTo(z)};var h=function(A,C,D,E){var B=d('<div class="detail-item"></div>').appendTo(A);d('<div class="setting-name"></div>').text(C).appendTo(B);var z=d('<div class="setting-field"></div>').text(D).appendTo(B);if(g.isDefinedAndNotNull(E)){z.attr("id",E)}};var b={init:function(z){m=z;d("#status-history-refresh-button").click(function(){var A=d("#status-history-dialog").data("status-history");if(A!==null){if(A.type===w.type.processor){b.showProcessorChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.processGroup){b.showProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.remoteProcessGroup){b.showRemoteProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{b.showConnectionChart(A.groupId,A.id,A.selectedDescriptor)}}}}});d("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){d("#status-history-dialog").removeData("status-history");d("#status-history-chart-container").empty();d("#status-history-chart-control-container").empty();d("#status-history-details").empty();n=null;q=null;c=null},open:k}});d(window).on("resize",function(A){if(A.target===window){k()}g.toggleScrollable(d("#status-history-details").get(0))})},showConnectionChart:function(z,A,B){d.ajax({type:"GET",url:w.urls.api+"/flow/connections/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(C){j(z,A,C.statusHistory,w.type.connection,B)}).fail(f.handleAjaxError)},showProcessorChart:function(z,B,A){d.ajax({type:"GET",url:w.urls.api+"/flow/processors/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(C){j(z,B,C.statusHistory,w.type.processor,A)}).fail(f.handleAjaxError)},showProcessGroupChart:function(A,z,B){d.ajax({type:"GET",url:w.urls.api+"/flow/process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){j(A,z,C.statusHistory,w.type.processGroup,B)}).fail(f.handleAjaxError)},showRemoteProcessGroupChart:function(A,z,B){d.ajax({type:"GET",url:w.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){j(A,z,C.statusHistory,w.type.remoteProcessGroup,B)}).fail(f.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils"],function(h,e,f,g,c,j,l,k,i,d){return(nf.QueueListing=b(h,e,f,g,c,j,l,k,i,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QueueListing=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils")))}else{nf.QueueListing=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils)}}}(this,function(j,g,h,i,c,l,o,n,k,f){var b={urls:{uiExtensionToken:"../nifi-api/access/ui-extension-token",downloadToken:"../nifi-api/access/download-token"}};var m=function(){j("#listing-request-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Queue Listing",handler:{close:function(){j("#listing-request-status-dialog").modal("setButtonModel",[])}}})};var e=function(){var r=j("#flowfile-uri").text()+"/content";h.getAccessToken(b.urls.downloadToken).done(function(t){var u={};if(!h.isBlank(t)){u.access_token=t}var s=j("#flowfile-cluster-node-id").text();if(!h.isBlank(s)){u.clusterNodeId=s}if(j.isEmptyObject(u)){window.open(r)}else{window.open(r+"?"+j.param(u))}}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for downloading content."})})};var p=function(){var r=j("#flowfile-uri").text()+"/content";var s=j.Deferred(function(t){if(k.hasItem("jwt")){var v=j.ajax({type:"POST",url:b.urls.uiExtensionToken});var u=j.ajax({type:"POST",url:b.urls.downloadToken});j.when(v,u).done(function(z,y){var x=z[0];var w=y[0];t.resolve(x,w)}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for viewing content."});t.reject()})}else{t.resolve("","")}}).promise();s.done(function(v,u){var x={};var t=j("#flowfile-cluster-node-id").text();if(!h.isBlank(t)){x.clusterNodeId=t}if(!h.isBlank(u)){x.access_token=u}if(j.isEmptyObject(x)===false){r=r+"?"+j.param(x)}var w=j("#nifi-content-viewer-url").text();if(w.indexOf("?")===-1){w+="?"}else{w+="&"}var y={ref:r};if(!h.isBlank(v)){y.access_token=v}window.open(w+j.param(y))})};var d=function(s){var t=4;var v=false;var u=null;var r=null;return j.Deferred(function(x){var A=function(C){var D=j("#listing-request-percent-complete");D.find("div.progress-label").remove();D.find("md-progress-linear").remove();var B=j('<div class="progress-label"></div>').text(C+"%");(l.injector.get("$compile")(j('<md-progress-linear ng-cloak ng-value="'+C+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(l.rootScope)).appendTo(D);D.append(B)};j("#listing-request-status-dialog").modal("setButtonModel",[{headerText:"Queue Listing",buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v=true;if(r!==null){clearTimeout(r);w()}}}}]);var w=function(){j("#listing-request-status-dialog").modal("hide");var D=v;if(h.isDefinedAndNotNull(u)){j.ajax({type:"DELETE",url:u.uri,dataType:"json"});if(h.isEmpty(u.flowFileSummaries)){if(v===false){D=true;i.showOkDialog({headerText:"Queue Listing",dialogContent:"The queue has no FlowFiles."})}}else{j("#total-flowfiles-count").text(h.formatInteger(u.queueSize.objectCount));j("#total-flowfiles-size").text(h.formatDataSize(u.queueSize.byteCount));j("#queue-listing-last-refreshed").text(u.lastUpdated);var C=j("#queue-listing-table");var F=j("#queue-listing-message");if(u.sourceRunning===true||u.destinationRunning===true){if(u.souceRunning===true&&u.destinationRunning===true){F.text("The source and destination of this queue are currently running. This listing may no longer be accurate.").show()}else{if(u.sourceRunning===true){F.text("The source of this queue is currently running. This listing may no longer be accurate.").show()}else{if(u.destinationRunning===true){F.text("The destination of this queue is currently running. This listing may no longer be accurate.").show()}}}}else{F.text("").hide()}var E=j("#queue-listing-table").data("gridInstance");var B=E.getData();B.beginUpdate();B.setItems(u.flowFileSummaries,"uuid");B.endUpdate()}}else{D=true}if(D){x.reject()}else{x.resolve()}};var z=function(B){A(u.percentCompleted);j("#listing-request-status-message").text(u.state);if(u.finished===true||v===true){w()}else{r=setTimeout(function(){r=null;y(Math.min(t,B*2))},B*1000)}};var y=function(B){j.ajax({type:"GET",url:u.uri,dataType:"json"}).done(function(C){u=C.listingRequest;z(B)}).fail(w).fail(n.handleAjaxError)};j.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+s.id+"/listing-requests",dataType:"json",contentType:"application/json"}).done(function(B){A(0);j("#listing-request-status-dialog").modal("show");u=B.listingRequest;z(1)}).fail(w).fail(n.handleAjaxError)}).promise()};var a=function(r){var s=function(v,w){j('<div class="flowfile-detail"></div>').append(j('<div class="detail-name"></div>').text(v)).append(j('<div class="detail-value">'+h.formatValue(w)+"</div>").ellipsis()).append(j('<div class="clear"></div>')).appendTo("#additional-flowfile-details")};var t=function(v,w){if(h.isDefinedAndNotNull(w)){v.removeClass("unset").text(w)}else{v.addClass("unset").text("No value set")}};var u={};if(h.isDefinedAndNotNull(r.clusterNodeId)){u.clusterNodeId=r.clusterNodeId}j.ajax({type:"GET",url:r.uri,data:u,dataType:"json"}).done(function(w){var y=w.flowFile;var v=h.isDefinedAndNotNull(y.contentClaimFileSize)?y.contentClaimFileSize:h.formatDataSize(0);j("#flowfile-uri").text(y.uri);j("#flowfile-uuid").html(h.formatValue(y.uuid));j("#flowfile-filename").html(h.formatValue(y.filename));j("#flowfile-queue-position").html(h.formatValue(y.position));j("#flowfile-file-size").html(h.formatValue(v));j("#flowfile-queued-duration").text(h.formatDuration(y.queuedDuration));j("#flowfile-lineage-duration").text(h.formatDuration(y.lineageDuration));j("#flowfile-penalized").text(y.penalized===true?"Yes":"No");if(h.isDefinedAndNotNull(r.clusterNodeId)){j("#flowfile-cluster-node-id").text(r.clusterNodeId);s("Node Address",r.clusterNodeAddress)}if(h.isDefinedAndNotNull(y.contentClaimContainer)){t(j("#content-container"),y.contentClaimContainer);t(j("#content-section"),y.contentClaimSection);t(j("#content-identifier"),y.contentClaimIdentifier);t(j("#content-offset"),y.contentClaimOffset);t(j("#content-bytes"),y.contentClaimFileSizeBytes);var A=j("#content-size");t(A,y.contentClaimFileSize);if(h.isDefinedAndNotNull(y.contentClaimFileSize)){A.attr("title",h.formatInteger(y.contentClaimFileSizeBytes)+" bytes")}j("#flowfile-content-details").show();j("#flowfile-with-no-content").hide()}else{j("#flowfile-content-details").hide();j("#flowfile-with-no-content").show()}var x=j("#flowfile-attributes-container");var z=Object.keys(y.attributes).sort();z.forEach(function(B){var C=y.attributes[B];var D=j('<div class="attribute-detail"></div>').append(j('<div class="attribute-name">'+h.formatValue(B)+"</div>").ellipsis()).appendTo(x);D.append(j('<div class="attribute-value">'+h.formatValue(C)+"</div>").ellipsis()).append('<div class="clear"></div>')});j("#flowfile-details-dialog").modal("show")}).fail(n.handleAjaxError)};var q={init:function(){m();j("#queue-listing-refresh-button").click(function(){var A=j("#queue-listing-table").data("connection");d(A)});var z=function(E,B,D,C,A){return'<div class="pointer show-flowfile-details fa fa-info-circle" title="View Details" style="margin-top: 5px; float: left;"></div>'};var t=function(E,B,D,C,A){return h.formatDataSize(D)};var r=function(E,B,D,C,A){return h.formatDuration(D)};var v=function(F,B,E,D,A){var C="";if(E===true){C+="Yes"}return C};var w=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:z,width:50,maxWidth:50},{id:"position",name:"Position",field:"position",sortable:false,resizable:false,width:75,maxWidth:75,formatter:h.genericValueFormatter},{id:"uuid",name:"UUID",field:"uuid",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"filename",name:"Filename",field:"filename",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"size",name:"File Size",field:"size",sortable:false,resizable:true,defaultSortAsc:false,formatter:t},{id:"queuedDuration",name:"Queued Duration",field:"queuedDuration",sortable:false,resizable:true,formatter:r},{id:"lineageDuration",name:"Lineage Duration",field:"lineageDuration",sortable:false,resizable:true,formatter:r},{id:"penalized",name:"Penalized",field:"penalized",sortable:false,resizable:false,width:100,maxWidth:100,formatter:v}];if(o.isClustered()){w.push({id:"clusterNodeAddress",name:"Node",field:"clusterNodeAddress",sortable:false,resizable:true,formatter:h.genericValueFormatter})}if(h.canAccessProvenance()){var y=function(){return'<div title="Provenance" class="pointer icon icon-provenance view-provenance"></div>'};w.push({id:"actions",name:"&nbsp;",resizable:false,formatter:y,sortable:false,width:50,maxWidth:50})}var u={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var s=new g.Data.DataView({inlineFilters:false});s.setItems([]);var x=new g.Grid("#queue-listing-table",s,w,u);x.setSelectionModel(new g.RowSelectionModel());x.registerPlugin(new g.AutoTooltips());x.onClick.subscribe(function(D,A){var C=j(D.target);var B=s.getItem(A.row);if(x.getColumns()[A.cell].id==="moreDetails"){if(C.hasClass("show-flowfile-details")){a(B)}}else{if(x.getColumns()[A.cell].id==="actions"){if(C.hasClass("view-provenance")){j("#shell-close-button").click();c.showPage("provenance?"+j.param({flowFileUuid:B.uuid}))}}}});s.onRowCountChanged.subscribe(function(B,A){x.updateRowCount();x.render();j("#displayed-flowfiles").text(A.current)});s.onRowsChanged.subscribe(function(B,A){x.invalidateRows(A.rows);x.render()});j("#queue-listing-table").data("gridInstance",x);j("#displayed-flowfiles").text("0")},initFlowFileDetailsDialog:function(){j("#content-download").on("click",e);if(h.isContentViewConfigured()){j("#content-view").show();j("#content-view").on("click",p)}j("#flowfile-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"flowfile-details-tab-content"},{name:"Attributes",tabContentId:"flowfile-attributes-tab-content"}]});j("#flowfile-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"FlowFile",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){j("#flowfile-details-dialog").modal("hide")}}}],handler:{close:function(){j("#flowfile-attributes-container").empty();j("#flowfile-cluster-node-id").text("");j("#additional-flowfile-details").empty()},open:function(){h.toggleScrollable(j("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},resetTableSize:function(){var r=j("#queue-listing-table").data("gridInstance");if(h.isDefinedAndNotNull(r)){r.resizeCanvas()}},listQueue:function(r){d(r).done(function(){var s="";if(r.permissions.canRead){s=f.formatConnectionName(r.component)}if(s===""){s="Connection"}j("#queue-listing-header-text").text(s);c.showContent("#queue-listing-container").done(function(){j("#queue-listing-table").removeData("connection");var u=j("#queue-listing-table").data("gridInstance");var t=u.getData();t.beginUpdate();t.setItems([],"uuid");t.endUpdate();j("#displayed-flowfiles, #total-flowfiles-count").text("0");j("#total-flowfiles-size").text(h.formatDataSize(0))});q.resetTableSize();j("#queue-listing-table").data("connection",r)})}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Dialog","nf.Shell"],function(h,d,j,e,k,f,i,g,c){return(nf.PolicyManagement=b(h,d,j,e,k,f,i,g,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PolicyManagement=b(require("jquery"),require("Slick"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Dialog"),require("nf.Shell")))}else{nf.PolicyManagement=b(a.$,a.Slick,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Dialog,a.nf.Shell)}}}(this,function(w,a,e,F,g,I,o,h,E){var A={urls:{api:"../nifi-api",searchTenants:"../nifi-api/tenants/search-results"}};var i=false;var s=function(){w("#new-policy-user-button").on("click",function(){w("#search-users-dialog").modal("show");w("#search-users-field").focus()});w("#delete-policy-button").on("click",function(){v()});w("#search-users-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Users/Groups",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var L=w("#policy-table").data("gridInstance");var K=L.getData();K.beginUpdate();w.each(f(w("#allowed-users")),function(N,M){K.addItem(M)});w.each(f(w("#allowed-groups")),function(M,N){K.addItem(N)});K.endUpdate();G();w("#search-users-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w("#search-users-dialog").modal("hide")}}}],handler:{close:function(){w("#search-users-field").userSearchAutocomplete("reset").val("");w("#allowed-users, #allowed-groups").empty()}}});w(document).on("click","div.remove-allowed-entity",function(){w(this).closest("li").remove()});w.widget("nf.userSearchAutocomplete",w.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(L){var K=[];K.push(L);return K},_renderMenu:function(N,L){var P=L[0];var M=H();var O=n();var K=this;w.each(P.userGroups,function(Q,R){if(w.inArray(R.id,M)===-1){K._renderGroup(N,w.extend({type:"group"},R))}});w.each(P.users,function(Q,R){if(w.inArray(R.id,O)===-1){K._renderUser(N,w.extend({type:"user"},R))}});if(N.children().length===0){N.append('<li class="unset search-no-matches">No users matched the search terms</li>')}},_resizeMenu:function(){var K=this.menu.element;K.width(w("#search-users-field").outerWidth()-2)},_renderUser:function(M,L){var K=w("<a></a>").text(L.component.identity);return w("<li></li>").data("ui-autocomplete-item",L).append(K).appendTo(M)},_renderGroup:function(L,K){var N=w("<span></span>").text(K.component.identity);var M=w("<a></a>").append('<div class="fa fa-users" style="margin-right: 5px;"></div>').append(N);return w("<li></li>").data("ui-autocomplete-item",K).append(M).appendTo(L)}});w("#search-users-field").userSearchAutocomplete({minLength:0,appendTo:"#search-users-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(L,K){w.ajax({type:"GET",data:{q:L.term},dataType:"json",url:A.urls.searchTenants}).done(function(M){K(M)})},select:function(K,L){x(L.item);w(this).val("");return false}})};var H=function(){var N=w("#policy-table").data("gridInstance");var M=N.getData();var L=[];var K=M.getItems();w.each(K,function(O,P){if(P.type==="group"){L.push(P.id)}});w.each(f(w("#allowed-groups")),function(O,P){L.push(P.id)});return L};var f=function(K){var L=[];K.children("li").each(function(N,M){var O=w(M).data("tenant");if(F.isDefinedAndNotNull(O)){L.push(O)}});return L};var n=function(){var N=w("#policy-table").data("gridInstance");var L=N.getData();var M=[];var K=L.getItems();w.each(K,function(O,P){if(P.type==="user"){M.push(P.id)}});w.each(f(w("#allowed-users")),function(P,O){M.push(O.id)});return M};var x=function(K){var M=K.type==="user"?w("#allowed-users"):w("#allowed-groups");var N=w("<span></span>").addClass("allowed-entity ellipsis").text(K.component.identity).ellipsis();var L=w("<div></div>").addClass("remove-allowed-entity fa fa-trash");w("<li></li>").data("tenant",K).append(N).append(L).appendTo(M)};var c=function(K){return K==="controller"||K==="counters"||K==="policies"||K==="tenants"};var l=function(K){return K==="proxy"||K==="restricted-components"};var y=function(){w("#override-policy-dialog").modal({headerText:"Override Policy",buttons:[{buttonText:"Override",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){j(w("#copy-policy-radio-button").is(":checked"));w(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w(this).modal("hide")}}}],handler:{close:function(){w("#copy-policy-radio-button").prop("checked",true)}}});w("#create-policy-link, #add-local-admin-link").on("click",function(){j(false)});w("#override-policy-link").on("click",function(){w("#override-policy-dialog").modal("show")});w("#policy-type-list").combo({options:[F.getPolicyTypeListing("flow"),F.getPolicyTypeListing("controller"),F.getPolicyTypeListing("provenance"),F.getPolicyTypeListing("restricted-components"),F.getPolicyTypeListing("policies"),F.getPolicyTypeListing("tenants"),F.getPolicyTypeListing("site-to-site"),F.getPolicyTypeListing("system"),F.getPolicyTypeListing("proxy"),F.getPolicyTypeListing("counters")],select:function(Q){if(i){w("#selected-policy-type").text(Q.value);if(c(Q.value)){w("#controller-policy-target").combo("setSelectedOption",{value:"read"}).show()}else{w("#controller-policy-target").hide();if(l(Q.value)){w("#selected-policy-action").text("write")}else{w("#selected-policy-action").text("read")}b()}}}});w("#controller-policy-target").combo({options:[{text:"view",value:"read"},{text:"modify",value:"write"}],select:function(Q){if(i){w("#selected-policy-action").text(Q.value);b()}}});w("#component-policy-target").combo({options:[{text:"view the component",value:"read-component",description:"Allows users to view component configuration details"},{text:"modify the component",value:"write-component",description:"Allows users to modify component configuration details"},{text:"view the data",value:"read-data",description:"Allows users to view metadata and content for this component through provenance data and flowfile queues in outbound connections"},{text:"modify the data",value:"write-data",description:"Allows users to empty flowfile queues in outbound connections and submit replays"},{text:"receive data via site-to-site",value:"write-receive-data",description:"Allows this port to receive data from these NiFi instances",disabled:true},{text:"send data via site-to-site",value:"write-send-data",description:"Allows this port to send data to these NiFi instances",disabled:true},{text:"view the policies",value:"read-policies",description:"Allows users to view the list of users who can view/modify this component"},{text:"modify the policies",value:"write-policies",description:"Allows users to modify the list of users who can view/modify this component"}],select:function(Q){if(i){var R=w("#selected-policy-component-type").text();if(Q.value==="read-component"){w("#selected-policy-action").text("read")}else{if(Q.value==="write-component"){w("#selected-policy-action").text("write")}else{if(Q.value==="read-data"){w("#selected-policy-action").text("read");R=("data/"+R)}else{if(Q.value==="write-data"){w("#selected-policy-action").text("write");R=("data/"+R)}else{if(Q.value==="read-policies"){w("#selected-policy-action").text("read");R=("policies/"+R)}else{if(Q.value==="write-policies"){w("#selected-policy-action").text("write");R=("policies/"+R)}else{if(Q.value==="write-receive-data"){w("#selected-policy-action").text("write");R="data-transfer/input-ports"}else{if(Q.value==="write-send-data"){w("#selected-policy-action").text("write");R="data-transfer/output-ports"}}}}}}}}w("#selected-policy-type").text(R);b()}}});var K=function(V,R,U,T,Q){var S="";if(Q.type==="group"){S+='<div class="fa fa-users" style="margin-right: 5px;"></div>'}S+=F.escapeHtml(Q.component.identity);return S};var O=function(X,S,W,U,R){var T="";var Q=w("#policy-table").data("policy");var V=w("#delete-policy-button").is(":disabled")===false;if(Q.permissions.canWrite===true&&V){T+='<div title="Remove" class="pointer delete-user fa fa-trash"></div>'}return T};var N=[{id:"identity",name:"User",sortable:true,resizable:true,formatter:K}];if(I.isConfigurableAuthorizer()){N.push({id:"actions",name:"&nbsp;",sortable:false,resizable:false,formatter:O,width:100,maxWidth:100})}var M={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false};var L=new a.Data.DataView({inlineFilters:false});L.setItems([]);J({columnId:"identity",sortAsc:true},L);var P=new a.Grid("#policy-table",L,N,M);P.setSelectionModel(new a.RowSelectionModel());P.registerPlugin(new a.AutoTooltips());P.setSortColumn("identity",true);P.onSort.subscribe(function(R,Q){J({columnId:Q.sortCol.id,sortAsc:Q.sortAsc},L)});P.onClick.subscribe(function(T,Q){var S=w(T.target);var R=L.getItem(Q.row);if(P.getColumns()[Q.cell].id==="actions"){if(S.hasClass("delete-user")){D(R)}}});L.onRowCountChanged.subscribe(function(R,Q){P.updateRowCount();P.render();w("#displayed-policy-users").text(Q.current)});L.onRowsChanged.subscribe(function(R,Q){P.invalidateRows(Q.rows);P.render()});w("#policy-table").data("gridInstance",P);w("#displayed-policy-users").text("0")};var J=function(K,M){var L=function(P,N){if(P.permissions.canRead&&N.permissions.canRead){var O=F.isDefinedAndNotNull(P.component[K.columnId])?P.component[K.columnId]:"";var Q=F.isDefinedAndNotNull(N.component[K.columnId])?N.component[K.columnId]:"";return O===Q?0:O>Q?1:-1}else{if(!P.permissions.canRead&&!N.permissions.canRead){return 0}if(P.permissions.canRead){return 1}else{return -1}}};M.sort(L,K.sortAsc)};var D=function(K){h.showYesNoDialog({headerText:"Update Policy",dialogContent:"Remove '"+F.escapeHtml(K.component.identity)+"' from this policy?",yesHandler:function(){p(K)}})};var p=function(L){var M=w("#policy-table").data("gridInstance");var K=M.getData();K.beginUpdate();K.deleteItem(L.id);K.endUpdate();G()};var v=function(){h.showYesNoDialog({headerText:"Delete Policy",dialogContent:"By deleting this policy, the permissions for this component will revert to the inherited policy if applicable.",yesText:"Delete",noText:"Cancel",yesHandler:function(){k()}})};var k=function(){var K=w("#policy-table").data("policy");if(F.isDefinedAndNotNull(K)){w.ajax({type:"DELETE",url:K.uri+"?"+w.param(g.getRevision(K)),dataType:"json"}).done(function(){b()}).fail(function(N,L,M){e.handleAjaxError(N,L,M);r();b()})}else{h.showOkDialog({headerText:"Delete Policy",dialogContent:"No policy selected"})}};var m=function(){var K=w("#selected-policy-component-id").text();var L=w("#selected-policy-type").text();if(K!==""){L+=("/"+K)}return{action:w("#selected-policy-action").text(),resource:"/"+L}};var B=function(O,M){var N=w("#policy-table").data("gridInstance");var L=N.getData();L.beginUpdate();var K=[];w.each(O,function(Q,P){K.push(w.extend({type:"user"},P))});w.each(M,function(P,Q){K.push(w.extend({type:"group"},Q))});L.setItems(K);L.endUpdate();L.reSort();N.invalidate();N.getSelectionModel().setSelectedRows([])};var q=function(N){if(N==="/policies"){return w("<span>Showing effective policy inherited from all policies.</span>")}else{if(N==="/controller"){return w("<span>Showing effective policy inherited from the controller.</span>")}else{var K=F.substringAfterLast(N,"/");var M=K;var L=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();w.each(L,function(O,P){if(P.id===K){M=P.label;return false}});return w("<span>Showing effective policy inherited from Process Group </span>").append(w('<span class="link ellipsis" style="max-width: 200px; vertical-align: top;"></span>').text(M).attr("title",M).on("click",function(){w("#shell-close-button").click();I.getComponentByType("ProcessGroup").enterGroup(K).done(function(){I.getSelection().classed("selected",false);o.digest()})})).append("<span>.</span>")}}};var t=function(L){var M=L.component;var K=m();d();w("#policy-table").data("policy",L);if(K.resource===M.resource){if(I.isConfigurableAuthorizer()){w("#delete-policy-button").prop("disabled",M.configurable===false||L.permissions.canWrite===false);w("#new-policy-user-button").prop("disabled",M.configurable===false||L.permissions.canWrite===false)}}else{w("#policy-message").append(q(M.resource));if(I.isConfigurableAuthorizer()){w("#override-policy-message").show();w("#delete-policy-button").prop("disabled",true);w("#new-policy-user-button").prop("disabled",true)}}B(M.users,M.userGroups)};var b=function(){var K=m();var L;if(K.resource.startsWith("/policies")){w("#admin-policy-message").show();L=w.Deferred(function(M){w.ajax({type:"GET",url:"../nifi-api/policies/"+K.action+K.resource,dataType:"json"}).done(function(N){w("#policy-last-refreshed").text(N.generated);if(N.permissions.canRead===true){var O=N.component;if(K.resource===O.resource){t(N)}else{r();w("#policy-message").text("No component specific administrators.");if(I.isConfigurableAuthorizer()){w("#add-local-admin-message").show()}}}else{r();w("#policy-message").text("No component specific administrators.");if(I.isConfigurableAuthorizer()){w("#add-local-admin-message").show()}}M.resolve()}).fail(function(P,N,O){if(P.status===404){r();w("#policy-message").text("No component specific administrators.");if(I.isConfigurableAuthorizer()){w("#add-local-admin-message").show()}M.resolve()}else{if(P.status===403){r();w("#policy-message").text("Not authorized to access the policy for the specified resource.");M.resolve()}else{r();M.reject();e.handleAjaxError(P,N,O)}}})}).promise()}else{w("#admin-policy-message").hide();L=w.Deferred(function(M){w.ajax({type:"GET",url:"../nifi-api/policies/"+K.action+K.resource,dataType:"json"}).done(function(N){w("#policy-last-refreshed").text(N.generated);if(N.permissions.canRead===true){t(N)}else{r();w("#policy-message").text("Not authorized to view the policy.");if(I.isConfigurableAuthorizer()){w("#override-policy-message").show()}}M.resolve()}).fail(function(P,N,O){if(P.status===404){r();w("#policy-message").text("No policy for the specified resource.");if(I.isConfigurableAuthorizer()){w("#new-policy-message").show()}M.resolve()}else{if(P.status===403){r();w("#policy-message").text("Not authorized to access the policy for the specified resource.");M.resolve()}else{r();M.reject();e.handleAjaxError(P,N,O)}}})}).promise()}return L};var j=function(P){var O=m();var R=[];var N=[];if(P===true){var Q=w("#policy-table").data("gridInstance");var M=Q.getData();var L=M.getItems();w.each(L,function(T,U){var S=w.extend({},U);if(S.type==="user"){R.push(S)}else{N.push(S)}delete S.type})}var K={revision:g.getRevision({revision:{version:0}}),component:{action:O.action,resource:O.resource,users:R,userGroups:N}};w.ajax({type:"POST",url:"../nifi-api/policies",data:JSON.stringify(K),dataType:"json",contentType:"application/json"}).done(function(S){if(S.permissions.canRead===true){t(S)}else{r();b()}}).fail(e.handleAjaxError)};var G=function(){var Q=w("#policy-table").data("gridInstance");var O=Q.getData();var P=[];var N=[];var M=O.getItems();w.each(M,function(S,T){var R=w.extend({},T);if(R.type==="user"){P.push(R)}else{N.push(R)}delete R.type});var K=w("#policy-table").data("policy");if(F.isDefinedAndNotNull(K)){var L={revision:g.getRevision(K),component:{id:K.id,users:P,userGroups:N}};w.ajax({type:"PUT",url:K.uri,data:JSON.stringify(L),dataType:"json",contentType:"application/json"}).done(function(R){if(R.permissions.canRead===true){t(R)}else{r();b()}}).fail(function(T,R,S){e.handleAjaxError(T,R,S);r();b()}).always(function(){I.reload({transition:true})})}else{h.showOkDialog({headerText:"Update Policy",dialogContent:"No policy selected"})}};var z=function(){E.showContent("#policy-management").always(function(){C()});u.resetTableSize()};var d=function(){w("#policy-message").text("").empty();if(I.isConfigurableAuthorizer()){w("#new-policy-message").hide();w("#override-policy-message").hide();w("#add-local-admin-message").hide()}};var r=function(){d();if(I.isConfigurableAuthorizer()){w("#delete-policy-button").prop("disabled",true);w("#new-policy-user-button").prop("disabled",true)}w("#policy-table").removeData("policy");B([],[])};var C=function(){r();w("#selected-policy-type").text("");w("#selected-policy-action").text("");w("#selected-policy-component-id").text("");w("#selected-policy-component-type").text("");w("div.policy-selected-component-container").hide()};var u={init:function(){s();y();if(I.isConfigurableAuthorizer()){w("#delete-policy-button").show();w("#new-policy-user-button").show()}w("#policy-refresh-button").on("click",function(){b()});r();i=true},resetTableSize:function(){var K=w("#policy-table");if(K.is(":visible")){var L=K.data("gridInstance");if(F.isDefinedAndNotNull(L)){L.resizeCanvas()}}},showControllerServicePolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-controller-service-container div.policy-selected-component-name").text(K.component.name)}else{w("#policy-selected-controller-service-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-controller-service-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("controller-services");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showReportingTaskPolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-reporting-task-container div.policy-selected-component-name").text(K.component.name)}else{w("#policy-selected-reporting-task-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-reporting-task-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("reporting-tasks");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showTemplatePolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-template-container div.policy-selected-component-name").text(K.template.name)}else{w("#policy-selected-template-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-template-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("templates");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showComponentPolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();w("#policy-selected-component-container").show();var L;if(K.empty()){w("#selected-policy-component-id").text(I.getGroupId());L="process-groups";w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},true).combo("setOptionEnabled",{value:"write-data"},true)}else{var M=K.datum();w("#selected-policy-component-id").text(M.id);if(I.isProcessor(K)){L="processors"}else{if(I.isProcessGroup(K)){L="process-groups"}else{if(I.isInputPort(K)){L="input-ports"}else{if(I.isOutputPort(K)){L="output-ports"}else{if(I.isRemoteProcessGroup(K)){L="remote-process-groups"}else{if(I.isLabel(K)){L="labels"}else{if(I.isFunnel(K)){L="funnels"}}}}}}}w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},I.isInputPort(K)&&I.getParentGroupId()===null).combo("setOptionEnabled",{value:"write-send-data"},I.isOutputPort(K)&&I.getParentGroupId()===null).combo("setOptionEnabled",{value:"read-data"},!I.isLabel(K)).combo("setOptionEnabled",{value:"write-data"},!I.isLabel(K))}w("#selected-policy-component-type").text(L);w("#component-policy-target").combo("setSelectedOption",{value:"read-component"});return b().always(z)},showGlobalPolicies:function(){d();w("#component-policy-controls").hide();w("#global-policy-controls").show();var K=w("#policy-type-list").combo("getSelectedOption").value;w("#selected-policy-type").text(K);if(c(K)){w("#selected-policy-action").text(w("#controller-policy-target").combo("getSelectedOption").value)}else{if(l(K)){w("#selected-policy-action").text("write")}else{w("#selected-policy-action").text("read")}}return b().always(z)}};return u}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler","nf.Clipboard","nf.Snippet","nf.GoTo","nf.ng.Bridge","nf.Shell","nf.VariableRegistry","nf.ComponentState","nf.FlowVersion","nf.Draggable","nf.Birdseye","nf.Connection","nf.Graph","nf.ProcessGroupConfiguration","nf.ProcessorConfiguration","nf.ProcessorDetails","nf.LabelConfiguration","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupDetails","nf.PortConfiguration","nf.PortDetails","nf.ConnectionConfiguration","nf.ConnectionDetails","nf.PolicyManagement","nf.RemoteProcessGroup","nf.Label","nf.Processor","nf.RemoteProcessGroupPorts","nf.ComponentVersion","nf.QueueListing","nf.StatusHistory"],function(B,G,K,F,l,j,f,x,L,h,m,E,k,g,t,v,i,M,p,D,J,e,y,A,I,C,q,n,o,w,c,u,r,d,s,z,H){return(nf.Actions=b(B,G,K,F,l,j,f,x,L,h,m,E,k,g,t,v,i,M,p,D,J,e,y,A,I,C,q,n,o,w,c,u,r,d,s,z,H))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Actions=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.Clipboard"),require("nf.Snippet"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.Shell"),require("nf.VariableRegistry"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.Draggable"),require("nf.Birdseye"),require("nf.Connection"),require("nf.Graph"),require("nf.ProcessGroupConfiguration"),require("nf.ProcessorConfiguration"),require("nf.ProcessorDetails"),require("nf.LabelConfiguration"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupDetails"),require("nf.PortConfiguration"),require("nf.PortDetails"),require("nf.ConnectionConfiguration"),require("nf.ConnectionDetails"),require("nf.PolicyManagement"),require("nf.RemoteProcessGroup"),require("nf.Label"),require("nf.Processor"),require("nf.RemoteProcessGroupPorts"),require("nf.ComponentVersion"),require("nf.QueueListing"),require("nf.StatusHistory")))}else{nf.Actions=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler,a.nf.Clipboard,a.nf.Snippet,a.nf.GoTo,a.nf.ng.Bridge,a.nf.Shell,a.nf.VariableRegistry,a.nf.ComponentState,a.nf.FlowVersion,a.nf.Draggable,a.nf.Birdseye,a.nf.Connection,a.nf.Graph,a.nf.ProcessGroupConfiguration,a.nf.ProcessorConfiguration,a.nf.ProcessorDetails,a.nf.LabelConfiguration,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupDetails,a.nf.PortConfiguration,a.nf.PortDetails,a.nf.ConnectionConfiguration,a.nf.ConnectionDetails,a.nf.PolicyManagement,a.nf.RemoteProcessGroup,a.nf.Label,a.nf.Processor,a.nf.RemoteProcessGroupPorts,a.nf.ComponentVersion,a.nf.QueueListing,a.nf.StatusHistory)}}}(this,function(E,K,O,J,m,k,f,A,P,h,o,I,l,g,v,x,i,Q,r,G,N,c,B,D,M,F,s,p,q,z,a,w,t,b,u,C,L){var H={urls:{api:"../nifi-api",controller:"../nifi-api/controller"}};var e=function(){E("#drop-request-status-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){E("#drop-request-status-dialog").modal("setButtonModel",[])}}})};var n=function(S,R){return E.ajax({type:"PUT",url:S,data:JSON.stringify(R),dataType:"json",contentType:"application/json"}).fail(function(V,T,U){m.showOkDialog({headerText:"Update Resource",dialogContent:J.escapeHtml(V.responseText)})})};var j=function(R){E.ajax({type:"GET",url:H.urls.api+"/flow/process-groups/"+encodeURIComponent(R.id),dataType:"json"}).done(function(S){r.set(S.processGroupFlow.flow)})};var d=function(R,S){return S.filter(function(T){return O.getConnectionSourceComponentId(R)===T.id}).size()>0};var y={init:function(){e()},enterGroup:function(R){if(R.size()===1&&O.isProcessGroup(R)){var S=R.datum();O.getComponentByType("ProcessGroup").enterGroup(S.id)}},leaveGroup:function(){O.getComponentByType("ProcessGroup").enterGroup(O.getParentGroupId())},refreshRemoteFlow:function(S){if(S.size()===1&&O.isRemoteProcessGroup(S)){var V=S.datum();var W=V.component.flowRefreshed;var R=function(X){V.component.flowRefreshed=X;if(S.classed("visible")){S.select("text.remote-process-group-last-refresh").text(function(){return X})}};var U=function(X){E.ajax({type:"GET",url:V.uri,dataType:"json"}).done(function(Y){var aa=Y.component;if(W===aa.flowRefreshed){T(X)}else{a.set(Y);var Z=Q.getComponentConnections(aa.id);E.each(Z,function(ac,ab){if(ab.permissions.canRead){Q.reload(ab.id)}})}})};var T=function(X){if(X<=32){setTimeout(function(){U(X*2)},X*1000)}else{R(W)}};R("Refreshing...");U(1)}},openUri:function(R){if(R.size()===1&&O.isRemoteProcessGroup(R)){var T=R.datum();var S=T.component.targetUri;if(!J.isBlank(S)){window.open(encodeURI(S))}else{m.showOkDialog({headerText:"Remote Process Group",dialogContent:"No target URI defined."})}}},showSource:function(R){if(R.size()===1&&O.isConnection(R)){var T=R.datum();if(T.sourceGroupId===O.getGroupId()){var S=K.select("#id-"+T.sourceId);y.show(S)}else{if(T.sourceType==="REMOTE_OUTPUT_PORT"){var U=K.select("#id-"+T.sourceGroupId);y.show(U)}else{O.showComponent(T.sourceGroupId,T.sourceId)}}}},showDestination:function(T){if(T.size()===1&&O.isConnection(T)){var U=T.datum();if(U.destinationGroupId===O.getGroupId()){var R=K.select("#id-"+U.destinationId);y.show(R)}else{if(U.destinationType==="REMOTE_INPUT_PORT"){var S=K.select("#id-"+U.destinationGroupId);y.show(S)}else{O.showComponent(U.destinationGroupId,U.destinationId)}}}},showDownstream:function(R){if(R.size()===1&&!O.isConnection(R)){if(O.isProcessor(R)){h.showDownstreamFromProcessor(R)}else{if(O.isFunnel(R)){h.showDownstreamFromFunnel(R)}else{if(O.isInputPort(R)){h.showDownstreamFromInputPort(R)}else{if(O.isOutputPort(R)){h.showDownstreamFromOutputPort(R)}else{if(O.isProcessGroup(R)||O.isRemoteProcessGroup(R)){h.showDownstreamFromGroup(R)}}}}}}},showUpstream:function(R){if(R.size()===1&&!O.isConnection(R)){if(O.isProcessor(R)){h.showUpstreamFromProcessor(R)}else{if(O.isFunnel(R)){h.showUpstreamFromFunnel(R)}else{if(O.isInputPort(R)){h.showUpstreamFromInputPort(R)}else{if(O.isOutputPort(R)){h.showUpstreamFromOutputPort(R)}else{if(O.isProcessGroup(R)||O.isRemoteProcessGroup(R)){h.showUpstreamFromGroup(R)}}}}}}},show:function(R){var S=O.getSelection();S.classed("selected",false);R.classed("selected",true);if(R.size()===1){y.center(R)}else{o.injector.get("navigateCtrl").zoomFit()}O.setURLParameters(O.getGroupId(),R);o.digest()},select:function(R){R.classed("selected",true)},selectAll:function(){y.select(K.selectAll("g.component, g.connection"))},center:function(T){if(T.size()===1){var U;if(O.isConnection(T)){var R,Y;var X=T.datum();if(X.bends.length>0){var S=Math.min(Math.max(0,X.labelIndex),X.bends.length-1);R=X.bends[S].x;Y=X.bends[S].y}else{R=(X.start.x+X.end.x)/2;Y=(X.start.y+X.end.y)/2}U={x:R,y:Y,width:1,height:1}}else{var V=T.datum();var W=V.position;U={x:W.x,y:W.y,width:V.dimensions.width,height:V.dimensions.height}}O.centerBoundingBox(U);O.refreshCanvasView({transition:true})}},enable:function(R){var T=O.filterEnable(R);if(T.empty()){m.showOkDialog({headerText:"Enable Components",dialogContent:"No eligible components are selected. Please select the components to be enabled and ensure they are no longer running."})}else{var S=[];T.each(function(W){var V=K.select(this);var U={revision:k.getRevision(W),component:{id:W.id,state:"STOPPED"}};S.push(n(W.uri,U).done(function(X){O.getComponentByType(W.type).set(X)}))});if(S.length>0){E.when.apply(window,S).always(function(){o.digest()})}}},disable:function(S){var R=O.filterDisable(S);if(R.empty()){m.showOkDialog({headerText:"Disable Components",dialogContent:"No eligible components are selected. Please select the components to be disabled and ensure they are no longer running."})}else{var T=[];R.each(function(W){var V=K.select(this);var U={revision:k.getRevision(W),component:{id:W.id,state:"DISABLED"}};T.push(n(W.uri,U).done(function(X){O.getComponentByType(W.type).set(X)}))});if(T.length>0){E.when.apply(window,T).always(function(){o.digest()})}}},openProvenance:function(R){if(R.size()===1){var S=R.datum();I.showPage("provenance?"+E.param({componentId:S.id}))}},start:function(T){if(T.empty()){var R={id:O.getGroupId(),state:"RUNNING"};n(H.urls.api+"/flow/process-groups/"+encodeURIComponent(O.getGroupId()),R).done(j)}else{var U=T.filter(function(V){return O.isRunnable(K.select(this))});if(U.empty()){m.showOkDialog({headerText:"Start Components",dialogContent:"No eligible components are selected. Please select the components to be started and ensure they are no longer running."})}else{var S=[];U.each(function(Y){var W=K.select(this);var X,V;if(O.isProcessGroup(W)){X=H.urls.api+"/flow/process-groups/"+encodeURIComponent(Y.id);V={id:Y.id,state:"RUNNING"}}else{X=Y.uri;V={revision:k.getRevision(Y),component:{id:Y.id,state:"RUNNING"}}}S.push(n(X,V).done(function(Z){if(O.isProcessGroup(W)){O.getComponentByType("ProcessGroup").reload(Y.id)}else{O.getComponentByType(Y.type).set(Z)}}))});if(S.length>0){E.when.apply(window,S).always(function(){o.digest()})}}}},stop:function(S){if(S.empty()){var R={id:O.getGroupId(),state:"STOPPED"};n(H.urls.api+"/flow/process-groups/"+encodeURIComponent(O.getGroupId()),R).done(j)}else{var U=S.filter(function(V){return O.isStoppable(K.select(this))});if(U.empty()){m.showOkDialog({headerText:"Stop Components",dialogContent:"No eligible components are selected. Please select the components to be stopped."})}else{var T=[];U.each(function(Y){var W=K.select(this);var X,V;if(O.isProcessGroup(W)){X=H.urls.api+"/flow/process-groups/"+encodeURIComponent(Y.id);V={id:Y.id,state:"STOPPED"}}else{X=Y.uri;V={revision:k.getRevision(Y),component:{id:Y.id,state:"STOPPED"}}}T.push(n(X,V).done(function(Z){if(O.isProcessGroup(W)){O.getComponentByType("ProcessGroup").reload(Y.id)}else{O.getComponentByType(Y.type).set(Z)}}))});if(T.length>0){E.when.apply(window,T).always(function(){o.digest()})}}}},enableTransmission:function(R){var S=R.filter(function(T){return O.canStartTransmitting(K.select(this))});S.each(function(U){var T={revision:k.getRevision(U),component:{id:U.id,transmitting:true}};n(U.uri,T).done(function(V){a.set(V)})})},disableTransmission:function(S){var R=S.filter(function(T){return O.canStopTransmitting(K.select(this))});R.each(function(U){var T={revision:k.getRevision(U),component:{id:U.id,transmitting:false}};n(U.uri,T).done(function(V){a.set(V)})})},showConfiguration:function(R){if(R.empty()){G.showConfiguration(O.getGroupId())}else{if(R.size()===1){var S=R.datum();if(O.isProcessor(R)){N.showConfiguration(R)}else{if(O.isLabel(R)){B.showConfiguration(R)}else{if(O.isProcessGroup(R)){G.showConfiguration(S.id)}else{if(O.isRemoteProcessGroup(R)){D.showConfiguration(R)}else{if(O.isInputPort(R)||O.isOutputPort(R)){F.showConfiguration(R)}else{if(O.isConnection(R)){p.showConfiguration(R)}}}}}}}}},managePolicies:function(R){if(R.size()<=1){z.showComponentPolicy(R)}},showDetails:function(R){if(R.empty()){G.showConfiguration(O.getGroupId())}else{if(R.size()===1){var S=R.datum();if(O.isProcessor(R)){c.showDetails(O.getGroupId(),S.id)}else{if(O.isProcessGroup(R)){G.showConfiguration(S.id)}else{if(O.isRemoteProcessGroup(R)){M.showDetails(R)}else{if(O.isInputPort(R)||O.isOutputPort(R)){s.showDetails(R)}else{if(O.isConnection(R)){q.showDetails(O.getGroupId(),S.id)}}}}}}}},showUsage:function(R){if(R.size()===1&&O.isProcessor(R)){var S=R.datum();I.showPage("../nifi-docs/documentation?"+E.param({select:S.component.type,group:S.component.bundle.group,artifact:S.component.bundle.artifact,version:S.component.bundle.version}))}},showStats:function(R){if(R.size()===1){var S=R.datum();if(O.isProcessor(R)){L.showProcessorChart(O.getGroupId(),S.id)}else{if(O.isProcessGroup(R)){L.showProcessGroupChart(O.getGroupId(),S.id)}else{if(O.isRemoteProcessGroup(R)){L.showRemoteProcessGroupChart(O.getGroupId(),S.id)}else{if(O.isConnection(R)){L.showConnectionChart(O.getGroupId(),S.id)}}}}}},remotePorts:function(R){if(R.size()===1&&O.isRemoteProcessGroup(R)){b.showPorts(R)}},reload:function(){O.reload({transition:true})},"delete":function(T){if(J.isUndefined(T)||T.empty()){m.showOkDialog({headerText:"Delete Components",dialogContent:"No eligible components are selected. Please select the components to be deleted."})}else{if(T.size()===1){var V=T.datum();var S=k.getRevision(V);E.ajax({type:"DELETE",url:V.uri+"?"+E.param({version:S.version,clientId:S.clientId}),dataType:"json"}).done(function(W){O.getComponentByType(V.type).remove(V.id);if(O.isConnection(T)===false){var X=Q.getComponentConnections(V.id);if(X.length>0){var Y=[];E.each(X,function(aa,Z){Y.push(Z.id)});Q.remove(Y)}}O.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}else{var R=O.getGroupId();var U=P.marshal(T,R);P.create(U).done(function(W){P.remove(W.snippet.id).done(function(){var Y=K.map();var X=function(Z,aa){if(!Y.has(Z)){Y.set(Z,[])}Y.get(Z).push(aa)};T.each(function(aa){X(aa.type,aa.id);if(aa.type!=="Connection"){var Z=Q.getComponentConnections(aa.id);if(Z.length>0){E.each(Z,function(ac,ab){X("Connection",ab.id)})}}});Y.forEach(function(aa,Z){if(aa!=="Connection"){O.getComponentByType(aa).remove(Z)}});if(Y.has("Connection")){Q.remove(Y.get("Connection"))}O.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},emptyQueue:function(R){if(R.size()!==1||!O.isConnection(R)){return}m.showYesNoDialog({headerText:"Empty Queue",dialogContent:"Are you sure you want to empty this queue? All FlowFiles waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty",yesHandler:function(){var V=R.datum();var Z=4;var X=false;var Y=null;var U=null;var T=function(ac){var ad=E("#drop-request-percent-complete");ad.find("div.progress-label").remove();ad.find("md-progress-linear").remove();var ab=E('<div class="progress-label"></div>').text(ac+"%");(o.injector.get("$compile")(E('<md-progress-linear ng-cloak ng-value="'+ac+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(o.rootScope)).appendTo(ad);ad.append(ab)};E("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){X=true;if(U!==null){clearTimeout(U);S()}}}}]);var S=function(){Q.reloadStatus(V.id);if(J.isDefinedAndNotNull(Y)){E.ajax({type:"DELETE",url:Y.uri,dataType:"json"}).done(function(ab){Y=ab.dropRequest;var ae=Y.dropped.split(/ \/ /);var ad=E("<div></div>");E('<span class="label"></span>').text(ae[0]).appendTo(ad);E("<span></span>").text(" FlowFiles ("+ae[1]+")").appendTo(ad);if(Y.percentCompleted<100){var ac=Y.original.split(/ \/ /);E('<span class="label"></span>').text(" out of "+ac[0]).appendTo(ad);E("<span></span>").text(" ("+ac[1]+")").appendTo(ad)}E("<span></span>").text(" were removed from the queue.").appendTo(ad);if(J.isDefinedAndNotNull(Y.failureReason)){E("<br/><br/><span></span>").text(Y.failureReason).appendTo(ad)}m.showOkDialog({headerText:"Empty Queue",dialogContent:ad})}).always(function(){E("#drop-request-status-dialog").modal("hide")})}else{m.showOkDialog({headerText:"Empty Queue",dialogContent:"No FlowFiles were removed."});E("#drop-request-status-dialog").modal("hide")}};var aa=function(ab){T(Y.percentCompleted);E("#drop-request-status-message").text(Y.state);if(Y.finished===true||X===true){S()}else{U=setTimeout(function(){U=null;W(Math.min(Z,ab*2))},ab*1000)}};var W=function(ab){E.ajax({type:"GET",url:Y.uri,dataType:"json"}).done(function(ac){Y=ac.dropRequest;aa(ab)}).fail(function(ae,ac,ad){if(ae.status===403){f.handleAjaxError(ae,ac,ad)}else{S()}})};E.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+encodeURIComponent(V.id)+"/drop-requests",dataType:"json",contentType:"application/json"}).done(function(ab){T(0);E("#drop-request-status-dialog").modal("show");Y=ab.dropRequest;aa(1)}).fail(function(ad,ab,ac){if(ad.status===403){f.handleAjaxError(ad,ab,ac)}else{S()}})}})},listQueue:function(S){if(S.size()!==1||!O.isConnection(S)){return}var R=S.datum();C.listQueue(R)},viewState:function(S){if(S.size()!==1||!O.isProcessor(S)){return}var R=S.datum();g.showState(R,O.isConfigurable(S))},saveFlowVersion:function(R){if(R.empty()){v.showFlowVersionDialog(O.getGroupId())}else{if(R.size()===1){var S=R.datum();if(O.isProcessGroup(R)){v.showFlowVersionDialog(S.id)}}}},revertLocalChanges:function(R){if(R.empty()){v.revertLocalChanges(O.getGroupId())}else{if(R.size()===1){var S=R.datum();v.revertLocalChanges(S.id)}}},showLocalChanges:function(R){if(R.empty()){v.showLocalChanges(O.getGroupId())}else{if(R.size()===1){var S=R.datum();v.showLocalChanges(S.id)}}},changeFlowVersion:function(R){if(R.empty()){v.showChangeFlowVersionDialog(O.getGroupId())}else{if(R.size()===1){var S=R.datum();if(O.isProcessGroup(R)){v.showChangeFlowVersionDialog(S.id)}}}},stopVersionControl:function(R){if(R.empty()){v.stopVersionControl(O.getGroupId())}else{if(R.size()===1){var S=R.datum();v.stopVersionControl(S.id)}}},openVariableRegistry:function(R){if(R.empty()){l.showVariables(O.getGroupId())}else{if(R.size()===1){var S=R.datum();if(O.isProcessGroup(R)){l.showVariables(S.id)}}}},changeVersion:function(S){if(S.size()!==1||!O.isProcessor(S)){return}var R=S.datum();u.promptForVersionChange(R)},alignVertical:function(T){var V=K.map();if(O.canModify(T)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var S=null,U=null;T.each(function(X){if(X.type!=="Connection"){if(S===null||X.position.x<S){S=X.position.x}var W=X.position.x+X.dimensions.width;if(U===null||W>U){U=W}}});var R=(S+U)/2;T.each(function(X){if(X.type!=="Connection"){var Y={x:R-(X.position.x+X.dimensions.width/2),y:0};if(Y.x!==0){var W=Q.getComponentConnections(X.id);E.each(W,function(ab,aa){var ac=K.select("#id-"+aa.id);if(!V.has(aa.id)&&O.getConnectionSourceComponentId(aa)===O.getConnectionDestinationComponentId(aa)){var Z=x.updateConnectionPosition(Q.get(aa.id),Y);if(Z!==null){V.set(aa.id,Z)}}else{if(!V.has(aa.id)&&ac.classed("selected")&&O.canModify(ac)){if(O.getConnectionSourceComponentId(aa)===X.id||!d(aa,T)){var Z=x.updateConnectionPosition(Q.get(aa.id),Y);if(Z!==null){V.set(aa.id,Z)}}}}});V.set(X.id,x.updateComponentPosition(X,Y))}}});x.refreshConnections(V)},alignHorizontal:function(S){var U=K.map();if(O.canModify(S)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var V=null,T=null;S.each(function(X){if(X.type!=="Connection"){if(V===null||X.position.y<V){V=X.position.y}var W=X.position.y+X.dimensions.height;if(T===null||W>T){T=W}}});var R=(V+T)/2;S.each(function(X){if(X.type!=="Connection"){var Y={x:0,y:R-(X.position.y+X.dimensions.height/2)};if(Y.y!==0){var W=Q.getComponentConnections(X.id);E.each(W,function(ab,aa){var ac=K.select("#id-"+aa.id);if(!U.has(aa.id)&&O.getConnectionSourceComponentId(aa)===O.getConnectionDestinationComponentId(aa)){var Z=x.updateConnectionPosition(Q.get(aa.id),Y);if(Z!==null){U.set(aa.id,Z)}}else{if(!U.has(aa.id)&&ac.classed("selected")&&O.canModify(ac)){if(O.getConnectionSourceComponentId(aa)===X.id||!d(aa,S)){var Z=x.updateConnectionPosition(Q.get(aa.id),Y);if(Z!==null){U.set(aa.id,Z)}}}}});U.set(X.id,x.updateComponentPosition(X,Y))}}});x.refreshConnections(U)},fillColor:function(T){if(O.isColorable(T)){var R=O.isProcessor(T);var S;if(R){S=t.defaultFillColor()}else{S=w.defaultColor()}if(T.size()===1){var U=T.datum();if(J.isDefinedAndNotNull(U.component.style["background-color"])){S=U.component.style["background-color"]}}E("#fill-color").minicolors("value",S);if(R){E("#fill-color-processor-preview").show();E("#fill-color-label-preview").hide()}else{E("#fill-color-processor-preview").hide();E("#fill-color-label-preview").show()}E("#fill-color-dialog").modal("show")}},group:function(){var S=O.getSelection();if(S.empty()){return}var R=O.getOrigin(S);var T={x:R.x,y:R.y};E.when(o.injector.get("groupComponent").promptForGroupName(T)).done(function(U){var V=K.select("#id-"+U.id);O.moveComponents(S,V)})},moveIntoParent:function(){var R=O.getSelection();if(R.empty()){return}O.moveComponentsToParent(R)},uploadTemplate:function(){E("#upload-template-dialog").modal("show")},template:function(){var R=O.getSelection();if(R.empty()){R=K.selectAll("g.component, g.connection")}if(R.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}R=O.trimDanglingEdges(R);if(R.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}E("#new-template-dialog").modal("setButtonModel",[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var T=E("#new-template-name").val();if(J.isBlank(T)){m.showOkDialog({headerText:"Create Template",dialogContent:"The template name cannot be blank."});return}E("#new-template-dialog").modal("hide");var V=E("#new-template-description").val();var S=O.getGroupId();var U=P.marshal(R,S);P.create(U).done(function(W){var X={name:T,description:V,snippetId:W.snippet.id};E.ajax({type:"POST",url:H.urls.api+"/process-groups/"+encodeURIComponent(O.getGroupId())+"/templates",data:JSON.stringify(X),dataType:"json",contentType:"application/json"}).done(function(){m.showOkDialog({headerText:"Create Template",dialogContent:"Template '"+J.escapeHtml(T)+"' was successfully created."})}).always(function(){E("#new-template-name").val("");E("#new-template-description").val("")}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){E("#new-template-name").val("");E("#new-template-description").val("");E("#new-template-dialog").modal("hide")}}}]).modal("show");E("#new-template-name").focus()},copy:function(T){if(T.empty()){return}var S=O.getOrigin(T);var R=O.getGroupId();A.copy({snippet:P.marshal(T,R),origin:S})},paste:function(Y,Z){if(J.isDefinedAndNotNull(Z)){var T=O.scaleCanvasView();var R=O.translateCanvasView();var U=Z.pageX;var S=Z.pageY-O.getCanvasOffset();var X=(U/T)-(R[0]/T);var W=(S/T)-(R[1]/T);var V={x:X,y:W}}A.paste().done(function(ab){var aa=E.Deferred(function(ac){var ad=function(ah,af,ag){ac.reject(ah.responseText)};var ae=O.getGroupId();P.create(ab.snippet).done(function(ah){var ag=V;var af=ab.origin;if(!J.isDefinedAndNotNull(ag)){af.x+=25;af.y+=25;ag=af}P.copy(ah.snippet.id,ag,ae).done(function(aj){var ai=aj.flow;r.add(ai,{selectAll:true});r.updateVisibility();i.refresh()}).fail(function(){O.reload().done(function(){r.updateVisibility();i.refresh()})}).fail(ad)}).fail(ad)}).promise();aa.fail(function(ad){var ac="An error occurred while attempting to copy and paste.";if(E.trim(ad)!==""){ac=ad}m.showOkDialog({headerText:"Paste Error",dialogContent:J.escapeHtml(ac)})})})},toFront:function(U){if(U.size()!==1||!O.isConnection(U)){return}var R=U.datum();var T=-1;E.each(Q.get(),function(W,X){if(R.id!==X.id&&X.zIndex>T){T=X.zIndex}});if(T>=0){var V=T+1;var S={revision:k.getRevision(R),component:{id:R.id,zIndex:V}};E.ajax({type:"PUT",url:R.uri,data:JSON.stringify(S),dataType:"json",contentType:"application/json"}).done(function(W){Q.set(W)})}}};return y}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Graph","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils","nf.Birdseye","nf.ContextMenu","nf.Actions","nf.ProcessGroup"],function(i,p,h,l,e,k,n,m,j,g,d,o,f,c){return(nf.Canvas=b(i,p,h,l,e,k,n,m,j,g,d,o,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Canvas=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Graph"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Birdseye"),require("nf.ContextMenu"),require("nf.Actions"),require("nf.ProcessGroup")))}else{nf.Canvas=b(a.$,a.d3,a.nf.Common,a.nf.Graph,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils,a.nf.Birdseye,a.nf.ContextMenu,a.nf.Actions,a.nf.ProcessGroup)}}}(this,function(v,F,D,l,C,k,B,d,o,I,e,s,q,t){var z=1;var n=[0,0];var b=1.2;var G=8;var p=0.2;var u=0.6;var g=false;var y=false;var J="root";var L=null;var i=null;var j=null;var a=false;var E=false;var m=false;var c=null;var f=null;var K=false;var h=false;var x={urls:{api:"../nifi-api",currentUser:"../nifi-api/flow/current-user",controllerBulletins:"../nifi-api/flow/controller/bulletins",kerberos:"../nifi-api/access/kerberos",oidc:"../nifi-api/access/oidc/exchange",revision:"../nifi-api/flow/revision",banners:"../nifi-api/flow/banners"}};var A=function(M){if(g){r.reload({transition:true}).done(function(){setTimeout(function(){A(M)},M*1000)})}};var H=function(M,O){var N=new Date().getTime();return v.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(M),dataType:"json"}).done(function(P){var Q=P.processGroupFlow;r.setGroupId(Q.id);var R=Q.breadcrumb;if(R.permissions.canRead){r.setGroupName(R.breadcrumb.name)}else{r.setGroupName(R.id)}i=P.permissions;k.injector.get("breadcrumbsCtrl").resetBreadcrumbs();k.digest();k.injector.get("breadcrumbsCtrl").generateBreadcrumbs(R);k.injector.get("breadcrumbsCtrl").resetScrollPosition();v("#stats-last-refreshed").text(Q.lastRefreshed);if(D.isDefinedAndNotNull(Q.parentGroupId)){r.setParentGroupId(Q.parentGroupId)}else{r.setParentGroupId(null)}l.expireCaches(N);l.set(Q.flow,v.extend({selectAll:false,overrideRevisionCheck:B.didConnectedStateChange()},O));l.updateVisibility();e.refresh()}).fail(d.handleAjaxError)};var w=function(){return v.ajax({type:"GET",url:x.urls.currentUser,dataType:"json"}).done(function(M){D.setCurrentUser(M)})};var r={CANVAS_OFFSET:0,SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,hideSplash:function(){v("#splash").fadeOut()},stopPolling:function(){g=false},disableRefreshHotKey:function(){y=true},reload:function(M){return v.Deferred(function(P){var O=H(r.getGroupId(),M);var R=k.injector.get("flowStatusCtrl").reloadFlowStatus();var Q=w();var N=v.ajax({type:"GET",url:x.urls.controllerBulletins,dataType:"json"}).done(function(T){k.injector.get("flowStatusCtrl").updateBulletins(T)});var S=B.loadClusterSummary().done(function(T){var U=T.clusterSummary;k.injector.get("flowStatusCtrl").updateClusterSummary(U)});v.when(O,R,Q,N,S).done(function(T){k.digest();P.resolve(T)}).fail(function(V,T,U){P.reject(V,T,U)})}).promise()},initCanvas:function(){var S=v("#canvas-container");c=F.select("#canvas-container").append("svg").on("contextmenu",function(){K=false;I.getSelection().classed("selected",false);I.setURLParameters();s.show();F.event.preventDefault()});var M=c.append("defs");M.selectAll("marker").data(["normal","ghost","unauthorized","full"]).enter().append("marker").attr({id:function(T){return T},viewBox:"0 0 6 6",refX:5,refY:3,markerWidth:6,markerHeight:6,orient:"auto",fill:function(T){if(T==="ghost"){return"#aaaaaa"}else{if(T==="unauthorized"){return"#ba554a"}else{if(T==="full"){return"#ba554a"}else{return"#000000"}}}}}).append("path").attr("d","M2,3 L0,6 L6,3 L0,0 z");var O=M.append("filter").attr({id:"component-drop-shadow",height:"140%",y:"-20%"});O.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:3,result:"blur"});O.append("feOffset").attr({"in":"blur",dx:0,dy:1,result:"offsetBlur"});O.append("feFlood").attr({"flood-color":"#000000","flood-opacity":0.4,result:"offsetColor"});O.append("feComposite").attr({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var Q=O.append("feMerge");Q.append("feMergeNode").attr("in","offsetColorBlur");Q.append("feMergeNode").attr("in","SourceGraphic");var N=M.append("filter").attr({id:"connection-full-drop-shadow",height:"140%",y:"-20%"});N.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:3,result:"blur"});N.append("feOffset").attr({"in":"blur",dx:0,dy:1,result:"offsetBlur"});N.append("feFlood").attr({"flood-color":"#ba554a","flood-opacity":1,result:"offsetColor"});N.append("feComposite").attr({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var R=N.append("feMerge");R.append("feMergeNode").attr("in","offsetColorBlur");R.append("feMergeNode").attr("in","SourceGraphic");f=c.append("g").attr({transform:"translate("+n+") scale("+z+")","pointer-events":"all",id:"canvas"});c.on("mousedown.selection",function(){K=true;if(F.event.button!==0){F.event.stopImmediatePropagation();return}if(F.event.shiftKey){var T=F.mouse(f.node());f.append("rect").attr("rx",6).attr("ry",6).attr("x",T[0]).attr("y",T[1]).attr("class","selection").attr("width",0).attr("height",0).attr("stroke-width",function(){return 1/r.View.scale()}).attr("stroke-dasharray",function(){return 4/r.View.scale()}).datum(T);F.event.stopImmediatePropagation();F.event.preventDefault()}}).on("mousemove.selection",function(){if(F.event.shiftKey){var U=F.select("rect.selection");if(!U.empty()){var V=U.datum();var T=F.mouse(f.node());var W={};if(V[0]<T[0]){W.x=V[0];W.width=T[0]-V[0]}else{W.x=T[0];W.width=V[0]-T[0]}if(V[1]<T[1]){W.y=V[1];W.height=T[1]-V[1]}else{W.y=T[1];W.height=V[1]-T[1]}U.attr(W);F.event.stopPropagation()}}}).on("mouseup.selection",function(){if(K===false){return}K=false;var T=F.select("rect.selection");if(!T.empty()){var U={x:parseInt(T.attr("x"),10),y:parseInt(T.attr("y"),10),width:parseInt(T.attr("width"),10),height:parseInt(T.attr("height"),10)};F.selectAll("g.component").classed("selected",function(V){return F.select(this).classed("selected")||V.position.x>=U.x&&(V.position.x+V.dimensions.width)<=(U.x+U.width)&&V.position.y>=U.y&&(V.position.y+V.dimensions.height)<=(U.y+U.height)});F.selectAll("g.connection").classed("selected",function(X){var W=[X.start].concat(X.bends,[X.end]);var V=F.extent(W,function(Z){return Z.x});var Y=F.extent(W,function(Z){return Z.y});return F.select(this).classed("selected")||V[0]>=U.x&&V[1]<=(U.x+U.width)&&Y[0]>=U.y&&Y[1]<=(U.y+U.height)});T.remove();I.setURLParameters()}else{if(h===false){I.getSelection().classed("selected",false);I.setURLParameters()}}k.digest()});var P=function(){var X=v("#banner-footer");var T=0;if(X.is(":visible")){T=X.height()}var V=parseInt(S.css("top"),10);var W=v(window).height();var U=(W-(T+V));S.css({height:U+"px",bottom:T+"px"});c.attr({height:S.height(),width:v(window).width()});k.injector.get("breadcrumbsCtrl").updateBreadcrumbsCss({bottom:T+"px"});v("#canvas-body").css({height:W+"px",width:v(window).width()+"px"})};v("body").on("GoTo:Component",function(U,T){I.showComponent(T.parentGroupId,T.id)});v("body").on("GoTo:ProcessGroup",function(U,T){t.enterGroup(T.id).done(function(){I.getSelection().classed("selected",false);k.digest()})});v(window).on("resize",function(ab){if(ab.target===window){if(v(".md-menu-backdrop").is(":visible")===true){v(".md-menu-backdrop").click()}P();var Z=v("#shell-dialog");if(Z.is(":visible")){setTimeout(function(ad){C.resizeContent(ad);if(ad.find("#shell-iframe").is(":visible")){C.resizeIframe(ad)}},50,Z)}var T=v(".dialog");for(var Y=0,aa=T.length;Y<aa;Y++){if(v(T[Y]).is(":visible")){setTimeout(function(ad){ad.modal("resize")},50,v(T[Y]))}}var ac=v('*[class*="slickgrid_"]');for(var X=0,aa=ac.length;X<aa;X++){if(v(ac[X]).is(":visible")){setTimeout(function(ad){ad.data("gridInstance").resizeCanvas()},50,v(ac[X]))}}var V=v(".tab-container");var U=[];for(var W=0,aa=V.length;W<aa;W++){if(v(V[W]).is(":visible")){U.push(v("#"+v(V[W]).attr("id")+"-content"))}}v.each(U,function(ad,ae){D.toggleScrollable(ae.get(0))})}}).on("keydown",function(T){if(v(".dialog").is(":visible")||v("#search-field").is(":focus")){return}var U=I.getSelection();var V=T.ctrlKey||T.metaKey;if(V){if(T.keyCode===82){if(y===true){location.reload();return}q.reload()}else{if(T.keyCode===65){q.selectAll();I.setURLParameters();k.digest();T.preventDefault()}else{if(T.keyCode===67){if(r.canWrite()&&I.isCopyable(U)){q.copy(U)}}else{if(T.keyCode===86){if(r.canWrite()&&I.isPastable()){q.paste(U);T.preventDefault()}}}}}}else{if(T.keyCode===8||T.keyCode===46){if(r.canWrite()&&I.areDeletable(U)){q["delete"](U)}}}});v.ajax({type:"GET",url:x.urls.banners,dataType:"json"}).done(function(V){if(D.isDefinedAndNotNull(V.banners)){if(D.isDefinedAndNotNull(V.banners.headerText)&&V.banners.headerText!==""){v("#banner-header").addClass("banner-header-background").text(V.banners.headerText).show();v("#canvas-container").css("top","98px")}if(D.isDefinedAndNotNull(V.banners.footerText)&&V.banners.footerText!==""){var T=v("#banner-footer").text(V.banners.footerText).show();var U=function(W){var X=v("#"+W);X.css("bottom",parseInt(T.css("height"),10)+"px")};U("graph")}}P()}).fail(d.handleAjaxError)},init:function(){var M=v.Deferred(function(N){var O=function(R){var Q=D.getJwtPayload(R);var P=parseInt(Q.exp,10)*D.MILLIS_PER_SECOND;o.setItem("jwt",R,P);N.resolve()};if(o.hasItem("jwt")){N.resolve()}else{v.ajax({type:"POST",url:x.urls.kerberos,dataType:"text"}).done(function(P){O(P)}).fail(function(){v.ajax({type:"POST",url:x.urls.oidc,dataType:"text"}).done(function(P){O(P)}).fail(function(){N.reject()})})}}).promise();return v.Deferred(function(N){M.always(function(){w().done(function(O){if(O.anonymous===false){v("#current-user").text(O.identity).show();if(o.getItem("jwt")!==null){v("#logout-link-container").show()}}else{D.setAnonymousUserLabel()}N.resolve()}).fail(function(Q,O,P){if(Q.status===401){window.location="../nifi/login"}else{N.reject(Q,O,P)}})})}).promise()},setGroupId:function(M){J=M},getGroupId:function(){return J},setGroupName:function(M){L=M},getGroupName:function(){return L},setParentGroupId:function(M){j=M},getParentGroupId:function(){return j},setManagedAuthorizer:function(M){a=M},isManagedAuthorizer:function(){return a},setConfigurableAuthorizer:function(M){E=M},isConfigurableAuthorizer:function(){return E},setConfigurableUsersAndGroups:function(M){m=M},isConfigurableUsersAndGroups:function(){return m},canRead:function(){if(i===null){return false}else{return i.canRead===true}},canWrite:function(){if(i===null){return false}else{return i.canWrite===true}},startPolling:function(M){g=true;A(M)},View:(function(){var M;return{init:function(){var N;var O=false;M=F.behavior.zoom().scaleExtent([p,G]).translate(n).scale(z).on("zoomstart",function(){s.hide()}).on("zoom",function(){if(O){h=true}else{O=true}var P=F.event.sourceEvent.type==="wheel"||F.event.sourceEvent.type==="mousewheel";N=r.View.refresh({persist:false,transition:P,refreshComponents:false,refreshBirdseye:false})}).on("zoomend",function(){if(D.isDefinedAndNotNull(N)){l.updateVisibility();N.done(function(){e.refresh()});I.persistUserView();N=null}h=false;O=false});c.call(M).on("dblclick.zoom",null)},shouldRenderPerScale:function(){return r.View.scale()>=u},translate:function(N){if(D.isUndefined(N)){return M.translate()}else{M.translate(N)}},scale:function(N){if(D.isUndefined(N)){return M.scale()}else{M.scale(N)}},zoomIn:function(){var P=r.View.translate();var O=r.View.scale();var S=Math.min(O*b,G);var R=v("#canvas-container");var N=R.width()/O;var Q=R.height()/O;r.View.scale(S);I.centerBoundingBox({x:(N/2)-(P[0]/O),y:(Q/2)-(P[1]/O),width:1,height:1})},zoomOut:function(){var P=r.View.translate();var O=r.View.scale();var S=Math.max(O/b,p);var R=v("#canvas-container");var N=R.width()/O;var Q=R.height()/O;r.View.scale(S);I.centerBoundingBox({x:(N/2)-(P[0]/O),y:(Q/2)-(P[1]/O),width:1,height:1})},fit:function(){var P=r.View.translate();var R=r.View.scale();var U;var T=v("#canvas-container");var Q=T.width();var S=T.height();var W=F.select("#canvas").node().getBoundingClientRect();var X=W.width/R;var O=W.height/R;var V=W.left/R;var N=(W.top-r.CANVAS_OFFSET)/R;if(X>Q||O>S){U=Math.min(Q/X,S/O);U=Math.min(Math.max(U,p),G)}else{U=1;V-=100;N-=50}r.View.scale(U);I.centerBoundingBox({x:V-(P[0]/R),y:N-(P[1]/R),width:Q/U,height:S/U})},actualSize:function(){var S=r.View.translate();var R=r.View.scale();var O=I.getSelection();r.View.scale(1);var P;if(!O.empty()){var N=O.node().getBoundingClientRect();P={x:(N.left/R)-(S[0]/R),y:((N.top-r.CANVAS_OFFSET)/R)-(S[1]/R),width:N.width/R,height:N.height/R}}else{var U=v("#canvas-container");var Q=U.width()/R;var T=U.height()/R;P={x:(Q/2)-(S[0]/R),y:(T/2)-(S[1]/R),width:1,height:1}}I.centerBoundingBox(P)},refresh:function(N){return v.Deferred(function(O){var P=true;var R=false;var Q=true;var S=true;if(D.isDefinedAndNotNull(N)){P=D.isDefinedAndNotNull(N.persist)?N.persist:P;R=D.isDefinedAndNotNull(N.transition)?N.transition:R;Q=D.isDefinedAndNotNull(N.refreshComponents)?N.refreshComponents:Q;S=D.isDefinedAndNotNull(N.refreshBirdseye)?N.refreshBirdseye:S}if(Q){l.updateVisibility()}if(P===true){I.persistUserView()}if(R===true){f.transition().duration(500).attr("transform",function(){return"translate("+M.translate()+") scale("+M.scale()+")"}).each("end",function(){if(S===true){e.refresh()}O.resolve()})}else{f.attr("transform",function(){return"translate("+M.translate()+") scale("+M.scale()+")"});if(S===true){e.refresh()}O.resolve()}}).promise()}}}())};return r}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ErrorHandler","nf.Common","nf.Canvas","nf.ContextMenu"],function(f,e,d,c){return(nf.ErrorHandler=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("nf.ErrorHandler"),require("nf.Common"),require("nf.Canvas"),require("nf.ContextMenu")))}else{nf.ErrorHandler=b(a.nf.ErrorHandler,a.nf.Common,a.nf.Canvas,a.nf.ContextMenu)}}}(this,function(d,c,b,a){return{handleAjaxError:function(g,e,f){d.handleAjaxError(g,e,f);c.showLogoutLink();if($("#splash").is(":visible")){b.hideSplash()}a.hide();b.stopPolling();b.disableRefreshHotKey()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.Settings","nf.UniversalCapture","nf.CustomUi","nf.CanvasUtils","nf.ReportingTask","nf.Processor"],function(g,m,k,d,f,n,e,h,j,c,l,i){return(nf.ControllerService=b(g,m,k,d,f,n,e,h,j,c,l,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerService=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.Settings"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.CanvasUtils"),require("nf.ReportingTask"),require("nf.Processor")))}else{nf.ControllerService=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.Settings,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.CanvasUtils,a.nf.ReportingTask,a.nf.Processor)}}}(this,function(C,T,d,R,j,g,H,c,z,W,D,s){var N;var M={edit:"edit",readOnly:"read-only",serviceOnly:"SERVICE_ONLY",serviceAndReferencingComponents:"SERVICE_AND_REFERENCING_COMPONENTS",urls:{api:"../nifi-api"}};var v=function(ac,Z,aa){if(ac.status===400){var ad=ac.responseText.split("\n");var ab;if(ad.length===1){ab=C("<span></span>").text(ad[0])}else{ab=R.formatUnorderedList(ad)}j.showOkDialog({dialogContent:ab,headerText:"Controller Service"})}else{d.handleAjaxError(ac,Z,aa)}};var G=function(){var Z=C("#controller-service-configuration").data("controllerServiceDetails");if(C("#controller-service-name").val()!==Z.component.name){return true}if(C("#controller-service-comments").val()!==Z.component.comments){return true}return C("#controller-service-properties").propertytable("isSaveRequired")};var n=function(){var aa=C("#controller-service-properties").propertytable("marshalProperties");var ab={};ab.id=C("#controller-service-id").text();ab.name=C("#controller-service-name").val();ab.comments=C("#controller-service-comments").val();if(C.isEmptyObject(aa)===false){ab.properties=aa}var Z={};Z.component=ab;return Z};var b=function(Z){return true};var X=function(ac,ad){var aa=ac.data("gridInstance");var ab=aa.getData();var Z=ab.getItemById(ad);if(R.isUndefined(Z)||Z.permissions.canRead===false){return C.Deferred(function(ae){ae.reject()}).promise()}return C.ajax({type:"GET",url:Z.uri,dataType:"json"}).done(function(ae){O(ac,ae)}).fail(d.handleAjaxError)};var O=function(ad,Z){var aa=ad.data("gridInstance");var ac=aa.getData();var ab=ac.getItemById(Z.id);ac.updateItem(Z.id,C.extend({type:"ControllerService",bulletins:ab.bulletins},Z))};var h=function(aa,Z){X(aa,Z.id).done(function(ab){f(aa,ab.component)})};var f=function(aa,Z){C.each(Z.referencingComponents,function(ac,ae){if(ae.permissions.canRead===false){return}var ab=ae.component;if(ab.referenceType==="Processor"){if(W.getGroupId()===ab.groupId){s.reload(ab.id)}C("div."+ab.id+"-active-threads").text(ab.activeThreadCount);var ad=C("div."+ab.id+"-state");if(ad.length){l(ad,ab)}}else{if(ab.referenceType==="ReportingTask"){D.reload(ab.id);C("div."+ab.id+"-active-threads").text(ab.activeThreadCount);var ad=C("div."+ab.id+"-state");if(ad.length){l(ad,ab)}}else{X(aa,ab.id);var ad=C("div."+ab.id+"-state");if(ad.length){I(ad,ab)}if(ab.referenceCycle===false){f(aa,ab)}}}});S.reloadReferencedServices(aa,Z)};var U=function(Z){var aa=Z.get(0).scrollHeight>Math.round(Z.innerHeight())||Z.get(0).scrollWidth>Math.round(Z.innerWidth());if(Z.is(":visible")&&aa){Z.css("border-width","1px")}else{Z.css("border-width","0px")}};var k=function(ac,aa){var ad=aa.data("bulletins");if(R.doBulletinsDiffer(ad,ac)){aa.data("bulletins",ac);var Z=R.getFormattedBulletins(ac);if(ac.length>0){var ab=R.formatUnorderedList(Z);if(aa.data("qtip")){aa.qtip("option","content.text",ab)}else{aa.addClass("has-bulletins").show().qtip(C.extend({},W.config.systemTooltipConfig,{content:ab}))}}else{if(aa.data("qtip")){aa.removeClass("has-bulletins").removeData("bulletins").hide().qtip("api").destroy(true)}}}};var l=function(Z,aa){Z.removeClass("disabled stopped running invalid").addClass(function(){var ab=C(this);var ad=aa.state.toLowerCase();if(ad==="stopped"&&!R.isEmpty(aa.validationErrors)){ad="invalid";var ac=R.formatUnorderedList(aa.validationErrors);if(ab.data("qtip")){ab.qtip("option","content.text",ac)}else{ab.qtip(C.extend({},W.config.systemTooltipConfig,{content:ac}))}}else{if(ab.data("qtip")){ab.qtip("api").destroy(true)}}return ad})};var I=function(aa,Z){aa.removeClass("disabled enabled invalid").addClass(function(){var ab=C(this);var ad=Z.state==="ENABLED"?"enabled":"disabled";if(ad==="disabled"&&!R.isEmpty(Z.validationErrors)){ad="invalid";var ac=R.formatUnorderedList(Z.validationErrors);if(ab.data("qtip")){ab.qtip("option","content.text",ac)}else{ab.qtip(C.extend({},W.config.systemTooltipConfig,{content:ac}))}}else{if(ab.data("qtip")){ab.qtip("api").destroy(true)}}return ad})};var m=function(aa){var Z=T.nest().key(function(ab){return ab.sourceId}).map(aa,T.map);Z.forEach(function(ac,ab){C("div."+ac+"-bulletins").each(function(){k(ab,C(this))})})};var L=function(ah,ai,ac){if(R.isEmpty(ac)){ai.append('<div class="unset">No referencing components.</div>');return}var aa=function(ak,aj){if(ak.hasClass("expanded")){ak.removeClass("expanded").addClass("collapsed");aj.hide()}else{ak.removeClass("collapsed").addClass("expanded");aj.show()}};var ab=[];var ad=C('<ul class="referencing-component-listing clear"></ul>');var ag=C('<ul class="referencing-component-listing clear"></ul>');var Z=C('<ul class="referencing-component-listing clear"></ul>');var ae=C('<ul class="referencing-component-listing clear"></ul>');C.each(ac,function(aG,ap){if(ap.permissions.canRead===false||ap.permissions.canWrite===false){var am=C('<div class="unset"></div>').text(ap.id);ae.append(am)}else{var az=ap.component;ab.push(az.id);if(az.referenceType==="Processor"){var aF=C('<span class="referencing-component-name link"></span>').text(az.name).on("click",function(){W.showComponent(az.groupId,az.id);ai.closest(".dialog").modal("hide");C("#shell-close-button").click()});var av=C('<div class="referencing-component-state"></div>').addClass(az.id+"-state");l(av,az);var ax=C('<div class="referencing-component-bulletins"></div>').addClass(az.id+"-bulletins");var aA=C('<span class="referencing-component-type"></span>').text(R.substringAfterLast(az.type,"."));var al=C('<span class="referencing-component-active-thread-count"></span>').addClass(az.id+"-active-threads");if(R.isDefinedAndNotNull(az.activeThreadCount)&&az.activeThreadCount>0){al.text("("+az.activeThreadCount+")")}var ar=C("<li></li>").append(av).append(ax).append(aF).append(aA).append(al);ad.append(ar)}else{if(az.referenceType==="ControllerService"){var aC=C('<span class="referencing-component-name link"></span>').text(az.name).on("click",function(){var aH=ah.data("gridInstance");var aI=aH.getData();var aJ=aI.getRowById(az.id);aH.setSelectedRows([aJ]);aH.scrollRowIntoView(aJ);ai.closest(".dialog").modal("hide")});var aD=C('<div class="referencing-component-references hidden"></div>');var ao=C('<div class="service expansion-button collapsed pointer"></div>').on("click",function(){if(ao.hasClass("collapsed")){if(az.referenceCycle===true){aD.append('<div class="unset">Reference cycle detected.</div>')}else{var aH=ah.data("gridInstance");var aI=aH.getData();o(az.id,aI).done(function(aJ){var aK=aJ.component;L(ah,aD,aK.referencingComponents)})}}else{aD.empty()}aa(ao,aD);U(ai)});var at=C('<div class="referencing-component-state"></div>').addClass(az.id+"-state");I(at,az);var aE=C('<div class="referencing-component-bulletins"></div>').addClass(az.id+"-bulletins");var ay=C('<span class="referencing-component-type"></span>').text(R.substringAfterLast(az.type,"."));var aq=C("<li></li>").append(ao).append(at).append(aE).append(aC).append(ay).append(aD);ag.append(aq)}else{if(az.referenceType==="ReportingTask"){var an=C('<span class="referencing-component-name link"></span>').text(az.name).on("click",function(){var aJ=C("#reporting-tasks-table").data("gridInstance");var aH=aJ.getData();var aI=aH.getRowById(az.id);aJ.setSelectedRows([aI]);aJ.scrollRowIntoView(aI);C("#settings-tabs").find("li:last").click();ai.closest(".dialog").modal("hide")});var aw=C('<div class="referencing-component-state"></div>').addClass(az.id+"-state");l(aw,az);var aj=C('<div class="referencing-component-bulletins"></div>').addClass(az.id+"-bulletins");var ak=C('<span class="referencing-component-type"></span>').text(R.substringAfterLast(az.type,"."));var au=C('<span class="referencing-component-active-thread-count"></span>').addClass(az.id+"-active-threads");if(R.isDefinedAndNotNull(az.activeThreadCount)&&az.activeThreadCount>0){au.text("("+az.activeThreadCount+")")}var aB=C("<li></li>").append(aw).append(aj).append(an).append(ak).append(au);Z.append(aB)}}}}});W.queryBulletins(ab).done(function(aj){var ak=aj.bulletinBoard.bulletins;m(ak)});var af=function(aj,al){if(al.is(":empty")){al.remove();return}var an=C('<div class="expansion-button expanded"></div>');var am=C('<span class="referencing-component-title"></span>').text(aj);var ak=C('<span class="referencing-component-count"></span>').text("("+al.children().length+")");C('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){aa(an,al);U(ai)}).append(an).append(am).append(ak).appendTo(ai);al.appendTo(ai)};af("Processors",ad);af("Reporting Tasks",Z);af("Controller Services",ag);af("Unauthorized",ae)};var e=function(ae,aa,ac,ad){var Z={revision:g.getRevision(aa),component:{id:aa.id,state:ac?"ENABLED":"DISABLED"}};var ab=C.ajax({type:"PUT",url:aa.uri,data:JSON.stringify(Z),dataType:"json",contentType:"application/json"}).done(function(af){O(ae,af)}).fail(d.handleAjaxError);return C.Deferred(function(af){ab.done(function(){var ag=t(aa,function(ah,ai){if(C.isArray(ai)){if(ac){k(ai,C("#enable-controller-service-bulletins"))}else{k(ai,C("#disable-controller-service-bulletins"))}}if(ac){return ah.state==="ENABLING"||ah.state==="ENABLED"}else{return ah.state==="DISABLED"}},function(ah){return W.queryBulletins([ah.id])},ad);ag.done(function(){af.resolve()}).fail(function(){af.reject()})}).fail(function(){af.reject()})}).promise()};var q=function(Z){var aa=T.set();aa.add(Z.id);var ab=function(ac){C.each(ac,function(ad,af){var ae=af.component;if(ae.referenceType==="ControllerService"){aa.add(ae.id);if(ae.referenceCycle===false){ab(ae.referencingComponents)}}})};ab(Z.referencingComponents);return aa};var a=function(aa,Z,ab){C.each(aa,function(ac,ae){var ad=ae.component;if(ab){if(ad.referenceType==="ControllerService"){Z[ae.id]=g.getRevision(ae)}}else{if(ad.referenceType!=="ControllerService"){Z[ae.id]=g.getRevision(ae)}}a(ad.referencingComponents,Z,ab)})};var E=function(ae,Z,ab,ad){var af={};a(Z.component.referencingComponents,af,false);var ac={id:Z.id,state:ab?"RUNNING":"STOPPED",referencingComponentRevisions:af};var aa=C.ajax({type:"PUT",url:Z.uri+"/references",data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return C.Deferred(function(ag){aa.done(function(ah){Z.component.referencingComponents=ah.controllerServiceReferencingComponents;if(ab){ag.resolve()}else{var ai=q(Z.component);var aj=ae.data("gridInstance");var al=aj.getData();var ak=[];ai.forEach(function(am){o(am,al).done(function(an){ak.push(w(an,ad))})});C.when.apply(window,ak).done(function(){ag.resolve()}).fail(function(){ag.reject()})}}).fail(function(){ag.reject()})}).promise()};var o=function(aa,ab){var Z=ab.getItemById(aa);if(R.isDefinedAndNotNull(Z)){return C.Deferred(function(ac){ac.resolve(Z)})}else{return C.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(aa),dataType:"json"}).fail(d.handleAjaxError)}};var t=function(Z,ac,ab,ad){var aa=Z.component;return C.Deferred(function(ae){var ah=2;var ag=function(){var aj=ah;ah=Math.min(ah*2,4);return aj*1000};var ai=function(){var ak=ab(aa);var aj=C.ajax({type:"GET",url:Z.uri,dataType:"json"});C.when(ak,aj).done(function(am,an){var al=an[0];af(al.component,am.bulletinBoard.bulletins)}).fail(function(an,al,am){ae.reject();d.handleAjaxError(an,al,am)})};var af=function(aj,ak){if(ac(aj,ak)){ae.resolve()}else{if(typeof ad==="function"&&ad()){setTimeout(ai,ag())}else{ae.reject()}}};ab(aa).done(function(aj){af(aa,aj.bulletinBoard.bulletins)}).fail(function(al,aj,ak){ae.reject();d.handleAjaxError(al,aj,ak)})}).promise()};var w=function(Z,aa){return t(Z,function(ab,ae){var ac=ab.referencingComponents;var ad=false;C.each(ac,function(af,ai){var ah=ai.component;if(ah.referenceType==="Processor"||ah.referenceType==="ReportingTask"){if(ah.state==="RUNNING"||ah.activeThreadCount>0){ad=true}C("div."+ah.id+"-active-threads").text(ah.activeThreadCount);var ag=C("div."+ah.id+"-state");l(ag,ah)}});m(ae);return ad===false},function(ab){var ad=[];var ac=ab.referencingComponents;C.each(ac,function(ae,ag){var af=ag.component;if(af.referenceType==="Processor"||af.referenceType==="ReportingTask"){ad.push(af.id)}});return W.queryBulletins(ad)},aa)};var Y=function(Z,aa){return t(Z,function(ab,ae){var ac=ab.referencingComponents;var ad=false;C.each(ac,function(af,ai){var ag=ai.component;if(ag.referenceType==="ControllerService"){if(ag.state!=="ENABLING"&&ag.state!=="ENABLED"){ad=true}var ah=C("div."+ag.id+"-state");I(ah,ag)}});m(ae);return ad===false},function(ab){var ad=[];var ac=ab.referencingComponents;C.each(ac,function(ae,ag){var af=ag.component;if(af.referenceType==="ControllerService"){ad.push(af.id)}});return W.queryBulletins(ad)},aa)};var K=function(Z,aa){return t(Z,function(ab,ad){var ac=ab.referencingComponents;var ae=false;C.each(ac,function(af,ai){var ag=ai.component;if(ag.referenceType==="ControllerService"){if(ag.state!=="DISABLED"){ae=true}var ah=C("div."+ag.id+"-state");I(ah,ag)}});m(ad);return ae===false},function(ab){var ad=[];var ac=ab.referencingComponents;C.each(ac,function(ae,ag){var af=ag.component;if(af.referenceType==="ControllerService"){ad.push(af.id)}});return W.queryBulletins(ad)},aa)};var r=function(ae,Z,ab,ad){var af={};a(Z.component.referencingComponents,af,true);var ac={id:Z.id,state:ab?"ENABLED":"DISABLED",referencingComponentRevisions:af};var aa=C.ajax({type:"PUT",url:Z.uri+"/references",data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return C.Deferred(function(ag){aa.done(function(ah){Z.component.referencingComponents=ah.controllerServiceReferencingComponents;var ai=q(Z.component);var aj=ae.data("gridInstance");var al=aj.getData();var ak=[];ai.forEach(function(am){o(am,al).done(function(an){if(ab){ak.push(Y(an,ad))}else{ak.push(K(an,ad))}})});C.when.apply(window,ak).done(function(){ag.resolve()}).fail(function(){ag.reject()})}).fail(function(){ag.reject()})}).promise()};var y=function(ac,aa){C("#disable-controller-service-id").text(aa.id);C("#disable-controller-service-name").text(aa.name);var Z=C("#disable-controller-service-referencing-components");L(ac,Z,aa.referencingComponents);var ab=[{buttonText:"Disable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){F(ac)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:Q}}];C("#disable-controller-service-dialog").modal("setButtonModel",ab).modal("show");W.queryBulletins([aa.id]).done(function(ad){k(ad.bulletinBoard.bulletins,C("#disable-controller-service-bulletins"))});U(Z)};var B=function(ac,aa){C("#enable-controller-service-id").text(aa.id);C("#enable-controller-service-name").text(aa.name);var Z=C("#enable-controller-service-referencing-components");L(ac,Z,aa.referencingComponents);var ab=[{buttonText:"Enable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){i(ac)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:Q}}];C("#enable-controller-service-dialog").modal("setButtonModel",ab).modal("show");W.queryBulletins([aa.id]).done(function(ad){k(ad.bulletinBoard.bulletins,C("#enable-controller-service-bulletins"))});U(Z)};var Q=function(){C(this).modal("hide")};var F=function(ai){var ac=C("#disable-controller-service-dialog");var ab=false;ac.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ab=true;ac.modal("setButtonModel",[]);C("#disable-controller-service-dialog div.controller-service-canceling").show()}}}]);C("#disable-controller-service-scope-container").hide();C("#disable-controller-service-progress-container").show();var ah=C("#disable-controller-service-id").text();var Z=ai.data("gridInstance");var ad=Z.getData();var aa=ad.getItemById(ah);var ae=aa.component;var aj=function(){return ab===false};var ag=function(){C("#disable-controller-service-dialog div.controller-service-canceling").hide();ac.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:Q}}])};if(A(ae.referencingComponents)){ag();j.showOkDialog({headerText:"Controller Service",dialogContent:"Unable to disable due to unauthorized referencing components."});return}C("#disable-progress-label").text("Steps to disable "+ae.name);var af=C("#disable-referencing-schedulable").addClass("ajax-loading");C.Deferred(function(ak){var al=E(ai,aa,false,aj);al.done(function(){af.removeClass("ajax-loading").addClass("ajax-complete");var am=C("#disable-referencing-services").addClass("ajax-loading");var an=r(ai,aa,false,aj);an.done(function(){am.removeClass("ajax-loading").addClass("ajax-complete");var ao=C("#disable-controller-service").addClass("ajax-loading");e(ai,aa,false,aj).done(function(){ak.resolve();ao.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){ak.reject();ao.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){ak.reject();am.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){ak.reject();af.removeClass("ajax-loading").addClass("ajax-error")})}).always(function(){h(ai,ae);ag();if(ab===true&&C("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to disable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var A=function(Z){var aa=false;C.each(Z,function(ab,ad){if(ad.permissions.canRead===false||ad.permissions.canWrite===false){aa=true;return false}var ac=ad.component;if(A(ac.referencingComponents)){aa=true;return false}});return aa};var i=function(ai){var Z=C("#enable-controller-service-dialog");var ac=false;var ah=C("#enable-controller-service-id").text();var aa=ai.data("gridInstance");var ad=aa.getData();var ab=ad.getItemById(ah);var ae=ab.component;var ak=C("#enable-controller-service-scope").combo("getSelectedOption").value;if(ak===M.serviceOnly){C("#enable-controller-service-progress li.referencing-component").hide()}Z.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac=true;Z.modal("setButtonModel",[]);C("#enable-controller-service-dialog div.controller-service-canceling").show()}}}]);C("#enable-controller-service-scope-container").hide();C("#enable-controller-service-progress-container").show();var aj=function(){return ac===false};var ag=function(){C("#enable-controller-service-dialog div.controller-service-canceling").hide();Z.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:Q}}])};if(ak===M.serviceAndReferencingComponents&&A(ae.referencingComponents)){ag();j.showOkDialog({headerText:"Controller Service",dialogContent:"Unable to enable due to unauthorized referencing components."});return}C("#enable-progress-label").text("Steps to enable "+ae.name);var af=C("#enable-controller-service").addClass("ajax-loading");C.Deferred(function(al){var am=e(ai,ab,true,aj);if(ak===M.serviceAndReferencingComponents){am.done(function(){af.removeClass("ajax-loading").addClass("ajax-complete");var an=C("#enable-referencing-services").addClass("ajax-loading");var ao=r(ai,ab,true,aj);ao.done(function(){an.removeClass("ajax-loading").addClass("ajax-complete");var ap=C("#enable-referencing-schedulable").addClass("ajax-loading");E(ai,ab,true,aj).done(function(){al.resolve();ap.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){al.reject();ap.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();af.removeClass("ajax-loading").addClass("ajax-error")})}else{am.done(function(){al.resolve();af.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){al.reject();af.removeClass("ajax-loading").addClass("ajax-error")})}}).always(function(){h(ai,ae);ag();if(ac===true&&C("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to enable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var J=function(aa){var Z=C("#controller-service-configuration").data("controllerServiceDetails");return C.ajax({type:"GET",url:Z.uri+"/descriptors",data:{propertyName:aa},dataType:"json"}).fail(d.handleAjaxError)};var P=function(Z){return C.Deferred(function(aa){C("#controller-service-properties").propertytable("saveRow");if(G()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){aa.resolve()},yesHandler:function(){var ab=C("#controller-service-configuration").data("controllerServiceDetails");x(Z,ab).done(function(){aa.resolve()}).fail(function(){aa.reject()})}})}else{aa.resolve()}}).promise()};var x=function(ab,Z){var ac=n();if(b(ac)){ac.revision=g.getRevision(Z);var aa=[];C.each(p(Z.component),function(ae,ag){var ad=!R.isUndefined(ac.component.properties)&&!R.isUndefined(ac.component.properties[ag.name]);var af=R.isDefinedAndNotNull(Z.component.properties[ag.name]);if(ad&&af){aa.push(Z.component.properties[ag.name])}});return C.ajax({type:"PUT",data:JSON.stringify(ac),url:Z.uri,dataType:"json",contentType:"application/json"}).done(function(ad){O(ab,ad);C.each(aa,function(ae,af){X(ab,af)})}).fail(v)}else{return C.Deferred(function(ad){ad.reject()}).promise()}};var p=function(aa){var Z=[];C.each(aa.descriptors,function(ab,ac){if(R.isDefinedAndNotNull(ac.identifiesControllerService)){Z.push(ac)}});return Z};var u=function(aa){var Z=[];C.each(p(aa),function(ab,ac){var ad=aa.properties[ac.name];if(R.isDefinedAndNotNull(ad)&&C.trim(ad).length>0){Z.push(ad)}});return Z};var V;var S={init:function(Z){N=Z;C("#controller-service-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"controller-service-standard-settings-tab-content"},{name:"Properties",tabContentId:"controller-service-properties-tab-content"},{name:"Comments",tabContentId:"controller-service-comments-tab-content"}],select:function(){c.removeAllPropertyDetailDialogs();if(C(this).text()==="Properties"){C("#controller-service-properties").propertytable("resetTableSize")}C("#controller-service-properties").propertytable("saveRow");var aa=C("#controller-service-referencing-components");U(aa)}});C("#controller-service-configuration").modal({headerText:"Configure Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var aa=C("#controller-service-referencing-components");R.cleanUpTooltips(aa,"div.referencing-component-state");R.cleanUpTooltips(aa,"div.referencing-component-bulletins");aa.css("border-width","0").empty();C("#controller-service-properties").propertytable("cancelEdit");C("#controller-service-properties").propertytable("clear");R.clearField("read-only-controller-service-comments");C("#controller-service-compatible-apis").empty();C("#controller-service-configuration").removeData("controllerServiceDetails")},open:function(){R.toggleScrollable(C("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});C("#disable-controller-service-dialog").modal({headerText:"Disable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ab=C(this);C("#disable-controller-service-scope-container").show();C("#disable-controller-service-progress-container").hide();C("#disable-controller-service-id").text("");C("#disable-controller-service-name").text("");C("#disable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();R.cleanUpTooltips(C("#disable-controller-service-service-container"),"#disable-controller-service-bulletins");C("div.disable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var aa=C("#disable-controller-service-referencing-components");R.cleanUpTooltips(aa,"div.referencing-component-state");R.cleanUpTooltips(aa,"div.referencing-component-bulletins");aa.css("border-width","0").empty()}}});C("#enable-controller-service-scope").combo({options:[{text:"Service only",value:M.serviceOnly,description:"Enable only this controller service"},{text:"Service and referencing components",value:M.serviceAndReferencingComponents,description:"Enable this controller service and enable/start all referencing components"}]});C("#enable-controller-service-dialog").modal({headerText:"Enable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ab=C(this);C("#enable-controller-service-scope-container").show();C("#enable-controller-service-progress-container").hide();C("#enable-controller-service-progress li.referencing-component").show();C("#enable-controller-service-id").text("");C("#enable-controller-service-name").text("");C("#enable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();R.cleanUpTooltips(C("#enable-controller-service-service-container"),"#enable-controller-service-bulletins");C("div.enable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var aa=C("#enable-controller-service-referencing-components");R.cleanUpTooltips(aa,"div.referencing-component-state");R.cleanUpTooltips(aa,"div.referencing-component-bulletins");aa.css("border-width","0").empty()}}})},showConfiguration:function(ac,aa){if(R.isUndefined(V)){V=ac}var ab=C("#controller-service-configuration");ab.find(".dialog-header .dialog-header-text").text("Configure Controller Service");if(ab.data("mode")!==M.edit||V!==ac){C("#controller-service-configuration .controller-service-read-only").hide();C("#controller-service-configuration .controller-service-editable").show();C("#controller-service-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-controller-service-property-container",descriptorDeferred:J,controllerServiceCreatedDeferred:function(af){var ae;var ag=af.component;if(R.isDefinedAndNotNull(ag.parentGroupId)){ae=M.urls.api+"/flow/process-groups/"+encodeURIComponent(ag.parentGroupId)+"/controller-services"}else{ae=M.urls.api+"/flow/controller/controller-services"}return N.loadControllerServices(ae,ac)},goToServiceDeferred:function(){return P(ac)}});ab.data("mode",M.edit)}V=ac;var ad=C.ajax({type:"GET",url:aa.uri,dataType:"json"});var Z=C.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(aa.id),dataType:"json"});C.when(ad,Z).done(function(aj,ai){aa=aj[0];var af=aa.component;var ak=ai[0].componentHistory;ab.data("controllerServiceDetails",aa);R.populateField("controller-service-id",af.id);R.populateField("controller-service-type",R.formatType(af));R.populateField("controller-service-bundle",R.formatBundle(af.bundle));C("#controller-service-name").val(af.name);C("#controller-service-comments").val(af.comments);if(!R.isEmpty(af.controllerServiceApis)){var ae=R.getFormattedServiceApis(af.controllerServiceApis);var ah=R.formatUnorderedList(ae);C("#controller-service-compatible-apis").append(ah)}else{C("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ag=C("#controller-service-referencing-components");L(ac,ag,af.referencingComponents);var al=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){C("#controller-service-properties").propertytable("saveRow");x(ac,aa).done(function(am){f(ac,am.component);ab.modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ab.modal("hide")}}}];if(R.isDefinedAndNotNull(af.customUiUrl)&&af.customUiUrl!==""){al.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var am=function(){ab.modal("hide");C("#shell-close-button").click();z.showCustomUi(aa,af.customUiUrl,true).done(function(){h(ac,af);H.showSettings()})};C("#controller-service-properties").propertytable("saveRow");if(G()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:am,yesHandler:function(){x(ac,aa).done(function(){am()})}})}else{am()}}}})}ab.modal("setButtonModel",al);C("#controller-service-properties").propertytable("setGroupId",af.parentGroupId).propertytable("loadProperties",af.properties,af.descriptors,ak.propertyHistory);ab.modal("show");U(ag);C("#controller-service-properties").propertytable("resetTableSize")}).fail(d.handleAjaxError)},showDetails:function(ac,aa){var ab=C("#controller-service-configuration");ab.find(".dialog-header .dialog-header-text").text("Controller Service Details");if(ab.data("mode")!==M.readOnly){C("#controller-service-configuration .controller-service-read-only").show();C("#controller-service-configuration .controller-service-editable").hide();C("#controller-service-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});ab.data("mode",M.readOnly)}var ad=C.ajax({type:"GET",url:aa.uri,dataType:"json"});var Z=C.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(aa.id),dataType:"json"});C.when(ad,Z).done(function(aj,ai){aa=aj[0];var af=aa.component;var ak=ai[0].componentHistory;ab.data("controllerServiceDetails",aa);R.populateField("controller-service-id",af.id);R.populateField("controller-service-type",R.formatType(af));R.populateField("controller-service-bundle",R.formatBundle(af.bundle));R.populateField("read-only-controller-service-name",af.name);R.populateField("read-only-controller-service-comments",af.comments);if(!R.isEmpty(af.controllerServiceApis)){var ae=R.getFormattedServiceApis(af.controllerServiceApis);var ah=R.formatUnorderedList(ae);C("#controller-service-compatible-apis").append(ah)}else{C("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ag=C("#controller-service-referencing-components");L(ac,ag,af.referencingComponents);var al=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ab.modal("hide")}}}];if(R.isDefinedAndNotNull(z)&&R.isDefinedAndNotNull(af.customUiUrl)&&af.customUiUrl!==""){al.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ab.modal("hide");C("#shell-close-button").click();z.showCustomUi(aa,af.customUiUrl,false).done(function(){H.showSettings()})}}})}ab.modal("setButtonModel",al);C("#controller-service-properties").propertytable("loadProperties",af.properties,af.descriptors,ak.propertyHistory);ab.modal("show");U(ag);C("#controller-service-properties").propertytable("resetTableSize")})},enable:function(aa,Z){B(aa,Z.component)},disable:function(aa,Z){y(aa,Z.component)},reloadReferencedServices:function(aa,Z){C.each(u(Z),function(ab,ac){X(aa,ac)})},promptToDeleteController:function(aa,Z){j.showYesNoDialog({headerText:"Delete Controller Service",dialogContent:"Delete controller service '"+R.escapeHtml(Z.component.name)+"'?",yesHandler:function(){S.remove(aa,Z)}})},remove:function(ab,Z){var aa=g.getRevision(Z);C.ajax({type:"DELETE",url:Z.uri+"?"+C.param({version:aa.version,clientId:aa.clientId}),dataType:"json"}).done(function(ac){var ad=ab.data("gridInstance");var ae=ad.getData();ae.deleteItem(Z.id);if(Z.permissions.canRead){f(ab,Z.component)}}).fail(d.handleAjaxError)}};return S}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Client","nf.Shell","nf.ProcessGroupConfiguration","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Common","nf.ControllerService","nf.ProcessGroup","nf.PolicyManagement","nf.ComponentState","nf.ComponentVersion","nf.ng.Bridge"],function(k,r,h,s,f,e,i,o,n,j,g,m,d,p,q,c,l){return(nf.ControllerServices=b(k,r,h,s,f,e,i,o,n,j,g,m,d,p,q,c,l))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerServices=b(require("jquery"),require("d3"),require("Slick"),require("nf.Client"),require("nf.Shell"),require("nf.ProcessGroupConfiguration"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Common"),require("nf.ControllerService"),require("nf.ProcessGroup"),require("nf.PolicyManagement"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.ng.Bridge")))}else{nf.ControllerServices=b(a.$,a.d3,a.Slick,a.nf.Client,a.nf.Shell,a.nf.ProcessGroupConfiguration,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Common,a.nf.ControllerService,a.nf.ProcessGroup,a.nf.PolicyManagement,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.ng.Bridge)}}}(this,function(w,G,a,f,E,z,J,b,I,i,F,H,t,r,c,p,m){var h=null;var j=false;var A={urls:{api:"../nifi-api",controllerServiceTypes:"../nifi-api/flow/controller-service-types"}};var v={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var k=function(M){return F.isBlank(M.usageRestriction)||F.canAccessRestrictedComponents()};var e=function(){return w("#controller-service-type-filter").val()};var x=function(){var M=w("#controller-service-types-table").data("gridInstance");if(F.isDefinedAndNotNull(M)){var N=M.getData();N.setFilterArgs({searchString:e()});N.refresh();w("#new-controller-service-dialog").modal("refreshButtons");if(N.getLength()>0){I.choseFirstRow(M);M.scrollRowToTop(0)}}};var y=function(){w("#controller-service-type-description").attr("title","").text("");w("#controller-service-type-name").attr("title","").text("");w("#controller-service-type-bundle").attr("title","").text("");w("#selected-controller-service-name").text("");w("#selected-controller-service-type").text("").removeData("bundle");w("#controller-service-description-container").hide()};var s=function(){y();var M=w("#controller-service-types-table").data("gridInstance");M.resetActiveCell()};var D=function(U,P){var S=L(U,P);var O=true;if(S){var T=w("#controller-service-tag-cloud").tagcloud("getSelectedTags");var R=T.length>0;if(R){O=n(T,U.tags)}}var Q=true;if(S&&O){var M=w("#controller-service-bundle-group-combo").combo("getSelectedOption");if(F.isDefinedAndNotNull(M)&&M.value!==""){Q=(U.bundle.group===M.value)}}var N=S&&O&&Q;if(N===false&&w("#selected-controller-service-type").text()===U.type){s()}return N};var L=function(O,N){if(N.searchString===""){return true}try{var R=new RegExp(N.searchString,"i")}catch(Q){return false}var P=O.label.search(R)>=0;var M=O.tags.search(R)>=0;return P||M};var n=function(O,M){var N=[];w.each(O,function(R,S){N.push(S)});var P=M.toLowerCase();var Q=true;w.each(N,function(R,S){if(P.indexOf(S)===-1){Q=false;return false}});return Q};var C=function(M,P){var O=w("#selected-controller-service-type").text();var N=w("#selected-controller-service-type").data("bundle");if(O===""){i.showOkDialog({headerText:"Controller Service",dialogContent:"The type of controller service to create must be selected."})}else{o(M,P,O,N)}};var o=function(N,Q,P,R){var M={revision:f.getRevision({revision:{version:0}}),component:{type:P,bundle:R}};var O=w.ajax({type:"POST",url:N,data:JSON.stringify(M),dataType:"json",contentType:"application/json"}).done(function(S){var T=Q.data("gridInstance");var V=T.getData();V.addItem(w.extend({type:"ControllerService",bulletins:[]},S));V.reSort();T.invalidate();var U=V.getRowById(S.id);I.choseRow(T,U);T.scrollRowIntoView(U)}).fail(b.handleAjaxError);w("#new-controller-service-dialog").modal("hide");return O};var l=function(){var O=[{id:"type",name:"Type",field:"label",formatter:F.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:F.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:F.genericValueFormatter}];var N=new a.Data.DataView({inlineFilters:false});N.setItems([]);N.setFilterArgs({searchString:e()});N.setFilter(D);F.sortType({columnId:"type",sortAsc:true},N);var M=new a.Grid("#controller-service-types-table",N,O,v);M.setSelectionModel(new a.RowSelectionModel());M.registerPlugin(new a.AutoTooltips());M.setSortColumn("type",true);M.onSort.subscribe(function(Q,P){F.sortType({columnId:P.sortCol.field,sortAsc:P.sortAsc},N)});M.onSelectedRowsChanged.subscribe(function(U,R){if(w.isArray(R.rows)&&R.rows.length===1){var P=R.rows[0];var T=M.getDataItem(P);if(F.isDefinedAndNotNull(T)){w("#controller-service-description-container").show();if(F.isBlank(T.description)){w("#controller-service-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{w("#controller-service-type-description").width(w("#controller-service-description-container").innerWidth()-1).html(T.description).ellipsis()}var Q=F.formatBundle(T.bundle);var S=F.formatType(T);w("#controller-service-type-name").text(S).attr("title",S);w("#controller-service-type-bundle").text(Q).attr("title",Q);w("#selected-controller-service-name").text(T.label);w("#selected-controller-service-type").text(T.type).data("bundle",T.bundle);w("#new-controller-service-dialog").modal("refreshButtons")}}});M.onViewportChanged.subscribe(function(Q,P){F.cleanUpTooltips(w("#controller-service-types-table"),"div.view-usage-restriction");F.cleanUpTooltips(w("#controller-service-types-table"),"div.controller-service-apis")});N.onRowCountChanged.subscribe(function(Q,P){M.updateRowCount();M.render();w("#displayed-controller-service-types").text(P.current)});N.onRowsChanged.subscribe(function(Q,P){M.invalidateRows(P.rows);M.render()});N.syncGridSelection(M,true);w("#controller-service-types-table").data("gridInstance",M).on("mouseenter","div.slick-cell",function(V){var W=w(this).find("div.view-usage-restriction");if(W.length&&!W.data("qtip")){var U=w(this).find("span.row-id").text();var S=N.getItemById(U);if(F.isDefinedAndNotNull(S.usageRestriction)){W.qtip(w.extend({},F.config.tooltipConfig,{content:S.usageRestriction,position:{container:w("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}var R=w(this).find("div.controller-service-apis");if(R.length&&!R.data("qtip")){var U=w(this).find("span.row-id").text();var S=N.getItemById(U);if(!F.isEmpty(S.controllerServiceApis)){var P=F.getFormattedServiceApis(S.controllerServiceApis);var Q=F.formatUnorderedList(P);var T=w('<div style="padding: 4px;"><p>Supports Controller Services</p><br/></div>').append(Q);R.qtip(w.extend({},F.config.tooltipConfig,{content:T,position:{container:w("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});w.ajax({type:"GET",url:A.urls.controllerServiceTypes,dataType:"json"}).done(function(Q){var T=0;var S=[];var P=G.set();N.beginUpdate();w.each(Q.controllerServiceTypes,function(U,V){P.add(V.bundle.group);N.addItem({id:T++,label:F.substringAfterLast(V.type,"."),type:V.type,bundle:V.bundle,controllerServiceApis:V.controllerServiceApis,description:F.escapeHtml(V.description),usageRestriction:F.escapeHtml(V.usageRestriction),tags:V.tags.join(", ")});w.each(V.tags,function(X,W){S.push(W.toLowerCase())})});N.endUpdate();N.reSort();M.invalidate();w("#total-controller-service-types, #displayed-controller-service-types").text(Q.controllerServiceTypes.length);w("#controller-service-tag-cloud").tagcloud({tags:S,select:x,remove:x});var R=[{text:"all groups",value:""}];P.forEach(function(U){R.push({text:U,value:U})});w("#controller-service-bundle-group-combo").combo({options:R,select:x})}).fail(b.handleAjaxError);w("#new-controller-service-dialog").modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){y();w("#controller-service-type-filter").val("");w("#controller-service-tag-cloud").tagcloud("clearSelectedTags");w("#controller-service-bundle-group-combo").combo("setSelectedOption",{value:""});x();var P=w("#controller-service-types-table").data("gridInstance");P.setSelectedRows([]);P.resetActiveCell()},resize:function(){w("#controller-service-type-description").width(w("#controller-service-description-container").innerWidth()-1).text(w("#controller-service-type-description").attr("title")).ellipsis()}}})};var q=function(Q,N,P,O,M){if(!M.permissions.canRead){return'<span class="blank">'+F.escapeHtml(M.id)+"</span>"}return F.escapeHtml(M.component.name)};var g=function(U,T,R,O,N){if(!N.permissions.canRead){return""}if(F.isDefinedAndNotNull(N.component.parentGroupId)){var S=J.getSelection();if(S.empty()===false){var Q=S.datum();if(Q.id===N.component.parentGroupId){if(Q.permissions.canRead){return F.escapeHtml(Q.component.name)}else{return F.escapeHtml(Q.id)}}}var M=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var P=N.component.parentGroupId;w.each(M,function(V,W){if(W.id===N.component.parentGroupId){P=W.label;return false}});return F.escapeHtml(P)}else{return"Controller"}};var u=function(M){var N=function(O){var R=J.getSelection();if(R.empty()===false){var Q=R.datum();if(Q.id===O){return Q.permissions.canWrite}}var P=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var S=false;w.each(P,function(T,U){if(U.id===O){S=U.permissions.canWrite;return false}});return S};if(F.isDefinedAndNotNull(M.component.parentGroupId)){return N(M.component.parentGroupId)}else{return F.canModifyController()}};var K=function(M,O){var N=function(W,V){if(W.permissions.canRead&&V.permissions.canRead){if(M.columnId==="moreDetails"){var S=0;if(!F.isEmpty(W.bulletins)){S=W.bulletins.length}var P=0;if(!F.isEmpty(V.bulletins)){P=V.bulletins.length}return S-P}else{if(M.columnId==="type"){var T=F.isDefinedAndNotNull(W.component[M.columnId])?F.substringAfterLast(W.component[M.columnId],"."):"";var R=F.isDefinedAndNotNull(V.component[M.columnId])?F.substringAfterLast(V.component[M.columnId],"."):"";return T===R?0:T>R?1:-1}else{if(M.columnId==="state"){var U="Invalid";if(F.isEmpty(W.component.validationErrors)){U=F.isDefinedAndNotNull(W.component[M.columnId])?W.component[M.columnId]:""}var Y="Invalid";if(F.isEmpty(V.component.validationErrors)){Y=F.isDefinedAndNotNull(V.component[M.columnId])?V.component[M.columnId]:""}return U===Y?0:U>Y?1:-1}else{var Q=F.isDefinedAndNotNull(W.component[M.columnId])?W.component[M.columnId]:"";var X=F.isDefinedAndNotNull(V.component[M.columnId])?V.component[M.columnId]:"";return Q===X?0:Q>X?1:-1}}}}else{if(!W.permissions.canRead&&!V.permissions.canRead){return 0}if(W.permissions.canRead){return 1}else{return -1}}};O.sort(N,M.sortAsc)};var B=function(S,M){var R=function(ab,V,aa,X,U){if(!U.permissions.canRead){return""}var W='<div title="Usage" class="pointer controller-service-usage fa fa-book" style="margin-top: 5px; margin-right: 3px;" ></div>';var Y=!F.isEmpty(U.component.validationErrors);var Z=!F.isEmpty(U.bulletins);if(Y){W+='<div class="pointer has-errors fa fa-warning" style="margin-top: 4px; margin-right: 3px; float: left;" ></div>'}if(Z){W+='<div class="has-bulletins fa fa-sticky-note-o" style="margin-top: 5px; margin-right: 3px; float: left;"></div>'}if(Y||Z){W+='<span class="hidden row-id">'+F.escapeHtml(U.id)+"</span>"}return W};var N=function(ab,V,aa,W,U){if(!U.permissions.canRead){return""}var Z="",X="";if(!F.isEmpty(U.component.validationErrors)){Z="invalid fa fa-warning";X="Invalid"}else{if(U.component.state==="DISABLED"){Z='disabled icon icon-enable-false"';X="Disabled"}else{if(U.component.state==="DISABLING"){Z='disabled icon icon-enable-false"';X="Disabling"}else{if(U.component.state==="ENABLED"){Z="enabled fa fa-flash";X="Enabled"}else{if(U.component.state==="ENABLING"){Z="enabled fa fa-flash";X="Enabling"}}}}}var Y='<div layout="row"><div class="'+Z+'" style="margin-top: 5px;"></div>';return Y+'<div class="status-text" style="margin-top: 4px;">'+X+"</div></div>"};var Q=function(aa,V,Z,X,U){var W="";if(U.permissions.canRead){var Y=false;if(F.isDefinedAndNotNull(U.component.parentGroupId)){if(U.component.parentGroupId===w("#process-group-id").text()){Y=true}}else{Y=true}if(Y===true){if(U.permissions.canWrite){if(U.component.state==="ENABLED"||U.component.state==="ENABLING"){W+='<div class="pointer view-controller-service fa fa-gear" title="View Configuration" style="margin-top: 2px; margin-right: 3px;" ></div>';W+='<div class="pointer disable-controller-service icon icon-enable-false" title="Disable" style="margin-top: 2px; margin-right: 3px;" ></div>'}else{if(U.component.state==="DISABLED"){W+='<div class="pointer edit-controller-service fa fa-gear" title="Configure" style="margin-top: 2px; margin-right: 3px;" ></div>';if(F.isEmpty(U.component.validationErrors)){W+='<div class="pointer enable-controller-service fa fa-flash" title="Enable" style="margin-top: 2px; margin-right: 3px;"></div>'}if(U.component.multipleVersionsAvailable===true){W+='<div title="Change Version" class="pointer change-version-controller-service fa fa-exchange" style="margin-top: 2px; margin-right: 3px;" ></div>'}if(u(U)){W+='<div class="pointer delete-controller-service fa fa-trash" title="Remove" style="margin-top: 2px; margin-right: 3px;" ></div>'}}}if(U.component.persistsState===true){W+='<div title="View State" class="pointer view-state-controller-service fa fa-tasks" style="margin-top: 2px; margin-right: 3px;" ></div>'}}else{if(Y===true){W+='<div class="pointer view-controller-service fa fa-gear" title="View Configuration" style="margin-top: 2px; margin-right: 3px;" ></div>'}}}else{W+='<div class="pointer go-to-controller-service fa fa-long-arrow-right" title="Go To" style="margin-top: 2px; margin-right: 3px;" ></div>'}}if(J.isManagedAuthorizer()&&F.canAccessTenants()){W+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key" style="margin-top: 2px;"></div>'}return W};var P=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:R,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",formatter:q,sortable:true,resizable:true},{id:"type",name:"Type",formatter:F.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:F.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"State",formatter:N,sortable:true,resizeable:true},{id:"parentGroupId",name:"Scope",formatter:g,sortable:true,resizeable:true}];P.push({id:"actions",name:"&nbsp;",resizable:false,formatter:Q,sortable:false,width:90,maxWidth:90});var T=new a.Data.DataView({inlineFilters:false});T.setItems([]);K({columnId:"name",sortAsc:true},T);var O=new a.Grid(S,T,P,v);O.setSelectionModel(new a.RowSelectionModel());O.registerPlugin(new a.AutoTooltips());O.setSortColumn("name",true);O.onSort.subscribe(function(V,U){K({columnId:U.sortCol.id,sortAsc:U.sortAsc},T)});O.onClick.subscribe(function(X,V){var W=w(X.target);var U=T.getItem(V.row);if(O.getColumns()[V.cell].id==="actions"){if(W.hasClass("edit-controller-service")){H.showConfiguration(S,U)}else{if(W.hasClass("view-controller-service")){H.showDetails(S,U)}else{if(W.hasClass("enable-controller-service")){H.enable(S,U)}else{if(W.hasClass("disable-controller-service")){H.disable(S,U)}else{if(W.hasClass("delete-controller-service")){H.promptToDeleteController(S,U)}else{if(W.hasClass("view-state-controller-service")){c.showState(U,U.state==="DISABLED")}else{if(W.hasClass("change-version-controller-service")){p.promptForVersionChange(U)}else{if(W.hasClass("edit-access-policies")){r.showControllerServicePolicy(U);w("#shell-close-button").click()}else{if(W.hasClass("go-to-controller-service")){t.enterGroup(U.component.parentGroupId);w.Deferred(function(Y){if(w("#process-group-configuration").is(":visible")){z.loadConfiguration(U.component.parentGroupId).done(function(){Y.resolve()})}else{z.showConfiguration(U.component.parentGroupId).done(function(){Y.resolve()})}}).done(function(){z.selectControllerService(U.id)})}}}}}}}}}}else{if(O.getColumns()[V.cell].id==="moreDetails"){if(W.hasClass("controller-service-usage")){w("#shell-close-button").click();E.showPage("../nifi-docs/documentation?"+w.param({select:U.component.type,group:U.component.bundle.group,artifact:U.component.bundle.artifact,version:U.component.bundle.version})).done(function(){if(F.isDefinedAndNotNull(U.component.parentGroupId)){var Y;var Z=t.get(U.component.parentGroupId);if(F.isDefinedAndNotNull(Z)){Y=Z.id}else{Y=J.getGroupId()}z.showConfiguration(Y)}else{M()}})}}}});T.onRowCountChanged.subscribe(function(V,U){O.updateRowCount();O.render()});T.onRowsChanged.subscribe(function(V,U){O.invalidateRows(U.rows);O.render()});T.syncGridSelection(O,true);S.data("gridInstance",O).on("mouseenter","div.slick-cell",function(ab){var Y=w(this).find("div.has-errors");if(Y.length&&!Y.data("qtip")){var aa=w(this).find("span.row-id").text();var U=T.getItemById(aa);var X=F.formatUnorderedList(U.component.validationErrors);if(F.isDefinedAndNotNull(X)){Y.qtip(w.extend({},F.config.tooltipConfig,{content:X,position:{target:"mouse",viewport:w("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var W=w(this).find("div.has-bulletins");if(W.length&&!W.data("qtip")){var V=w(this).find("span.row-id").text();var U=T.getItemById(V);var Z=F.getFormattedBulletins(U.bulletins);var X=F.formatUnorderedList(Z);if(F.isDefinedAndNotNull(X)){W.qtip(w.extend({},F.config.tooltipConfig,{content:X,position:{target:"mouse",viewport:w("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var d=function(M,N){return w.ajax({type:"GET",url:M,dataType:"json"}).done(function(O){var P=[];w.each(O.controllerServices,function(T,S){P.push(w.extend({type:"ControllerService",bulletins:[]},S))});F.cleanUpTooltips(N,"div.has-errors");F.cleanUpTooltips(N,"div.has-bulletins");var Q=N.data("gridInstance");var R=Q.getData();R.setItems(P);R.reSort();Q.invalidate();Q.render()})};return{init:function(N,M){if(!j){l();j=true}B(N,M)},promptNewControllerService:function(N,Q){var O=w("#controller-service-types-table").data("gridInstance");var M=O.getData();var P=[w.ui.keyCode.UP,w.ui.keyCode.PAGE_UP,w.ui.keyCode.DOWN,w.ui.keyCode.PAGE_DOWN];w("#controller-service-type-filter").off("keyup").on("keyup",function(U){var T=U.keyCode?U.keyCode:U.which;if(w.inArray(T,P)!==-1){return}if(T===w.ui.keyCode.ENTER){var R=O.getSelectedRows();if(R.length>0){var S=O.getDataItem(R[0]);if(k(S)){C(N,Q)}}}else{x()}});I.addKeydownListener("#controller-service-type-filter",O,M);w("#new-controller-service-dialog").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var R=O.getSelectedRows();if(R.length>0){var S=O.getDataItem(R[0]);return k(S)===false}else{return M.getLength()===0}},handler:{click:function(){C(N,Q)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w(this).modal("hide")}}}]).modal("show");if(h!==null){O.onDblClick.unsubscribe(h)}h=function(T,R){var S=O.getDataItem(R.row);if(k(S)){o(N,Q,S.type,S.bundle)}};O.onDblClick.subscribe(h);O.resizeCanvas();if(M.getLength()>0){I.choseFirstRow(O)}w("#controller-service-type-filter").focus()},resetTableSize:function(N){var M=N.data("gridInstance");if(F.isDefinedAndNotNull(M)){M.resizeCanvas()}},loadControllerServices:function(M,N){return d(M,N)},setBulletins:function(Q,N){var P=Q.data("gridInstance");var R=P.getData();R.beginUpdate();if(!F.isEmpty(N)){var O=G.nest().key(function(S){return S.sourceId}).map(N,G.map);O.forEach(function(U,S){var T=R.getItemById(U);if(F.isDefinedAndNotNull(T)){R.updateItem(U,w.extend(T,{bulletins:S}))}})}else{var M=R.getItems();w.each(M,function(T,S){R.updateItem(S.id,w.extend(S,{bulletins:[]}))})}R.endUpdate()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi"],function(f,i,d,e,k,j,c,g,h){return(nf.ReportingTask=b(f,i,d,e,k,j,c,g,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ReportingTask=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi")))}else{nf.ReportingTask=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi)}}}(this,function(f,g,i,l,v,a,c,o,d){var s;var t={edit:"edit",readOnly:"read-only",urls:{api:"../nifi-api"}};var h=t.urls.api+"/flow/controller/controller-services";var b=function(){return f("#controller-services-table")};var n=function(A,x,y){if(A.status===400){var B=A.responseText.split("\n");var z;if(B.length===1){z=f("<span></span>").text(B[0])}else{z=i.formatUnorderedList(B)}l.showOkDialog({dialogContent:z,headerText:"Reporting Task"})}else{g.handleAjaxError(A,x,y)}};var w=function(){var y=f("#reporting-task-configuration").data("reportingTaskDetails");if(f("#reporting-task-name").val()!==y.component.name){return true}if(f("#reporting-task-comments").val()!==y.component.comments){return true}if(f("#reporting-task-enabled").hasClass("checkbox-checked")&&y.component.state==="DISABLED"){return true}else{if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")&&(y.component.state==="RUNNING"||y.component.state==="STOPPED")){return true}}var z=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;if(z!==(y.component.schedulingStrategy+"")){return true}var x;if(z==="CRON_DRIVEN"){x=f("#reporting-task-cron-driven-scheduling-period")}else{x=f("#reporting-task-timer-driven-scheduling-period")}if(i.isDefinedAndNotNull(x)&&x.val()!==(y.component.schedulingPeriod+"")){return true}return f("#reporting-task-properties").propertytable("isSaveRequired")};var j=function(){var y=f("#reporting-task-properties").propertytable("marshalProperties");var B=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;var x;if(B==="CRON_DRIVEN"){x=f("#reporting-task-cron-driven-scheduling-period")}else{x=f("#reporting-task-timer-driven-scheduling-period")}var A={};A.id=f("#reporting-task-id").text();A.name=f("#reporting-task-name").val();A.schedulingStrategy=B;A.schedulingPeriod=x.val();A.comments=f("#reporting-task-comments").val();if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")){A.state="DISABLED"}else{if(f("#reporting-task-enabled").hasClass("checkbox-checked")){A.state="STOPPED"}}if(f.isEmptyObject(y)===false){A.properties=y}var z={};z.component=A;return z};var r=function(x){var z=[];var y=x.component;if(i.isBlank(y.schedulingPeriod)){z.push("Run schedule must be specified")}if(z.length>0){l.showOkDialog({dialogContent:i.formatUnorderedList(z),headerText:"Reporting Task"});return false}else{return true}};var q=function(y){var A=f("#reporting-tasks-table").data("gridInstance");var x=A.getData();var z=x.getItemById(y.id);x.updateItem(y.id,f.extend({type:"ReportingTask",bulletins:z.bulletins},y))};var e=function(z,y){var x={revision:v.getRevision(z),component:{id:z.id,state:y===true?"RUNNING":"STOPPED"}};return f.ajax({type:"PUT",url:z.uri,data:JSON.stringify(x),dataType:"json",contentType:"application/json"}).done(function(A){q(A);a.reloadReferencedServices(b(),A.component)}).fail(g.handleAjaxError)};var m=function(){return f.Deferred(function(x){f("#reporting-task-properties").propertytable("saveRow");if(w()){l.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){x.resolve()},yesHandler:function(){var y=f("#reporting-task-configuration").data("reportingTaskDetails");k(y).done(function(){x.resolve()}).fail(function(){x.reject()})}})}else{x.resolve()}}).promise()};var k=function(y){var x=j();if(r(x)){x.revision=v.getRevision(y);return f.ajax({type:"PUT",data:JSON.stringify(x),url:y.uri,dataType:"json",contentType:"application/json"}).done(function(z){q(z)}).fail(n)}else{return f.Deferred(function(z){z.reject()}).promise()}};var p=function(x){var y=f("#reporting-task-configuration").data("reportingTaskDetails");return f.ajax({type:"GET",url:y.uri+"/descriptors",data:{propertyName:x},dataType:"json"}).fail(g.handleAjaxError)};var u={init:function(x){s=x;f("#reporting-task-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"reporting-task-standard-settings-tab-content"},{name:"Properties",tabContentId:"reporting-task-properties-tab-content"},{name:"Comments",tabContentId:"reporting-task-comments-tab-content"}],select:function(){o.removeAllPropertyDetailDialogs();if(f(this).text()==="Properties"){f("#reporting-task-properties").propertytable("resetTableSize")}f("#reporting-task-properties").propertytable("saveRow")}});f("#reporting-task-configuration").data("mode",t.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Reporting Task",handler:{close:function(){f("#reporting-task-properties").propertytable("cancelEdit");f("#reporting-task-properties").propertytable("clear");i.clearField("read-only-reporting-task-comments");f("#reporting-task-configuration").removeData("reportingTaskDetails")},open:function(){i.toggleScrollable(f("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});f("#reporting-task-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:p,controllerServiceCreatedDeferred:function(y){return c.loadControllerServices(h,f("#controller-services-table"))},goToServiceDeferred:m})},showConfiguration:function(y){var z=f("#reporting-task-configuration");if(z.data("mode")===t.readOnly){f("#reporting-task-configuration .reporting-task-read-only").hide();f("#reporting-task-configuration .reporting-task-editable").show();f("#reporting-task-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:p,controllerServiceCreatedDeferred:function(B){return c.loadControllerServices(h,f("#controller-services-table"))},goToServiceDeferred:m});z.data("mode",t.edit)}var A=f.ajax({type:"GET",url:y.uri,dataType:"json"});var x=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"});f.when(A,x).done(function(D,I){y=D[0];var J=y.component;var C=I[0].componentHistory;f("#reporting-task-configuration").data("reportingTaskDetails",y);var G="checkbox-checked";if(J.state==="DISABLED"){G="checkbox-unchecked"}i.populateField("reporting-task-id",J.id);i.populateField("reporting-task-type",i.formatType(J));i.populateField("reporting-task-bundle",i.formatBundle(J.bundle));f("#reporting-task-name").val(J.name);f("#reporting-task-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(G);f("#reporting-task-comments").val(J.comments);var E=J.defaultSchedulingPeriod;var B=f("#reporting-task-cron-driven-scheduling-period").val(E.CRON_DRIVEN);var F=f("#reporting-task-timer-driven-scheduling-period").val(E.TIMER_DRIVEN);if(J.schedulingStrategy==="CRON_DRIVEN"){B.val(J.schedulingPeriod)}else{F.val(J.schedulingPeriod)}f("#reporting-task-scheduling-strategy-combo").combo({options:[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Reporting task will be scheduled to run on an interval defined by the run schedule."},{text:"CRON driven",value:"CRON_DRIVEN",description:"Reporting task will be scheduled to run on at specific times based on the specified CRON string."}],selectedOption:{value:J.schedulingStrategy},select:function(K){if(K.value==="CRON_DRIVEN"){F.hide();B.show()}else{F.show();B.hide()}}});var H=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#reporting-task-properties").propertytable("saveRow");k(y).done(function(K){a.reloadReferencedServices(b(),K.component);f("#reporting-task-configuration").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#reporting-task-configuration").modal("hide")}}}];if(i.isDefinedAndNotNull(J.customUiUrl)&&J.customUiUrl!==""){H.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var K=function(){f("#reporting-task-configuration").modal("hide");f("#shell-close-button").click();d.showCustomUi(y,J.customUiUrl,true).done(function(){u.reload(y.id).done(function(L){a.reloadReferencedServices(b(),L.reportingTask)});s.showSettings()})};f("#reporting-task-properties").propertytable("saveRow");if(w()){l.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:K,yesHandler:function(){k(y).done(function(){K()})}})}else{K()}}}})}f("#reporting-task-configuration").modal("setButtonModel",H);f("#reporting-task-properties").propertytable("setGroupId",J.parentGroupId).propertytable("loadProperties",J.properties,J.descriptors,C.propertyHistory);f("#reporting-task-configuration").modal("show");f("#reporting-task-properties").propertytable("resetTableSize")}).fail(g.handleAjaxError)},showDetails:function(y){var z=f("#reporting-task-configuration");if(z.data("mode")===t.edit){f("#reporting-task-configuration .reporting-task-read-only").show();f("#reporting-task-configuration .reporting-task-editable").hide();f("#reporting-task-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});z.data("mode",t.readOnly)}var A=f.ajax({type:"GET",url:y.uri,dataType:"json"});var x=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"});f.when(A,x).done(function(B,C){y=B[0];var G=y.component;var D=C[0].componentHistory;i.populateField("reporting-task-id",G.id);i.populateField("reporting-task-type",i.substringAfterLast(G.type,"."));i.populateField("reporting-task-bundle",i.formatBundle(G.bundle));i.populateField("read-only-reporting-task-name",G.name);i.populateField("read-only-reporting-task-comments",G.comments);var F=G.schedulingStrategy;if(F==="CRON_DRIVEN"){F="CRON driven"}else{F="Timer driven"}i.populateField("read-only-reporting-task-scheduling-strategy",F);i.populateField("read-only-reporting-task-scheduling-period",G.schedulingPeriod);var E=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){z.modal("hide")}}}];if(i.isDefinedAndNotNull(d)&&i.isDefinedAndNotNull(G.customUiUrl)&&G.customUiUrl!==""){E.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z.modal("hide");f("#shell-close-button").click();d.showCustomUi(y,G.customUiUrl,false).done(function(){s.showSettings()})}}})}z.modal("setButtonModel",E).modal("show");f("#reporting-task-properties").propertytable("loadProperties",G.properties,G.descriptors,D.propertyHistory);z.modal("show");f("#reporting-task-properties").propertytable("resetTableSize")})},start:function(x){e(x,true)},stop:function(x){e(x,false)},reload:function(A){var z=f("#reporting-tasks-table").data("gridInstance");var x=z.getData();var y=x.getItemById(A);return f.ajax({type:"GET",url:y.uri,dataType:"json"}).done(function(B){q(B)}).fail(g.handleAjaxError)},promptToDeleteReportingTask:function(x){l.showYesNoDialog({headerText:"Delete Reporting Task",dialogContent:"Delete reporting task '"+i.escapeHtml(x.component.name)+"'?",yesHandler:function(){u.remove(x)}})},remove:function(y){var x=v.getRevision(y);f.ajax({type:"DELETE",url:y.uri+"?"+f.param({version:x.version,clientId:x.clientId}),dataType:"json"}).done(function(A){var B=f("#reporting-tasks-table").data("gridInstance");var z=B.getData();z.deleteItem(y.id)}).fail(g.handleAjaxError)}};return u}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.FilteredDialogCommon","nf.ReportingTask","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement"],function(j,f,p,q,i,g,h,d,l,k,m,e,o,c,n){return(nf.Settings=b(j,f,p,q,i,g,h,d,l,k,m,e,o,c,n))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.ReportingTask"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.ReportingTask,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement)}}}(this,function(z,a,N,i,k,L,R,G,d,P,A,J,e,s,v){var E={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks",registries:"../nifi-api/controller/registry-clients"}};var y={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var r=function(){return z("#controller-services-table")};var m=function(V){var X=Q();var W={revision:i.getRevision({revision:{version:V}}),component:X};z.ajax({type:"PUT",url:E.urls.controllerConfig,data:JSON.stringify(W),dataType:"json",contentType:"application/json"}).done(function(Y){k.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});z("#settings-save").off("click").on("click",function(){m(Y.revision.version)})}).fail(d.handleAjaxError)};var j=function(){};var Q=function(){var V={};V.maxTimerDrivenThreadCount=z("#maximum-timer-driven-thread-count-field").val();V.maxEventDrivenThreadCount=z("#maximum-event-driven-thread-count-field").val();return V};var U=function(X,W){if(W.searchString===""){return true}try{var aa=new RegExp(W.searchString,"i")}catch(Z){return false}var Y=X.label.search(aa)>=0;var V=X.tags.search(aa)>=0;return Y||V};var o=function(X,V){var W=[];z.each(X,function(aa,ab){W.push(ab)});var Y=V.toLowerCase();var Z=true;z.each(W,function(aa,ab){if(Y.indexOf(ab)===-1){Z=false;return false}});return Z};var n=function(V){return L.isBlank(V.usageRestriction)||L.canAccessRestrictedComponents()};var u=function(Z,W,Y,X,V){if(!V.permissions.canRead){return'<span class="blank">'+L.escapeHtml(V.id)+"</span>"}return L.escapeHtml(V.component.name)};var S=function(V,X){var W=function(af,ae){if(af.permissions.canRead&&ae.permissions.canRead){if(V.columnId==="moreDetails"){var ab=0;if(!L.isEmpty(af.bulletins)){ab=af.bulletins.length}var Y=0;if(!L.isEmpty(ae.bulletins)){Y=ae.bulletins.length}return ab-Y}else{if(V.columnId==="type"){var ac=L.isDefinedAndNotNull(af.component[V.columnId])?L.substringAfterLast(af.component[V.columnId],"."):"";var aa=L.isDefinedAndNotNull(ae.component[V.columnId])?L.substringAfterLast(ae.component[V.columnId],"."):"";return ac===aa?0:ac>aa?1:-1}else{if(V.columnId==="state"){var ad="Invalid";if(L.isEmpty(af.component.validationErrors)){ad=L.isDefinedAndNotNull(af.component[V.columnId])?af.component[V.columnId]:""}var ah="Invalid";if(L.isEmpty(ae.component.validationErrors)){ah=L.isDefinedAndNotNull(ae.component[V.columnId])?ae.component[V.columnId]:""}return ad===ah?0:ad>ah?1:-1}else{var Z=L.isDefinedAndNotNull(af.component[V.columnId])?af.component[V.columnId]:"";var ag=L.isDefinedAndNotNull(ae.component[V.columnId])?ae.component[V.columnId]:"";return Z===ag?0:Z>ag?1:-1}}}}else{if(!af.permissions.canRead&&!ae.permissions.canRead){return 0}if(af.permissions.canRead){return 1}else{return -1}}};X.sort(W,V.sortAsc)};var B=function(){return z("#reporting-task-type-filter").val()};var p=function(){var W=z("#reporting-task-types-table").data("gridInstance");if(L.isDefinedAndNotNull(W)){var V=W.getData();V.setFilterArgs({searchString:B()});V.refresh();z("#new-reporting-task-dialog").modal("refreshButtons");if(V.getLength()>0){P.choseFirstRow(W)}}};var O=function(){z("#reporting-task-type-description").attr("title","").text("");z("#reporting-task-type-name").attr("title","").text("");z("#reporting-task-type-bundle").attr("title","").text("");z("#selected-reporting-task-name").text("");z("#selected-reporting-task-type").text("").removeData("bundle");z("#reporting-task-description-container").hide()};var h=function(){O();var V=z("#reporting-task-types-table").data("gridInstance");V.resetActiveCell()};var H=function(ad,Y){var ab=U(ad,Y);var X=true;if(ab){var ac=z("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var aa=ac.length>0;if(aa){X=o(ac,ad.tags)}}var Z=true;if(ab&&X){var V=z("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(L.isDefinedAndNotNull(V)&&V.value!==""){Z=(ad.bundle.group===V.value)}}var W=ab&&X&&Z;if(W===false&&z("#selected-reporting-task-type").text()===ad.type){h()}return W};var K=function(){var W=z("#selected-reporting-task-type").text();var V=z("#selected-reporting-task-type").data("bundle");if(W===""){k.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{l(W,V)}};var l=function(V,X){var Y={revision:i.getRevision({revision:{version:0}}),component:{type:V,bundle:X}};var W=z.ajax({type:"POST",url:E.urls.createReportingTask,data:JSON.stringify(Y),dataType:"json",contentType:"application/json"}).done(function(aa){var ac=z("#reporting-tasks-table").data("gridInstance");var Z=ac.getData();Z.addItem(z.extend({type:"ReportingTask",bulletins:[]},aa));Z.reSort();ac.invalidate();var ab=Z.getRowById(aa.id);P.choseRow(ac,ab);ac.scrollRowIntoView(ab)}).fail(d.handleAjaxError);z("#new-reporting-task-dialog").modal("hide");return W};var f=function(){var V={revision:i.getRevision({revision:{version:0}}),component:{name:z("#registry-name").val(),uri:z("#registry-location").val(),description:z("#registry-description").val()}};var W=z.ajax({type:"POST",url:E.urls.registries,data:JSON.stringify(V),dataType:"json",contentType:"application/json"}).done(function(aa){var X=z("#registries-table").data("gridInstance");var Y=X.getData();Y.addItem(z.extend({type:"Registry"},aa));Y.reSort();X.invalidate();var Z=Y.getRowById(aa.id);P.choseRow(X,Z);X.scrollRowIntoView(Z)}).fail(d.handleAjaxError);z("#registry-configuration-dialog").modal("hide");return W};var x=function(Z){var W=z("#registries-table").data("gridInstance");var X=W.getData();var aa=X.getItemById(Z);var Y={revision:i.getRevision(aa),component:{id:Z,name:z("#registry-name").val(),uri:z("#registry-location").val(),description:z("#registry-description").val()}};var V=z.ajax({type:"PUT",url:aa.uri,data:JSON.stringify(Y),dataType:"json",contentType:"application/json"}).done(function(ab){X.updateItem(Z,z.extend({type:"Registry"},ab))}).fail(d.handleAjaxError);z("#registry-configuration-dialog").modal("hide");return V};var g=function(){var W=[{id:"type",name:"Type",field:"label",formatter:L.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:L.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:L.genericValueFormatter}];var V=new a.Data.DataView({inlineFilters:false});V.setItems([]);V.setFilterArgs({searchString:B()});V.setFilter(H);L.sortType({columnId:"type",sortAsc:true},V);var Y=new a.Grid("#reporting-task-types-table",V,W,y);Y.setSelectionModel(new a.RowSelectionModel());Y.registerPlugin(new a.AutoTooltips());Y.setSortColumn("type",true);Y.onSort.subscribe(function(aa,Z){L.sortType({columnId:Z.sortCol.field,sortAsc:Z.sortAsc},V)});Y.onSelectedRowsChanged.subscribe(function(ae,ab){if(z.isArray(ab.rows)&&ab.rows.length===1){var ad=ab.rows[0];var Z=Y.getDataItem(ad);if(L.isDefinedAndNotNull(Z)){z("#reporting-task-description-container").show();if(L.isBlank(Z.description)){z("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{z("#reporting-task-type-description").width(z("#reporting-task-description-container").innerWidth()-1).html(Z.description).ellipsis()}var aa=L.formatBundle(Z.bundle);var ac=L.formatType(Z);z("#reporting-task-type-name").text(ac).attr("title",ac);z("#reporting-task-type-bundle").text(aa).attr("title",aa);z("#selected-reporting-task-name").text(Z.label);z("#selected-reporting-task-type").text(Z.type).data("bundle",Z.bundle);z("#new-reporting-task-dialog").modal("refreshButtons")}}});Y.onDblClick.subscribe(function(ab,aa){var Z=Y.getDataItem(aa.row);if(n(Z)){l(Z.type,Z.bundle)}});Y.onViewportChanged.subscribe(function(aa,Z){L.cleanUpTooltips(z("#reporting-task-types-table"),"div.view-usage-restriction")});V.onRowCountChanged.subscribe(function(aa,Z){Y.updateRowCount();Y.render();z("#displayed-reporting-task-types").text(Z.current)});V.onRowsChanged.subscribe(function(aa,Z){Y.invalidateRows(Z.rows);Y.render()});V.syncGridSelection(Y,true);z("#reporting-task-types-table").data("gridInstance",Y).on("mouseenter","div.slick-cell",function(ab){var ac=z(this).find("div.view-usage-restriction");if(ac.length&&!ac.data("qtip")){var aa=z(this).find("span.row-id").text();var Z=V.getItemById(aa);if(L.isDefinedAndNotNull(Z.usageRestriction)){ac.qtip(z.extend({},L.config.tooltipConfig,{content:Z.usageRestriction,position:{container:z("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});z.ajax({type:"GET",url:E.urls.reportingTaskTypes,dataType:"json"}).done(function(aa){var ad=0;var ac=[];var Z=N.set();V.beginUpdate();z.each(aa.reportingTaskTypes,function(ae,af){Z.add(af.bundle.group);V.addItem({id:ad++,label:L.substringAfterLast(af.type,"."),type:af.type,bundle:af.bundle,description:L.escapeHtml(af.description),usageRestriction:L.escapeHtml(af.usageRestriction),tags:af.tags.join(", ")});z.each(af.tags,function(ah,ag){ac.push(ag.toLowerCase())})});V.endUpdate();V.reSort();Y.invalidate();z("#total-reporting-task-types, #displayed-reporting-task-types").text(aa.reportingTaskTypes.length);z("#reporting-task-tag-cloud").tagcloud({tags:ac,select:p,remove:p});var ab=[{text:"all groups",value:""}];Z.forEach(function(ae){ab.push({text:ae,value:ae})});z("#reporting-task-bundle-group-combo").combo({options:ab,select:p})}).fail(d.handleAjaxError);var X=[z.ui.keyCode.UP,z.ui.keyCode.PAGE_UP,z.ui.keyCode.DOWN,z.ui.keyCode.PAGE_DOWN];z("#reporting-task-type-filter").off("keyup").on("keyup",function(ac){var ab=ac.keyCode?ac.keyCode:ac.which;if(z.inArray(ab,X)!==-1){return}if(ab===z.ui.keyCode.ENTER){var Z=Y.getSelectedRows();if(Z.length>0){var aa=Y.getDataItem(Z[0]);if(n(aa)){K()}}}else{p()}});P.addKeydownListener("#reporting-task-type-filter",Y,Y.getData());z("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var Z=Y.getSelectedRows();if(Z.length>0){var aa=Y.getDataItem(Z[0]);return n(aa)===false}else{return Y.getData().getLength()===0}},handler:{click:function(){K()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z(this).modal("hide")}}}],handler:{close:function(){O();z("#reporting-task-type-filter").val("");z("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");z("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});p();var Z=z("#reporting-task-types-table").data("gridInstance");Z.setSelectedRows([]);Z.resetActiveCell()},resize:function(){z("#reporting-task-type-description").width(z("#reporting-task-description-container").innerWidth()-1).text(z("#reporting-task-type-description").attr("title")).ellipsis()}}});z("#registry-configuration-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){z("#registry-id").text("");z("#registry-name").val("");z("#registry-location").val("");z("#registry-description").val("")}}})};var c=function(){g();var Z=function(ai,ac,ah,ae,ab){if(!ab.permissions.canRead){return""}var ad='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';ad+='<div title="Usage" class="pointer reporting-task-usage fa fa-book"></div>';var af=!L.isEmpty(ab.component.validationErrors);var ag=!L.isEmpty(ab.bulletins);if(af){ad+='<div class="pointer has-errors fa fa-warning" ></div>'}if(ag){ad+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(af||ag){ad+='<span class="hidden row-id">'+L.escapeHtml(ab.component.id)+"</span>"}return ad};var aa=function(aj,ai,ah,ad,ab){if(!ab.permissions.canRead){return""}var af="",ag="";if(!L.isEmpty(ab.component.validationErrors)){ag="Invalid";af="invalid fa fa-warning"}else{if(ab.component.state==="STOPPED"){ag="Stopped";af="fa fa-stop stopped"}else{if(ab.component.state==="RUNNING"){ag="Running";af="fa fa-play running"}else{ag="Disabled";af="icon icon-enable-false disabled"}}}var ae="";if(L.isDefinedAndNotNull(ab.component.activeThreadCount)&&ab.component.activeThreadCount>0){ae="("+ab.component.activeThreadCount+")"}var ac='<div layout="row"><div class="'+af+'" style="margin-top: 3px;"></div>';return ac+'<div class="status-text" style="margin-top: 4px;">'+L.escapeHtml(ag)+'</div><div style="float: left; margin-left: 4px;">'+L.escapeHtml(ae)+"</div></div>"};var Y=function(ag,ac,af,ae,ab){var ad="";if(ab.permissions.canRead&&ab.permissions.canWrite){if(ab.component.state==="RUNNING"){ad+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop" style="margin-top: 2px; margin-right: 3px;" ></div>'}else{if(ab.component.state==="STOPPED"||ab.component.state==="DISABLED"){ad+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil" style="margin-top: 2px; margin-right: 3px;" ></div>';if(ab.component.state==="STOPPED"&&L.isEmpty(ab.component.validationErrors)){ad+='<div title="Start" class="pointer start-reporting-task fa fa-play" style="margin-top: 2px; margin-right: 3px;"></div>'}if(ab.component.multipleVersionsAvailable===true){ad+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange" style="margin-top: 2px; margin-right: 3px;" ></div>'}if(L.canModifyController()){ad+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash" style="margin-top: 2px; margin-right: 3px;" ></div>'}}}if(ab.component.persistsState===true){ad+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks" style="margin-top: 2px; margin-right: 3px;" ></div>'}}if(R.isManagedAuthorizer()&&L.canAccessTenants()){ad+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key" style="margin-top: 2px;"></div>'}return ad};var V=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:Z,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:u},{id:"type",name:"Type",formatter:L.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:L.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:aa}];V.push({id:"actions",name:"&nbsp;",resizable:false,formatter:Y,sortable:false,width:90,maxWidth:90});var X=new a.Data.DataView({inlineFilters:false});X.setItems([]);S({columnId:"name",sortAsc:true},X);var W=new a.Grid("#reporting-tasks-table",X,V,y);W.setSelectionModel(new a.RowSelectionModel());W.registerPlugin(new a.AutoTooltips());W.setSortColumn("name",true);W.onSort.subscribe(function(ac,ab){S({columnId:ab.sortCol.id,sortAsc:ab.sortAsc},X)});W.onClick.subscribe(function(af,ac){var ae=z(af.target);var ad=X.getItem(ac.row);if(W.getColumns()[ac.cell].id==="actions"){if(ae.hasClass("edit-reporting-task")){A.showConfiguration(ad)}else{if(ae.hasClass("start-reporting-task")){A.start(ad)}else{if(ae.hasClass("stop-reporting-task")){A.stop(ad)}else{if(ae.hasClass("delete-reporting-task")){A.promptToDeleteReportingTask(ad)}else{if(ae.hasClass("view-state-reporting-task")){var ab=ad.component.state==="STOPPED"&&ad.component.activeThreadCount===0;e.showState(ad,ab)}else{if(ae.hasClass("change-version-reporting-task")){s.promptForVersionChange(ad)}else{if(ae.hasClass("edit-access-policies")){v.showReportingTaskPolicy(ad);z("#shell-close-button").click()}}}}}}}}else{if(W.getColumns()[ac.cell].id==="moreDetails"){if(ae.hasClass("view-reporting-task")){A.showDetails(ad)}else{if(ae.hasClass("reporting-task-usage")){z("#shell-close-button").click();J.showPage("../nifi-docs/documentation?"+z.param({select:ad.component.type,group:ad.component.bundle.group,artifact:ad.component.bundle.artifact,version:ad.component.bundle.version})).done(function(){D.showSettings()})}}}}});X.onRowCountChanged.subscribe(function(ac,ab){W.updateRowCount();W.render()});X.onRowsChanged.subscribe(function(ac,ab){W.invalidateRows(ab.rows);W.render()});X.syncGridSelection(W,true);z("#reporting-tasks-table").data("gridInstance",W).on("mouseenter","div.slick-cell",function(ah){var af=z(this).find("div.has-errors");if(af.length&&!af.data("qtip")){var ab=z(this).find("span.row-id").text();var ad=X.getItemById(ab);var ae=L.formatUnorderedList(ad.component.validationErrors);if(L.isDefinedAndNotNull(ae)){af.qtip(z.extend({},L.config.tooltipConfig,{content:ae,position:{target:"mouse",viewport:z("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ac=z(this).find("div.has-bulletins");if(ac.length&&!ac.data("qtip")){var ab=z(this).find("span.row-id").text();var ad=X.getItemById(ab);var ag=L.getFormattedBulletins(ad.bulletins);var ae=L.formatUnorderedList(ag);if(L.isDefinedAndNotNull(ae)){ac.qtip(z.extend({},L.config.tooltipConfig,{content:ae,position:{target:"mouse",viewport:z("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var t=function(){var aa=function(af,ac,ae,ad,ab){if(!ab.permissions.canRead){return'<span class="blank">'+L.escapeHtml(ab.id)+"</span>"}return L.escapeHtml(ab.component.uri)};var Y=function(af,ac,ae,ad,ab){if(!ab.permissions.canRead){return'<span class="blank">'+L.escapeHtml(ab.id)+"</span>"}return L.escapeHtml(ab.component.description)};var W=function(ag,ac,af,ae,ab){var ad="";if(L.canModifyController()){ad+='<div title="Edit" class="pointer edit-registry fa fa-pencil" style="margin-top: 2px; margin-right: 3px;" ></div>';ad+='<div title="Remove" class="pointer remove-registry fa fa-trash" style="margin-top: 2px; margin-right: 3px;" ></div>'}return ad};var Z=[{id:"name",name:"Name",field:"name",formatter:u,sortable:true,resizable:true},{id:"uri",name:"Location",field:"uri",formatter:aa,sortable:true,resizable:true},{id:"description",name:"Description",field:"description",formatter:Y,sortable:true,resizable:true}];Z.push({id:"actions",name:"&nbsp;",resizable:false,formatter:W,sortable:false,width:90,maxWidth:90});var X=new a.Data.DataView({inlineFilters:false});X.setItems([]);S({columnId:"name",sortAsc:true},X);var V=new a.Grid("#registries-table",X,Z,y);V.setSelectionModel(new a.RowSelectionModel());V.registerPlugin(new a.AutoTooltips());V.setSortColumn("name",true);V.onSort.subscribe(function(ac,ab){S({columnId:ab.sortCol.id,sortAsc:ab.sortAsc},X)});V.onClick.subscribe(function(ad,ab){var ac=z(ad.target);var ae=X.getItem(ab.row);if(V.getColumns()[ab.cell].id==="actions"){if(ac.hasClass("edit-registry")){C(ae)}else{if(ac.hasClass("remove-registry")){q(ae)}}}else{if(V.getColumns()[ab.cell].id==="moreDetails"){}}});X.onRowCountChanged.subscribe(function(ac,ab){V.updateRowCount();V.render()});X.onRowsChanged.subscribe(function(ac,ab){V.invalidateRows(ab.rows);V.render()});X.syncGridSelection(V,true);z("#registries-table").data("gridInstance",V)};var C=function(V){z("#registry-id").text(V.id);z("#registry-name").val(V.component.name);z("#registry-location").val(V.component.uri);z("#registry-description").val(V.component.description);z("#registry-configuration-dialog").modal("setHeaderText","Edit Registry Client").modal("setButtonModel",[{buttonText:"Update",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){x(V.id)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z(this).modal("hide")}}}]).modal("show")};var q=function(V){k.showYesNoDialog({headerText:"Delete Registry",dialogContent:"Delete registry '"+L.escapeHtml(V.component.name)+"'?",yesHandler:function(){b(V)}})};var b=function(W){var V=i.getRevision(W);z.ajax({type:"DELETE",url:W.uri+"?"+z.param({version:V.version,clientId:V.clientId}),dataType:"json"}).done(function(Y){var X=z("#registries-table").data("gridInstance");var Z=X.getData();Z.deleteItem(W.id)}).fail(d.handleAjaxError)};var M=function(){var ab=function(){z("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized");z("#read-only-maximum-event-driven-thread-count-field").addClass("unset").text("Unauthorized")};var Z=function(ac){if(ac){z("#general-settings div.editable").show();z("#general-settings div.read-only").hide();z("#settings-save").show()}else{z("#general-settings div.editable").hide();z("#general-settings div.read-only").show();z("#settings-save").hide()}};var Y=z.Deferred(function(ac){z.ajax({type:"GET",url:E.urls.controllerConfig,dataType:"json"}).done(function(ad){if(ad.permissions.canWrite){z("#maximum-timer-driven-thread-count-field").removeClass("unset").val(ad.component.maxTimerDrivenThreadCount);z("#maximum-event-driven-thread-count-field").removeClass("unset").val(ad.component.maxEventDrivenThreadCount);Z(true);z("#settings-save").off("click").on("click",function(){m(ad.revision.version)})}else{if(ad.permissions.canRead){z("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(ad.component.maxTimerDrivenThreadCount);z("#read-only-maximum-event-driven-thread-count-field").removeClass("unset").text(ad.component.maxEventDrivenThreadCount)}else{ab()}Z(false)}ac.resolve()}).fail(function(af,ad,ae){if(af.status===403){ab();Z(false);ac.resolve()}else{ac.reject(af,ad,ae)}})}).promise();var V=E.urls.api+"/flow/controller/controller-services";var X=G.loadControllerServices(V,r());var aa=F();var W=T();return z.when(Y,X,aa).done(function(ae,ad){var ac=ad[0];z("#settings-last-refreshed").text(ac.currentTime)}).fail(d.handleAjaxError)};var F=function(){return z.ajax({type:"GET",url:E.urls.reportingTasks,dataType:"json"}).done(function(V){var Z=[];z.each(V.reportingTasks,function(ab,aa){Z.push(z.extend({type:"ReportingTask",bulletins:[]},aa))});var X=z("#reporting-tasks-table");L.cleanUpTooltips(X,"div.has-errors");L.cleanUpTooltips(X,"div.has-bulletins");var W=X.data("gridInstance");var Y=W.getData();Y.setItems(Z);Y.reSort();W.invalidate()})};var T=function(){return z.ajax({type:"GET",url:E.urls.registries,dataType:"json"}).done(function(V){var W=[];z.each(V.registries,function(Z,aa){W.push(z.extend({type:"Registry"},aa))});var X=z("#registries-table").data("gridInstance");var Y=X.getData();Y.setItems(W);Y.reSort();X.invalidate()})};var w=function(){J.showContent("#settings").done(function(){I()});z("#settings-tabs").find(".selected-tab").click();D.resetTableSize()};var I=function(){z("#settings-save").mouseout()};var D={init:function(){z("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Reporting Task Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"},{name:"Registry Clients",tabContentId:"registries-tab-content"}],select:function(){var V=z(this).text();if(V==="General"){z("#controller-cs-availability").hide();z("#new-service-or-task").hide();z("#settings-save").show()}else{var W=false;if(L.isDefinedAndNotNull(L.currentUser)){W=L.currentUser.controllerPermissions.canWrite===true}if(W){z("#new-service-or-task").show();z("div.controller-settings-table").css("top","32px");z("#new-service-or-task").attr("title",function(){if(V==="Reporting Task Controller Services"){z("#settings-save").hide();return"Create a new reporting task controller service"}else{if(V==="Reporting Tasks"){z("#settings-save").hide();return"Create a new reporting task"}else{if(V==="Registry Clients"){z("#settings-save").hide();return"Register a new registry client"}}}})}else{z("#new-service-or-task").hide();z("div.controller-settings-table").css("top","0")}if(V==="Reporting Task Controller Services"){z("#controller-cs-availability").show()}else{if(V==="Reporting Tasks"||V==="Registry Clients"){z("#controller-cs-availability").hide()}}D.resetTableSize()}}});z("#settings-refresh-button").click(function(){M()});z("#new-service-or-task").on("click",function(){var X=z("#settings-tabs li.selected-tab").text();if(X==="Reporting Task Controller Services"){var W=E.urls.api+"/controller/controller-services";G.promptNewControllerService(W,r())}else{if(X==="Reporting Tasks"){z("#new-reporting-task-dialog").modal("show");var Y=z("#reporting-task-types-table").data("gridInstance");if(L.isDefinedAndNotNull(Y)){var V=Y.getData();Y.resizeCanvas();if(V.getLength()>0){P.choseFirstRow(Y)}}z("#reporting-task-type-filter").focus()}else{if(X==="Registry Clients"){z("#registry-configuration-dialog").modal("setHeaderText","Add Registry Client").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z(this).modal("hide")}}}]).modal("show");z("#registry-name").focus()}}}});j();G.init(r(),D.showSettings);c();t()},resetTableSize:function(){G.resetTableSize(r());var V=z("#reporting-tasks-table").data("gridInstance");if(L.isDefinedAndNotNull(V)){V.resizeCanvas()}},showSettings:function(){return M().done(w)},loadSettings:function(){return M()},selectControllerService:function(V){var W=r().data("gridInstance");var X=W.getData();var Y=X.getRowById(V);P.choseRow(W,Y);W.scrollRowIntoView(Y);z("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(V){var Y=z("#reporting-tasks-table").data("gridInstance");var W=Y.getData();var X=W.getRowById(V);P.choseRow(Y,X);Y.scrollRowIntoView(X);z("#settings-tabs").find("li:eq(2)").click()},setBulletins:function(X,V){if(z("#controller-services-table").data("gridInstance")){G.setBulletins(r(),X)}var W=z("#reporting-tasks-table").data("gridInstance");var Z=W.getData();Z.beginUpdate();if(!L.isEmpty(V)){var aa=N.nest().key(function(ab){return ab.sourceId}).map(V,N.map);aa.forEach(function(ac,ab){var ad=Z.getItemById(ac);if(L.isDefinedAndNotNull(ad)){Z.updateItem(ac,z.extend(ad,{bulletins:ab}))}})}else{var Y=Z.getItems();z.each(Y,function(ab,ac){Z.updateItem(ac.id,z.extend(ac,{bulletins:[]}))})}Z.endUpdate()}};return D}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.ng.BreadcrumbsCtrl=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsCtrl=b(require("jquery"),require("nf.Common")))}else{nf.ng.BreadcrumbsCtrl=b(a.$,a.nf.Common)}}}(this,function(a,b){return function(e){function d(){this.breadcrumbs=[]}d.prototype={constructor:d,register:function(){if(e.breadcrumbsCtrl===undefined){e.register("breadcrumbsCtrl",c)}},generateBreadcrumbs:function(g){var f=g.id;if(g.permissions.canRead){f=g.breadcrumb.name}this.breadcrumbs.unshift(a.extend({label:f},g));if(b.isDefinedAndNotNull(g.parentBreadcrumb)){this.generateBreadcrumbs(g.parentBreadcrumb)}},updateVersionControlInformation:function(f,g){a.each(this.breadcrumbs,function(h,i){if(i.id===f){i.breadcrumb.versionControlInformation=g;return false}})},resetBreadcrumbs:function(){this.breadcrumbs=[]},isTracking:function(f){return b.isDefinedAndNotNull(f.versionedFlowState)},getVersionControlClass:function(g){if(b.isDefinedAndNotNull(g.versionedFlowState)){var f=g.versionedFlowState;if(f==="SYNC_FAILURE"){return"breadcrumb-version-control-gray fa fa-question"}else{if(f==="LOCALLY_MODIFIED_AND_STALE"){return"breadcrumb-version-control-red fa fa-exclamation-circle"}else{if(f==="STALE"){return"breadcrumb-version-control-red fa fa-arrow-circle-up"}else{if(f==="LOCALLY_MODIFIED"){return"breadcrumb-version-control-gray fa fa-asterisk"}else{return"breadcrumb-version-control-green fa fa-check"}}}}}else{return""}},getVersionControlTooltip:function(f){if(b.isDefinedAndNotNull(f.versionedFlowState)&&f.permissions.canRead){return b.getVersionControlTooltip(f.breadcrumb.versionControlInformation)}else{return"This Process Group is not under version control."}},getBreadcrumbs:function(){return this.breadcrumbs},updateBreadcrumbsCss:function(f){a("#breadcrumbs").css(f)},resetScrollPosition:function(){var l=a("#data-flow-title-container");var i=l.position();var m=l.outerWidth();var k=i.left+m;var j=a("#breadcrumbs-right-border").width();var g=a("#data-flow-title-viewport");var h=g.width();var f=h-j;if(k>f){l.css("left",(i.left-(k-f))+"px")}else{l.css("left","10px")}},registerMouseWheelEvent:function(f){f.on("DOMMouseScroll mousewheel",function(s,l){if(b.isUndefinedOrNull(s.originalEvent)){return}var m=a("#data-flow-title-container");var g=m.position();var q=m.outerWidth();var j=g.left+q;var n=a("#breadcrumbs-right-border").width();var k=a("#data-flow-title-viewport");var i=k.width();var h=i-n;if(q>i){var p=false;var r=0;if(b.isDefinedAndNotNull(s.originalEvent.wheelDelta)){r=s.originalEvent.wheelDelta}else{if(b.isDefinedAndNotNull(s.originalEvent.detail)){r=-s.originalEvent.detail}}if(r>0&&j>h){var o=-25;p=true}else{if(r<0&&(g.left-n)<0){o=25;if(g.left+o>n){o=n-g.left}p=true}}if(p){m.css("left",(g.left+o)+"px")}}})}};var c=new d();c.register();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Storage","nf.Shell","nf.ErrorHandler"],function(e,f,d,c,g){return(nf.ng.Canvas.HeaderCtrl=b(e,f,d,c,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.HeaderCtrl=b(require("jquery"),require("nf.Common"),require("nf.Storage"),require("nf.Shell"),require("nf.ErrorHandler")))}else{nf.ng.Canvas.HeaderCtrl=b(a.$,a.nf.Common,a.nf.Storage,a.nf.Shell,a.nf.ErrorHandler)}}}(this,function(c,d,b,a,e){return function(k,m,f,i){var j=640;var h={urls:{accessConfig:"../nifi-api/access/config"}};function l(p,n,o){this.toolboxCtrl=p;this.globalMenuCtrl=n;this.flowStatusCtrl=o;this.loginCtrl={init:function(){var q=this;if(c("#current-user").text()!==d.ANONYMOUS_USER_TEXT||location.protocol==="http:"){c("#login-link-container").css("display","none")}if(location.protocol==="http:"){c("#current-user-container").css("display","none")}var r=c.ajax({type:"GET",url:h.urls.accessConfig,dataType:"json"});c.when(r).done(function(s){q.supportsLogin=s.config.supportsLogin}).fail(e.handleAjaxError)},supportsLogin:undefined,shell:{launch:function(){a.showPage("login",false)}}};this.logoutCtrl={logout:function(){b.removeItem("jwt");window.location="../nifi/login"}}}l.prototype={constructor:l,register:function(){if(k.headerCtrl===undefined){k.register("headerCtrl",g)}},init:function(){this.toolboxCtrl.init();this.globalMenuCtrl.init();this.flowStatusCtrl.init();this.loginCtrl.init()}};var g=new l(m,f,i);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.ToolboxCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.ToolboxCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.ToolboxCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(l,e,h,c,j,k,g,i){function f(m,p,r,q,n,t,s,o){this.processorComponent=m;this.inputPortComponent=p;this.outputPortComponent=r;this.groupComponent=q;this.remoteGroupComponent=n;this.funnelComponent=t;this.templateComponent=s;this.labelComponent=o;this.config={type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api",controller:"../nifi-api/controller",processorTypes:"../nifi-api/flow/processor-types"}}}f.prototype={constructor:f,init:function(){l.modal.init();e.modal.init();h.modal.init();c.modal.init();j.modal.init();g.modal.init()},draggableComponentConfig:function(m){m.getElement().hover(function(){m.getElement().removeClass(m.icon).addClass(m.hoverIcon)},function(){m.getElement().removeClass(m.hoverIcon).addClass(m.icon)});return{zIndex:1011,revert:true,revertDuration:0,cancel:false,containment:"body",cursor:"-webkit-grabbing",start:function(o,n){a.hide()},stop:function(r,q){var t=b.translateCanvasView();var s=b.scaleCanvasView();var p=r.originalEvent.pageX;var o=r.originalEvent.pageY-b.getCanvasOffset();if(p>=0&&o>=0){var n=(p/s)-(t[0]/s);var u=(o/s)-(t[1]/s);m.dropHandler.apply(m,[{x:n,y:u}])}},helper:m.dragIcon}}};var d=new f(l,e,h,c,j,k,g,i);return d}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.CanvasUtils","nf.ContextMenu","nf.ClusterSummary","nf.ErrorHandler","nf.Settings"],function(h,i,g,f,d,c,j,e){return(nf.ng.Canvas.FlowStatusCtrl=b(h,i,g,f,d,c,j,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.FlowStatusCtrl=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings")))}else{nf.ng.Canvas.FlowStatusCtrl=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings)}}}(this,function(f,g,e,d,b,a,h,c){return function(l){var i={search:"Search",urls:{search:"../nifi-api/flow/search-results",status:"../nifi-api/flow/status"}};function k(){this.connectedNodesCount="-";this.activeThreadCount="-";this.totalQueued="-";this.controllerTransmittingCount="-";this.controllerNotTransmittingCount="-";this.controllerRunningCount="-";this.controllerStoppedCount="-";this.controllerInvalidCount="-";this.controllerDisabledCount="-";this.controllerUpToDateCount="-";this.controllerLocallyModifiedCount="-";this.controllerStaleCount="-";this.controllerLocallyModifiedAndStaleCount="-";this.controllerSyncFailureCount="-";this.statsLastRefreshed="-";this.search={getInputElement:function(){return f("#search-field")},getButtonElement:function(){return f("#search-button")},getSearchContainerElement:function(){return f("#search-container")},init:function(){var m=this;f.widget("nf.searchAutocomplete",f.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-header, .search-no-matches)")},_resizeMenu:function(){var n=this.menu.element;n.width(400)},_normalize:function(o){var n=[];n.push(o);return n},_renderMenu:function(p,o){var n=this;var q=o[0];if(!g.isEmpty(q.processorResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-processor"></div>Processors</li>');f.each(q.processorResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.processGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group"></div>Process Groups</li>');f.each(q.processGroupResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.remoteProcessGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group-remote"></div>Remote Process Groups</li>');f.each(q.remoteProcessGroupResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.connectionResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-connect"></div>Connections</li>');f.each(q.connectionResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.inputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-in"></div>Input Ports</li>');f.each(q.inputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.outputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-out"></div>Output Ports</li>');f.each(q.outputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.funnelResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-funnel"></div>Funnels</li>');f.each(q.funnelResults,function(s,r){n._renderItem(p,r)})}if(p.children().length===0){p.append('<li class="unset search-no-matches">No results matched the search terms</li>')}},_renderItem:function(o,n){var p=f("<a></a>").append(f('<div class="search-match-header"></div>').text(n.name));f.each(n.matches,function(r,q){p.append(f('<div class="search-match"></div>').text(q))});return f("<li></li>").data("ui-autocomplete-item",n).append(p).appendTo(o)}});this.getInputElement().searchAutocomplete({appendTo:"#search-flow-results",position:{my:"right top",at:"right bottom",offset:"1 1"},source:function(o,n){f.ajax({type:"GET",data:{q:o.term},dataType:"json",url:i.urls.search}).done(function(p){n(p.searchResultsDTO)})},select:function(o,p){var n=p.item;d.showComponent(n.groupId,n.id);m.getInputElement().val("").blur();return false},open:function(n,o){var p=f(this);f('<div class="search-glass-pane"></div>').one("click",function(){}).appendTo("body")},close:function(n,o){f(this).searchAutocomplete("reset");m.getInputElement().val("");f("div.search-glass-pane").remove()}});m.toggleSearchField()},toggleSearchField:function(){var p=this;b.hide();var m=p.getInputElement().is(":visible");var q="none";var o="search-container-opened";var n="search-container-closed";if(!m){p.getButtonElement().css("background-color","#FFFFFF");q="inline-block";o="search-container-closed";n="search-container-opened"}else{p.getInputElement().css("display",q)}this.getSearchContainerElement().switchClass(o,n,500,function(){p.getInputElement().css("display",q);if(!m){p.getButtonElement().css("background-color","#FFFFFF");p.getInputElement().focus()}else{p.getButtonElement().css("background-color","#E3E8EB")}})}};this.bulletins={update:function(m){var o=f("#bulletin-button");var q=o.data("bulletins");if(g.doBulletinsDiffer(q,m.bulletins)){o.data("bulletins",m.bulletins);var p=g.getFormattedBulletins(m.bulletins);if(p.length===0){if(o.data("qtip")){o.removeClass("has-bulletins").qtip("api").destroy(true)}}else{var n=g.formatUnorderedList(p);if(o.data("qtip")){o.qtip("option","content.text",n)}else{o.addClass("has-bulletins").qtip(f.extend({},d.config.systemTooltipConfig,{content:n,position:{at:"bottom left",my:"top right",adjust:{x:4}}}))}}}c.setBulletins(m.controllerServiceBulletins,m.reportingTaskBulletins)}}}k.prototype={constructor:k,init:function(){this.search.init()},reloadFlowStatus:function(){var m=this;return f.ajax({type:"GET",url:i.urls.status,dataType:"json"}).done(function(n){if(g.isDefinedAndNotNull(n.controllerStatus)){m.update(n.controllerStatus)}}).fail(h.handleAjaxError)},updateClusterSummary:function(o){if(a.isConnectedToCluster()!==o.connectedToCluster){if(o.connectedToCluster){e.showConnectedToClusterMessage()}else{e.showDisconnectedFromClusterMessage()}}var n="#728E9B";if(o.connectedToCluster){if(g.isDefinedAndNotNull(o.connectedNodes)){var m=o.connectedNodes.split(" / ");if(m.length===2&&m[0]!==m[1]){this.clusterConnectionWarning=true;n="#BA554A"}}this.connectedNodesCount=g.isDefinedAndNotNull(o.connectedNodes)?o.connectedNodes:"-"}else{this.connectedNodesCount="Disconnected";n="#BA554A"}f("#connected-nodes-count").closest("div.fa-cubes").css("color",n)},update:function(m){var n=(g.isDefinedAndNotNull(m.invalidCount))?m.invalidCount:0;if(this.controllerInvalidCount>0){f("#controller-invalid-count").parent().removeClass("zero").addClass("invalid")}else{f("#controller-invalid-count").parent().removeClass("invalid").addClass("zero")}this.activeThreadCount=m.activeThreadCount;if(this.activeThreadCount>0){f("#flow-status-container").find(".icon-threads").removeClass("zero")}else{f("#flow-status-container").find(".icon-threads").addClass("zero")}this.totalQueued=m.queued;if(this.totalQueued.indexOf("0 / 0")>=0){f("#flow-status-container").find(".fa-list").addClass("zero")}else{f("#flow-status-container").find(".fa-list").removeClass("zero")}this.controllerTransmittingCount=g.isDefinedAndNotNull(m.activeRemotePortCount)?m.activeRemotePortCount:"-";if(this.controllerTransmittingCount>0){f("#flow-status-container").find(".fa-bullseye").removeClass("zero").addClass("transmitting")}else{f("#flow-status-container").find(".fa-bullseye").removeClass("transmitting").addClass("zero")}this.controllerNotTransmittingCount=g.isDefinedAndNotNull(m.inactiveRemotePortCount)?m.inactiveRemotePortCount:"-";if(this.controllerNotTransmittingCount>0){f("#flow-status-container").find(".icon-transmit-false").removeClass("zero").addClass("not-transmitting")}else{f("#flow-status-container").find(".icon-transmit-false").removeClass("not-transmitting").addClass("zero")}this.controllerRunningCount=g.isDefinedAndNotNull(m.runningCount)?m.runningCount:"-";if(this.controllerRunningCount>0){f("#flow-status-container").find(".fa-play").removeClass("zero").addClass("running")}else{f("#flow-status-container").find(".fa-play").removeClass("running").addClass("zero")}this.controllerStoppedCount=g.isDefinedAndNotNull(m.stoppedCount)?m.stoppedCount:"-";if(this.controllerStoppedCount>0){f("#flow-status-container").find(".fa-stop").removeClass("zero").addClass("stopped")}else{f("#flow-status-container").find(".fa-stop").removeClass("stopped").addClass("zero")}this.controllerInvalidCount=g.isDefinedAndNotNull(m.invalidCount)?m.invalidCount:"-";if(this.controllerInvalidCount>0){f("#flow-status-container").find(".fa-warning").removeClass("zero").addClass("invalid")}else{f("#flow-status-container").find(".fa-warning").removeClass("invalid").addClass("zero")}this.controllerDisabledCount=g.isDefinedAndNotNull(m.disabledCount)?m.disabledCount:"-";if(this.controllerDisabledCount>0){f("#flow-status-container").find(".icon-enable-false").removeClass("zero").addClass("disabled")}else{f("#flow-status-container").find(".icon-enable-false").removeClass("disabled").addClass("zero")}this.controllerUpToDateCount=g.isDefinedAndNotNull(m.upToDateCount)?m.upToDateCount:"-";if(this.controllerUpToDateCount>0){f("#flow-status-container").find(".fa-check").removeClass("zero").addClass("up-to-date")}else{f("#flow-status-container").find(".fa-check").removeClass("up-to-date").addClass("zero")}this.controllerLocallyModifiedCount=g.isDefinedAndNotNull(m.locallyModifiedCount)?m.locallyModifiedCount:"-";if(this.controllerLocallyModifiedCount>0){f("#flow-status-container").find(".fa-asterisk").removeClass("zero").addClass("locally-modified")}else{f("#flow-status-container").find(".fa-asterisk").removeClass("locally-modified").addClass("zero")}this.controllerStaleCount=g.isDefinedAndNotNull(m.staleCount)?m.staleCount:"-";if(this.controllerStaleCount>0){f("#flow-status-container").find(".fa-arrow-circle-up").removeClass("zero").addClass("stale")}else{f("#flow-status-container").find(".fa-arrow-circle-up").removeClass("stale").addClass("zero")}this.controllerLocallyModifiedAndStaleCount=g.isDefinedAndNotNull(m.locallyModifiedAndStaleCount)?m.locallyModifiedAndStaleCount:"-";if(this.controllerLocallyModifiedAndStaleCount>0){f("#flow-status-container").find(".fa-exclamation-circle").removeClass("zero").addClass("locally-modified-and-stale")}else{f("#flow-status-container").find(".fa-exclamation-circle").removeClass("locally-modified-and-stale").addClass("zero")}this.controllerSyncFailureCount=g.isDefinedAndNotNull(m.syncFailureCount)?m.syncFailureCount:"-";if(this.controllerSyncFailureCount>0){f("#flow-status-container").find(".fa-question").removeClass("zero").addClass("sync-failure")}else{f("#flow-status-container").find(".fa-question").removeClass("sync-failure").addClass("zero")}},updateBulletins:function(m){this.bulletins.update(m)}};var j=new k();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.QueueListing","nf.Shell","nf.PolicyManagement","nf.ClusterSummary","nf.ErrorHandler","nf.Settings","nf.CanvasUtils"],function(g,e,k,c,j,i,h,f,d){return(nf.ng.Canvas.GlobalMenuCtrl=b(g,e,k,c,j,i,h,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GlobalMenuCtrl=b(require("jquery"),require("nf.Common"),require("nf.QueueListing"),require("nf.Shell"),require("nf.PolicyManagement"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings"),require("nf.CanvasUtils")))}else{nf.ng.Canvas.GlobalMenuCtrl=b(a.$,a.nf.Common,a.nf.QueueListing,a.nf.Shell,a.nf.PolicyManagement,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings,a.nf.CanvasUtils)}}}(this,function(e,c,i,a,h,g,f,d,b){return function(m){var k={urls:{helpDocument:"../nifi-docs/documentation",controllerAbout:"../nifi-api/flow/about"}};function l(n){this.summary={shell:{launch:function(){a.showPage("summary")}}};this.counters={shell:{launch:function(){if(c.canAccessCounters()){a.showPage("counters")}}}};this.bulletinBoard={shell:{launch:function(){a.showPage("bulletin-board")}}};this.dataProvenance={shell:{launch:function(){if(c.canAccessProvenance()){a.showPage("provenance")}}}};this.controllerSettings={shell:{launch:function(){d.showSettings()}}};this.cluster={visible:function(){return g.isConnectedToCluster()},shell:{launch:function(){if(c.canAccessController()){a.showPage("cluster")}}}};this.flowConfigHistory={shell:{launch:function(){a.showPage("history")}}};this.users={shell:{launch:function(){if(c.canAccessTenants()){a.showPage("users")}}}};this.policies={shell:{launch:function(){if(c.canModifyPolicies()&&c.canAccessTenants()){h.showGlobalPolicies()}}}};this.templates={shell:{launch:function(){a.showPage("templates?"+e.param({groupId:b.getGroupId()}))}}};this.help={shell:{launch:function(){a.showPage(k.urls.helpDocument)}}};this.about={init:function(){e.ajax({type:"GET",url:k.urls.controllerAbout,dataType:"json"}).done(function(q){var o=q.about;document.title=o.title;e("#nf-version").text(o.version);var p=false;if(o.buildTag&&o.buildTag!=="HEAD"){e("#nf-about-build-tag").text(o.buildTag);e("#nf-version-detail-tag").show();p=true}if(o.buildRevision){e("#nf-about-build-revision").text(o.buildRevision);e("#nf-about-build-branch").text(o.buildBranch);e("#nf-version-detail-commit").show();p=true}if(o.buildTimestamp){e("#nf-about-build-timestamp").text(o.buildTimestamp);e("#nf-version-detail-timestamp").show();p=true}if(p){e("#nf-version-detail").show()}if(!c.isBlank(o.contentViewerUrl)){e("#nifi-content-viewer-url").text(o.contentViewerUrl);i.initFlowFileDetailsDialog()}}).fail(f.handleAjaxError);this.modal.init()},modal:{getElement:function(){return e("#nf-about")},init:function(){var o=this;var p=function(){var q=e(this);var r=e("#nf-about-pic-container").height()+e(".dialog-header").height()+10;q.find(".dialog-content").css("top",r)};this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"About Apache NiFi",handler:{resize:p},buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){o.hide()}}}]})},update:function(p,o){this.getElement().modal(p,o)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}}l.prototype={constructor:l,init:function(){this.about.init()}};var j=new l();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Actions","nf.Birdseye","nf.Storage","nf.CanvasUtils","nf.ProcessGroupConfiguration"],function(h,d,g,e,f,c){return(nf.ng.Canvas.GraphControlsCtrl=b(h,d,g,e,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GraphControlsCtrl=b(require("jquery"),require("nf.Actions"),require("nf.Birdseye"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration")))}else{nf.ng.Canvas.GraphControlsCtrl=b(a.$,a.nf.Actions,a.nf.Birdseye,a.nf.Storage,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration)}}}(this,function(f,b,e,c,d,a){return function(m,i,l){var k=function(n){if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-docked").hide();f("#graph-controls div.graph-control-header-container").show();f(".graph-control").removeClass("docked")}n.children("div.graph-control-content").show();n.find("div.graph-control-expansion").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(true)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=true;c.setItem("graph-control-visibility",o)};var j=function(n){n.children("div.graph-control-content").hide();n.find("div.graph-control-expansion").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-header-container").hide();f("#graph-controls div.graph-control-docked").show();f(".graph-control").addClass("docked")}if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(false)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=false;c.setItem("graph-control-visibility",o)};function h(n,o){this.navigateCtrl=n;this.operateCtrl=o}h.prototype={constructor:h,register:function(){if(m.graphControlsCtrl===undefined){m.register("graphControlsCtrl",g)}},init:function(){this.operateCtrl.init();var n=c.getItem("graph-control-visibility");if(n!==null){f.each(n,function(q,o){var p=f("#"+q);if(p){if(o){k(p)}else{j(p)}}})}else{k(f("#navigation-control"));k(f("#operation-control"))}},undock:function(n){k(f(n.target).parent())},expand:function(n){var o=f(n.target);if(o.find(".fa-plus-square-o").length>0||o.hasClass("fa-plus-square-o")||o.parent().children().find(".fa-plus-square-o").length>0){k(o.closest("div.graph-control"))}else{j(o.closest("div.graph-control"))}},getContextIcon:function(){var n=d.getSelection();if(n.empty()){if(d.getParentGroupId()===null){return"icon-drop"}else{return"icon-group"}}else{if(n.size()===1){if(d.isProcessor(n)){return"icon-processor"}else{if(d.isProcessGroup(n)){return"icon-group"}else{if(d.isInputPort(n)){return"icon-port-in"}else{if(d.isOutputPort(n)){return"icon-port-out"}else{if(d.isRemoteProcessGroup(n)){return"icon-group-remote"}else{if(d.isFunnel(n)){return"icon-funnel"}else{if(d.isLabel(n)){return"icon-label"}else{if(d.isConnection(n)){return"icon-connect"}}}}}}}}}else{return"icon-drop"}}},hide:function(){var n=d.getSelection();if(n.size()>1){return"invisible"}else{return""}},getContextName:function(){var o=d.getSelection();var n=d.canReadCurrentGroup();if(o.empty()){if(n){return d.getGroupName()}else{return d.getGroupId()}}else{if(o.size()===1){var p=o.datum();if(p.permissions.canRead){if(d.isLabel(o)){if(f.trim(p.component.label)!==""){return p.component.label}else{return""}}else{if(d.isConnection(o)){return d.formatConnectionName(p.component)}else{return p.component.name}}}else{return p.id}}else{return"Multiple components selected"}}},getContextType:function(){var n=d.getSelection();if(n.empty()){return"Process Group"}else{if(n.size()===1){if(d.isProcessor(n)){return"Processor"}else{if(d.isProcessGroup(n)){return"Process Group"}else{if(d.isInputPort(n)){return"Input Port"}else{if(d.isOutputPort(n)){return"Output Port"}else{if(d.isRemoteProcessGroup(n)){return"Remote Process Group"}else{if(d.isFunnel(n)){return"Funnel"}else{if(d.isLabel(n)){return"Label"}else{if(d.isConnection(n)){return"Connection"}}}}}}}}}else{return"Multiple selected"}}},getContextId:function(){var n=d.getSelection();if(n.empty()){return d.getGroupId()}else{if(n.size()===1){var o=n.datum();return o.id}else{return"Multiple selected"}}},canConfigureOrOpenDetails:function(){var n=d.getSelection();if(n.empty()){return true}return d.isConfigurable(n)||d.hasDetails(n)},openConfigureOrDetailsView:function(){var n=d.getSelection();if(d.isConfigurable(n)){b.showConfiguration(n)}else{if(d.hasDetails(n)){b.showDetails(n)}}}};var g=new h(i,l);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.NavigateCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.NavigateCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.NavigateCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(){function d(){this.zoomIn=function(){b.zoomCanvasViewIn();a.hide();b.refreshCanvasView({transition:true})};this.zoomOut=function(){b.zoomCanvasViewOut();a.hide();b.refreshCanvasView({transition:true})};this.zoomFit=function(){b.fitCanvasView();a.hide();b.refreshCanvasView({transition:true})};this.zoomActualSize=function(){b.actualSizeCanvasView();a.hide();b.refreshCanvasView({transition:true})}}d.prototype={constructor:d};var c=new d();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Dialog","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Client","nf.Processor"],function(i,f,h,g,e,j,d,c){return(nf.ng.Canvas.OperateCtrl=b(i,f,h,g,e,j,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.OperateCtrl=b(require("jquery"),require("d3"),require("nf.Dialog"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Client"),require("nf.Processor")))}else{nf.ng.Canvas.OperateCtrl=b(a.$,a.d3,a.nf.Dialog,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Client,a.nf.Processor)}}}(this,function(g,d,f,e,c,h,b,a){return function(){var j=function(){var l=g("#fill-color-value").val();if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(l)){g("#fill-color").minicolors("value",l)}};function i(){this.template={modal:{getElement:function(){return g("#new-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Create Template"})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.templateUpload={modal:{getElement:function(){return g("#upload-template-dialog")},init:function(){var l=g("#template-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"xml",beforeSubmit:function(o,m,n){n.url+=(encodeURIComponent(c.getGroupId())+"/templates/upload")},success:function(m,p,q,o){if(m.documentElement.tagName==="templateEntity"){f.showOkDialog({headerText:"Success",dialogContent:"Template successfully imported."})}else{var p="Unable to import template. Please check the log for errors.";if(m.documentElement.tagName==="errorResponse"){var n=m.documentElement.getAttribute("statusText");if(!h.isBlank(n)){p=n}}f.showOkDialog({headerText:"Unable to Upload",dialogContent:h.escapeHtml(p)})}},error:function(o,n,m){f.showOkDialog({headerText:"Unable to Upload",dialogContent:h.escapeHtml(o.responseText)})}});this.getElement().modal({headerText:"Upload Template",buttons:[{buttonText:"Upload",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var m=g("#selected-template-name").text();if(h.isBlank(m)){g("#upload-template-status").text("No template selected. Please browse to select a template.")}else{l.submit();g("#upload-template-dialog").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#upload-template-dialog").modal("hide")}}}],handler:{close:function(){g("#selected-template-name").text("");g("#upload-template-status").text("");l.resetForm()}}});g("#template-file-field-button").on("click",function(m){g("#template-file-field").click()});g("#template-file-field").on("change",function(n){var m=g(this).val();if(!h.isBlank(m)){m=m.replace(/^.*[\\\/]/,"")}g("#selected-template-name").text(m);g("#upload-template-status").text("")})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.fillcolor={modal:{getElement:function(){return g("#fill-color-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Change Color",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var l=c.getSelection();l.each(function(q){var o=d.select(this);var p=o.datum();var n=g("#fill-color").minicolors("value");if(n!==p.component.style["background-color"]){var m={revision:b.getRevision(p),component:{id:p.id,style:{"background-color":n}}};g.ajax({type:"PUT",url:p.uri,data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(r){c.getComponentByType(p.type).set(r)}).fail(function(t,r,s){if(t.status===400||t.status===404||t.status===409){f.showOkDialog({headerText:"Error",dialogContent:h.escapeHtml(t.responseText)})}}).always(function(){e.refresh()})}});g("#fill-color-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#fill-color-dialog").modal("hide")}}}],handler:{close:function(){g("#fill-color-value").val("");g("#fill-color").minicolors("value","")}}})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")},minicolors:{getElement:function(){return g("#fill-color")},init:function(){this.getElement().minicolors({inline:true,change:function(m,l){g("#fill-color-value").val(m);if(m.toLowerCase()==="#ffffff"){g("#fill-color-processor-preview-icon").css({color:a.defaultIconColor(),"background-color":m})}else{g("#fill-color-processor-preview-icon").css({color:h.determineContrastColor(h.substringAfterLast(m,"#")),"background-color":m})}var n=m;if(n.toLowerCase()==="#ffffff"){n="rgba(0,0,0,0.25)"}g("#fill-color-processor-preview").css({"border-color":n});g("#fill-color-label-preview").css({background:m});g("#fill-color-label-preview-value").css("color",h.determineContrastColor(h.substringAfterLast(m,"#")))}});g("#fill-color-value").on("blur",j).on("keyup",function(m){var l=m.keyCode?m.keyCode:m.which;if(l===g.ui.keyCode.ENTER){j()}})}}}}}i.prototype={constructor:i,init:function(){this.template.modal.init();this.templateUpload.modal.init();this.fillcolor.modal.init();this.fillcolor.modal.minicolors.init()}};var k=new i();return k}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Common"],function(h,e,l,c,i,f,j,k,g,d){return(nf.ng.ProcessorComponent=b(h,e,l,c,i,f,j,k,g,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ProcessorComponent=b(require("jquery"),require("Slick"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.ProcessorComponent=b(a.$,a.Slick,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Common)}}}(this,function(f,c,j,a,g,d,h,i,e,b){return function(m){var p=function(){var v=f("#processor-types-table").data("gridInstance");if(b.isDefinedAndNotNull(v)){var w=v.getData();w.setFilterArgs({searchString:t()});w.refresh();f("#new-processor-dialog").modal("refreshButtons");if(w.getLength()>0){i.choseFirstRow(v);v.scrollRowToTop(0)}}};var r=function(x,w){if(w.searchString===""){return true}try{var A=new RegExp(w.searchString,"i")}catch(z){return false}var y=x.label.search(A)>=0;var v=x.tags.search(A)>=0;return y||v};var k=function(E,z){var C=r(E,z);var y=true;if(C){var D=f("#processor-tag-cloud").tagcloud("getSelectedTags");var B=D.length>0;if(B){y=l(D,E.tags)}}var A=true;if(C&&y){var v=f("#processor-bundle-group-combo").combo("getSelectedOption");if(b.isDefinedAndNotNull(v)&&v.value!==""){A=(E.bundle.group===v.value)}}var w=C&&y&&A;if(w===false&&f("#selected-processor-type").text()===E.type){f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var x=f("#processor-types-table").data("gridInstance");x.resetActiveCell()}return w};var l=function(x,v){var w=[];f.each(x,function(A,B){w.push(B)});var y=v.toLowerCase();var z=true;f.each(w,function(A,B){if(y.indexOf(B)===-1){z=false;return false}});return z};var t=function(){return f("#processor-type-filter").val()};var n=function(){f("#processor-tag-cloud").tagcloud("clearSelectedTags");f("#processor-bundle-group-combo").combo("setSelectedOption",{value:""});f("#processor-type-filter").val("");p();f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var v=f("#processor-types-table").data("gridInstance");v.setSelectedRows([]);v.resetActiveCell()};var q=function(w,z,v,x){var y={revision:j.getRevision({revision:{version:0}}),component:{type:z,bundle:v,name:w,position:{x:x.x,y:x.y}}};f.ajax({type:"POST",url:m.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/processors",data:JSON.stringify(y),dataType:"json",contentType:"application/json"}).done(function(A){g.add({processors:[A]},{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleAjaxError)};var o=function(v){return b.isBlank(v.usageRestriction)||b.canAccessRestrictedComponents()};function u(){this.icon="icon icon-processor";this.hoverIcon="icon icon-processor-add";this.modal={filter:{init:function(){var w=[{id:"type",name:"Type",field:"label",formatter:b.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:b.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:b.genericValueFormatter}];var y={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var x=new c.Data.DataView({inlineFilters:false});x.setItems([]);x.setFilterArgs({searchString:t()});x.setFilter(k);b.sortType({columnId:"type",sortAsc:true},x);var v=new c.Grid("#processor-types-table",x,w,y);v.setSelectionModel(new c.RowSelectionModel());v.registerPlugin(new c.AutoTooltips());v.setSortColumn("type",true);v.onSort.subscribe(function(A,z){b.sortType({columnId:z.sortCol.field,sortAsc:z.sortAsc},x)});v.onSelectedRowsChanged.subscribe(function(D,B){if(f.isArray(B.rows)&&B.rows.length===1){var z=B.rows[0];var E=v.getDataItem(z);if(b.isDefinedAndNotNull(E)){if(b.isBlank(E.description)){f("#processor-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).html(E.description).ellipsis()}var A=b.formatBundle(E.bundle);var C=b.formatType(E);f("#processor-type-name").text(C).attr("title",C);f("#processor-type-bundle").text(A).attr("title",A);f("#selected-processor-name").text(E.label);f("#selected-processor-type").text(E.type).data("bundle",E.bundle);f("#new-processor-dialog").modal("refreshButtons")}}});v.onViewportChanged.subscribe(function(A,z){b.cleanUpTooltips(f("#processor-types-table"),"div.view-usage-restriction")});x.onRowCountChanged.subscribe(function(A,z){v.updateRowCount();v.render();f("#displayed-processor-types").text(z.current)});x.onRowsChanged.subscribe(function(A,z){v.invalidateRows(z.rows);v.render()});x.syncGridSelection(v,false);f("#processor-types-table").data("gridInstance",v).on("mouseenter","div.slick-cell",function(B){var C=f(this).find("div.view-usage-restriction");if(C.length&&!C.data("qtip")){var A=f(this).find("span.row-id").text();var z=x.getItemById(A);if(b.isDefinedAndNotNull(z.usageRestriction)){C.qtip(f.extend({},b.config.tooltipConfig,{content:z.usageRestriction,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f.ajax({type:"GET",url:m.headerCtrl.toolboxCtrl.config.urls.processorTypes,dataType:"json"}).done(function(A){var C=[];var z=d3.set();x.beginUpdate();f.each(A.processorTypes,function(D,F){var E=F.type;z.add(F.bundle.group);x.addItem({id:D,label:b.substringAfterLast(E,"."),type:E,bundle:F.bundle,description:b.escapeHtml(F.description),usageRestriction:b.escapeHtml(F.usageRestriction),tags:F.tags.join(", ")});f.each(F.tags,function(H,G){C.push(G.toLowerCase())})});x.endUpdate();x.reSort();v.invalidate();f("#total-processor-types, #displayed-processor-types").text(A.processorTypes.length);f("#processor-tag-cloud").tagcloud({tags:C,select:p,remove:p});var B=[{text:"all groups",value:""}];z.forEach(function(D){B.push({text:D,value:D})});f("#processor-bundle-group-combo").combo({options:B,select:p})}).fail(h.handleAjaxError)}},getElement:function(){return f("#new-processor-dialog")},init:function(){this.filter.init();this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Processor",handler:{resize:function(){f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).text(f("#processor-type-description").attr("title")).ellipsis()}}})},update:function(w,v){this.getElement().modal(w,v)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}u.prototype={constructor:u,getElement:function(){return f("#processor-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(v){this.promptForProcessorType(v)},dragIcon:function(v){return f('<div class="icon icon-processor-add"></div>')},promptForProcessorType:function(B){var v=this;var z=function(){var D=f("#selected-processor-name").text();var E=f("#selected-processor-type").text();var C=f("#selected-processor-type").data("bundle");if(D===""||E===""){e.showOkDialog({headerText:"Add Processor",dialogContent:"The type of processor to create must be selected."})}else{q(D,E,C,B)}v.modal.hide()};var y=f("#processor-types-table").data("gridInstance");var w=y.getData();var x=function(D,C){var E=y.getDataItem(C.row);if(o(E)){f("#selected-processor-name").text(E.label);f("#selected-processor-type").text(E.type).data("bundle",E.bundle);z()}};y.onDblClick.subscribe(x);this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var C=y.getSelectedRows();if(C.length>0){var D=y.getDataItem(C[0]);return o(D)===false}else{return w.getLength()===0}},handler:{click:z}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#new-processor-dialog").modal("hide")}}}]);this.modal.update("setCloseHandler",function(){y.onDblClick.unsubscribe(x);n()});this.modal.show();var A=[f.ui.keyCode.UP,f.ui.keyCode.PAGE_UP,f.ui.keyCode.DOWN,f.ui.keyCode.PAGE_DOWN];f("#processor-type-filter").off("keyup").on("keyup",function(F){var E=F.keyCode?F.keyCode:F.which;if(f.inArray(E,A)!==-1){return}if(E===f.ui.keyCode.ENTER){var C=y.getSelectedRows();if(C.length>0){var D=y.getDataItem(C[0]);if(o(D)){z()}}}else{p()}});i.addKeydownListener("#processor-type-filter",y,w);y.resizeCanvas();if(w.getLength()>0){i.choseFirstRow(y)}f("#processor-type-filter").focus()}};var s=new u();return s}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.InputPortComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.InputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.InputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(j){var i=function(m,l){var k={revision:b.getRevision({revision:{version:0}}),component:{name:m,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/input-ports",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(n){a.add({inputPorts:[n]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)};function g(){this.icon="icon icon-port-in";this.hoverIcon="icon icon-port-in-add";this.modal={getElement:function(){return e("#new-port-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Port",handler:{close:function(){e("#new-port-name").val("")}}})},update:function(l,k){this.getElement().modal(l,k)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}g.prototype={constructor:g,getElement:function(){return e("#port-in-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.promptForInputPortName(k)},dragIcon:function(k){return e('<div class="icon icon-port-in-add"></div>')},promptForInputPortName:function(m){var l=this;var k=function(){var n=e("#new-port-name").val();l.modal.hide();i(n,m)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:k}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){l.modal.hide()}}}]);e("#new-port-type").text("Input");this.modal.show();e("#new-port-name").focus().off("keyup").on("keyup",function(o){var n=o.keyCode?o.keyCode:o.which;if(n===e.ui.keyCode.ENTER){k()}})}};var h=new g();return h}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.OutputPortComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.OutputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.OutputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(j){var h=function(m,l){var k={revision:b.getRevision({revision:{version:0}}),component:{name:m,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/output-ports",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(n){a.add({outputPorts:[n]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)};function g(){this.icon="icon icon-port-out";this.hoverIcon="icon icon-port-out-add";this.modal={getElement:function(){return e("#new-port-dialog")},init:function(){},update:function(l,k){this.getElement().modal(l,k)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}g.prototype={constructor:g,getElement:function(){return e("#port-out-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.promptForOutputPortName(k)},dragIcon:function(k){return e('<div class="icon icon-port-out-add"></div>')},promptForOutputPortName:function(l){var m=this;var k=function(){var n=e("#new-port-name").val();m.modal.hide();h(n,l)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:k}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.modal.hide()}}}]);e("#new-port-type").text("Output");this.modal.show();e("#new-port-name").focus().off("keyup").on("keyup",function(o){var n=o.keyCode?o.keyCode:o.which;if(n===e.ui.keyCode.ENTER){k()}})}};var i=new g();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Common","nf.Dialog"],function(h,d,f,c,e,j,i,g){return(nf.ng.GroupComponent=b(h,d,f,c,e,j,i,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.GroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog")))}else{nf.ng.GroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog)}}}(this,function(f,b,d,a,c,h,g,e){return function(l){var k=function(o,n){var m={revision:b.getRevision({revision:{version:0}}),component:{name:o,position:{x:n.x,y:n.y}}};return f.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/process-groups",data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(p){a.add({processGroups:[p]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(h.handleAjaxError)};function i(){this.icon="icon icon-group";this.hoverIcon="icon icon-group-add";this.modal={getElement:function(){return f("#new-process-group-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Process Group",handler:{close:function(){f("#new-process-group-name").val("");f("#new-process-group-dialog").removeData("pt")}}})},update:function(n,m){this.getElement().modal(n,m)},show:function(){if(g.canVersionFlows()){f("#import-process-group-link").show()}else{f("#import-process-group-link").hide()}this.getElement().modal("show")},storePt:function(m){f("#new-process-group-dialog").data("pt",m)},hide:function(){this.getElement().modal("hide")}}}i.prototype={constructor:i,getElement:function(){return f("#group-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForGroupName(m)},dragIcon:function(m){return f('<div class="icon icon-group-add"></div>')},promptForGroupName:function(n){var m=this;return f.Deferred(function(o){var p=function(){var q=f("#new-process-group-name").val();m.modal.hide();if(g.isBlank(q)){e.showOkDialog({headerText:"Create Process Group",dialogContent:"The group name is required."});o.reject()}else{k(q,n).done(function(r){o.resolve(r.component)}).fail(function(){o.reject()})}};m.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:p}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){o.reject();m.modal.hide()}}}]);m.modal.storePt(n);m.modal.show();f("#new-process-group-name").focus().off("keyup").on("keyup",function(r){var q=r.keyCode?r.keyCode:r.which;if(q===f.ui.keyCode.ENTER){p()}})}).promise()}};var j=new i();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(h,d,f,c,e,j,g,i){return(nf.ng.RemoteProcessGroupComponent=b(h,d,f,c,e,j,g,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.RemoteProcessGroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.RemoteProcessGroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,d,a,c,h,e,g){return function(l){var k=function(n){var m={revision:b.getRevision({revision:{version:0}}),component:{targetUris:f("#new-remote-process-group-uris").val(),position:{x:n.x,y:n.y},communicationsTimeout:f("#new-remote-process-group-timeout").val(),yieldDuration:f("#new-remote-process-group-yield-duration").val(),transportProtocol:f("#new-remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,localNetworkInterface:f("#new-remote-process-group-local-network-interface").val(),proxyHost:f("#new-remote-process-group-proxy-host").val(),proxyPort:f("#new-remote-process-group-proxy-port").val(),proxyUser:f("#new-remote-process-group-proxy-user").val(),proxyPassword:f("#new-remote-process-group-proxy-password").val()}};f.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/remote-process-groups",data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(o){a.add({remoteProcessGroups:[o]},{selectAll:true});f("#new-remote-process-group-dialog").modal("hide");a.updateVisibility();d.refresh()}).fail(function(r,o,p){if(r.status===400){var s=r.responseText.split("\n");var q;if(s.length===1){q=f("<span></span>").text(s[0])}else{q=g.formatUnorderedList(s)}e.showOkDialog({dialogContent:q,headerText:"Configuration Error"})}else{h.handleAjaxError(r,o,p)}})};function j(){this.icon="icon icon-group-remote";this.hoverIcon="icon icon-group-remote-add";this.modal={getElement:function(){return f("#new-remote-process-group-dialog")},init:function(){var m="30 sec";var n="10 sec";this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Remote Process Group",handler:{close:function(){f("#new-remote-process-group-uris").val("");f("#new-remote-process-group-timeout").val(m);f("#new-remote-process-group-yield-duration").val(n);f("#new-remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});f("#new-remote-process-group-local-network-interface").val("");f("#new-remote-process-group-proxy-host").val("");f("#new-remote-process-group-proxy-port").val("");f("#new-remote-process-group-proxy-user").val("");f("#new-remote-process-group-proxy-password").val("")}}});f("#new-remote-process-group-timeout").val(m);f("#new-remote-process-group-yield-duration").val(n);f("#new-remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return f("#group-remote-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForRemoteProcessGroupUri(m)},dragIcon:function(m){return f('<div class="icon icon-group-remote-add"></div>')},promptForRemoteProcessGroupUri:function(o){var m=this;var n=function(){k(o)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:n}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.modal.hide()}}}]);this.modal.show();f("#new-remote-process-group-uris").focus().off("keyup").on("keyup",function(q){var p=q.keyCode?q.keyCode:q.which;if(p===f.ui.keyCode.ENTER){n()}})}};var i=new j();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.FunnelComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.FunnelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.FunnelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(h){function g(){this.icon="icon icon-funnel";this.hoverIcon="icon icon-funnel-add"}g.prototype={constructor:g,getElement:function(){return e("#funnel-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(j){this.createFunnel(j)},dragIcon:function(j){return e('<div class="icon icon-funnel-add"></div>')},createFunnel:function(k){var j={revision:b.getRevision({revision:{version:0}}),component:{position:{x:k.x,y:k.y}}};e.ajax({type:"POST",url:h.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/funnels",data:JSON.stringify(j),dataType:"json",contentType:"application/json"}).done(function(l){a.add({funnels:[l]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)}};var i=new g();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(h,d,f,c,e,j,g,i){return(nf.ng.TemplateComponent=b(h,d,f,c,e,j,g,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.TemplateComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.TemplateComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,d,a,c,h,e,g){return function(k){var j=function(n,o){var m={templateId:n,originX:o.x,originY:o.y};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/template-instance",data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(p){a.add(p.flow,{selectAll:true});a.updateVisibility();d.refresh()}).fail(h.handleAjaxError)};function i(){this.icon="icon icon-template";this.hoverIcon="icon icon-template-add";this.modal={getElement:function(){return f("#instantiate-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Template"})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}i.prototype={constructor:i,getElement:function(){return f("#template-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForTemplate(m)},dragIcon:function(m){return f('<div class="icon icon-template-add"></div>')},promptForTemplate:function(m){var n=this;f.ajax({type:"GET",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/flow/templates",dataType:"json"}).done(function(o){var q=o.templates;if(g.isDefinedAndNotNull(q)&&q.length>0){q=q.sort(function(s,r){var u=g.parseDateTime(s.template.timestamp);var t=g.parseDateTime(r.template.timestamp);return t.getTime()-u.getTime()});var p=[];f.each(q,function(r,s){if(s.permissions.canRead===true){p.push({text:s.template.name,value:s.id,description:g.escapeHtml(s.template.description)})}});f("#available-templates").combo({maxHeight:300,options:p});n.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var s=f("#available-templates").combo("getSelectedOption");var r=s.value;n.modal.hide();j(r,m)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);n.modal.show()}else{e.showOkDialog({headerText:"Instantiate Template",dialogContent:"No templates have been loaded into this NiFi."})}}).fail(h.handleAjaxError)}};var l=new i();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Label"],function(g,d,f,c,e,h,i){return(nf.ng.LabelComponent=b(g,d,f,c,e,h,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.LabelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Label")))}else{nf.ng.LabelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Label)}}}(this,function(e,b,d,a,c,f,g){return function(j){function i(){this.icon="icon icon-label";this.hoverIcon="icon icon-label-add"}i.prototype={constructor:i,getElement:function(){return e("#label-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.createLabel(k)},dragIcon:function(k){return e('<div class="icon icon-label-add"></div>')},createLabel:function(l){var k={revision:b.getRevision({revision:{version:0}}),component:{width:g.config.width,height:g.config.height,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/labels",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(m){a.add({labels:[m]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)}};var h=new i();return h}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.BreadcrumbsDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsDirective=b())}else{nf.ng.BreadcrumbsDirective=b()}}}(this,function(){return function(a){return{restrict:"E",templateUrl:"views/nf-ng-breadcrumbs-directive-view.html",scope:{breadcrumbs:"=",clickFunc:"=",highlightCrumbId:"=",separatorFunc:"=",isTracking:"=",getVersionControlClass:"=",getVersionControlTooltip:"="},link:function(d,c,b){a.registerMouseWheelEvent(c)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.DraggableDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.DraggableDirective=b())}else{nf.ng.DraggableDirective=b()}}}(this,function(){return function(){return{restrict:"AE",link:function(c,b,a){b.draggable(c.$eval(a.nfDraggable))}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.CanvasUtils","nf.ErrorHandler","nf.Client","nf.ClusterSummary","nf.Dialog","nf.Storage","nf.Canvas","nf.Graph","nf.ContextMenu","nf.QuickSelect","nf.Shell","nf.Settings","nf.Snippet","nf.Actions","nf.QueueListing","nf.VariableRegistry","nf.ComponentState","nf.FlowVersion","nf.ComponentVersion","nf.Draggable","nf.Connectable","nf.StatusHistory","nf.Birdseye","nf.ConnectionConfiguration","nf.ControllerService","nf.ReportingTask","nf.PolicyManagement","nf.ProcessorConfiguration","nf.ProcessGroupConfiguration","nf.ControllerServices","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupPorts","nf.PortConfiguration","nf.LabelConfiguration","nf.ProcessorDetails","nf.PortDetails","nf.ConnectionDetails","nf.RemoteProcessGroupDetails","nf.GoTo","nf.ng.Bridge","nf.ng.AppCtrl","nf.ng.AppConfig","nf.ng.ServiceProvider","nf.ng.BreadcrumbsCtrl","nf.ng.Canvas.HeaderCtrl","nf.ng.Canvas.FlowStatusCtrl","nf.ng.Canvas.GlobalMenuCtrl","nf.ng.Canvas.ToolboxCtrl","nf.ng.ProcessorComponent","nf.ng.InputPortComponent","nf.ng.OutputPortComponent","nf.ng.GroupComponent","nf.ng.RemoteProcessGroupComponent","nf.ng.FunnelComponent","nf.ng.TemplateComponent","nf.ng.LabelComponent","nf.ng.Canvas.GraphControlsCtrl","nf.ng.Canvas.NavigateCtrl","nf.ng.Canvas.OperateCtrl","nf.ng.BreadcrumbsDirective","nf.ng.DraggableDirective"],function(P,D,ab,al,f,m,X,q,z,G,x,H,Y,aa,U,E,am,M,p,h,B,A,C,O,af,l,v,ac,Q,I,ak,S,V,N,c,R,J,d,y,w,ae,k,t,j,L,ad,o,g,e,s,ah,Z,F,K,an,ag,aj,W,u,T,i,ai,n,r){return b(P,D,ab,al,f,m,X,q,z,G,x,H,Y,aa,U,E,am,M,p,h,B,A,C,O,af,l,v,ac,Q,I,ak,S,V,N,c,R,J,d,y,w,ae,k,t,j,L,ad,o,g,e,s,ah,Z,F,K,an,ag,aj,W,u,T,i,ai,n,r)})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.ClusterSummary"),require("nf.Dialog"),require("f.Storage"),require("nf.Canvas"),require("nf.Graph"),require("nf.ContextMenu"),require("nf.QuickSelect"),require("nf.Shell"),require("nf.Settings"),require("nf.Actions"),require("nf.Snippet"),require("nf.QueueListing"),require("nf.VariableRegistry"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.ComponentVersion"),require("nf.Draggable"),require("nf.Connectable"),require("nf.StatusHistory"),require("nf.Birdseye"),require("nf.ConnectionConfiguration"),require("nf.ControllerService"),require("nf.ReportingTask"),require("nf.PolicyManagement"),require("nf.ProcessorConfiguration"),require("nf.ProcessGroupConfiguration"),require("nf.ControllerServices"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupPorts"),require("nf.PortConfiguration"),require("nf.LabelConfiguration"),require("nf.ProcessorDetails"),require("nf.PortDetails"),require("nf.ConnectionDetails"),require("nf.RemoteProcessGroupDetails"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.ng.AppCtrl"),require("nf.ng.AppConfig"),require("nf.ng.ServiceProvider"),require("nf.ng.BreadcrumbsCtrl"),require("nf.ng.Canvas.HeaderCtrl"),require("nf.ng.Canvas.FlowStatusCtrl"),require("nf.ng.Canvas.GlobalMenuCtrl"),require("nf.ng.Canvas.ToolboxCtrl"),require("nf.ng.ProcessorComponent"),require("nf.ng.InputPortComponent"),require("nf.ng.OutputPortComponent"),require("nf.ng.GroupComponent"),require("nf.ng.RemoteProcessGroupComponent"),require("nf.ng.FunnelComponent"),require("nf.ng.TemplateComponent"),require("nf.ng.LabelComponent"),require("nf.ng.Canvas.GraphControlsCtrl"),require("nf.ng.Canvas.NavigateCtrl"),require("nf.ng.Canvas.OperateCtrl"),require("nf.ng.BreadcrumbsDirective"),require("nf.ng.DraggableDirective"))}else{b(a.$,a.angular,a.nf.Common,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Client,a.nf.ClusterSummary,a.nf.Dialog,a.nf.Storage,a.nf.Canvas,a.nf.Graph,a.nf.ContextMenu,a.nf.QuickSelect,a.nf.Shell,a.nf.Settings,a.nf.Actions,a.nf.Snippet,a.nf.QueueListing,a.nf.VariableRegistry,a.nf.ComponentState,a.nf.FlowVersion,a.nf.ComponentVersion,a.nf.Draggable,a.nf.Connectable,a.nf.StatusHistory,a.nf.Birdseye,a.nf.ConnectionConfiguration,a.nf.ControllerService,a.nf.ReportingTask,a.nf.PolicyManagement,a.nf.ProcessorConfiguration,a.nf.ProcessGroupConfiguration,a.nf.ControllerServices,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupPorts,a.nf.PortConfiguration,a.nf.LabelConfiguration,a.nf.ProcessorDetails,a.nf.PortDetails,a.nf.ConnectionDetails,a.nf.RemoteProcessGroupDetails,a.nf.GoTo,a.nf.ng.Bridge,a.nf.ng.AppCtrl,a.nf.ng.AppConfig,a.nf.ng.ServiceProvider,a.nf.ng.BreadcrumbsCtrl,a.nf.ng.Canvas.HeaderCtrl,a.nf.ng.Canvas.FlowStatusCtrl,a.nf.ng.Canvas.GlobalMenuCtrl,a.nf.ng.Canvas.ToolboxCtrl,a.nf.ng.ProcessorComponent,a.nf.ng.InputPortComponent,a.nf.ng.OutputPortComponent,a.nf.ng.GroupComponent,a.nf.ng.RemoteProcessGroupComponent,a.nf.ng.FunnelComponent,a.nf.ng.TemplateComponent,a.nf.ng.LabelComponent,a.nf.ng.Canvas.GraphControlsCtrl,a.nf.ng.Canvas.NavigateCtrl,a.nf.ng.Canvas.OperateCtrl,a.nf.ng.BreadcrumbsDirective,a.nf.ng.DraggableDirective)}}}(this,function(N,B,aa,ak,d,k,W,o,x,E,v,F,X,Z,S,C,al,K,n,f,z,y,A,M,ae,j,t,ab,O,G,aj,Q,U,L,a,P,H,b,w,u,ad,i,r,h,J,ac,m,e,c,q,ag,Y,D,I,am,af,ai,V,s,R,g,ah,l,p){var T={urls:{flowConfig:"../nifi-api/flow/config"}};N(document).ready(function(){if(E.SUPPORTS_SVG){var ao=B.module("ngCanvasApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);J.$inject=["$mdThemingProvider","$compileProvider"];h.$inject=["$scope","serviceProvider","$compile","headerCtrl","graphControlsCtrl"];ac.$inject=[];m.$inject=["serviceProvider"];e.$inject=["serviceProvider","toolboxCtrl","globalMenuCtrl","flowStatusCtrl"];c.$inject=["serviceProvider"];q.$inject=["serviceProvider"];ag.$inject=["processorComponent","inputPortComponent","outputPortComponent","groupComponent","remoteGroupComponent","funnelComponent","templateComponent","labelComponent"];Y.$inject=["serviceProvider"];D.$inject=["serviceProvider"];I.$inject=["serviceProvider"];am.$inject=["serviceProvider"];af.$inject=["serviceProvider"];ai.$inject=["serviceProvider"];V.$inject=["serviceProvider"];s.$inject=["serviceProvider"];R.$inject=["serviceProvider","navigateCtrl","operateCtrl"];g.$inject=[];ah.$inject=[];l.$inject=["breadcrumbsCtrl"];p.$inject=[];ao.config(J);ao.controller("ngCanvasAppCtrl",h);ao.service("serviceProvider",ac);ao.service("breadcrumbsCtrl",m);ao.service("headerCtrl",e);ao.service("flowStatusCtrl",c);ao.service("globalMenuCtrl",q);ao.service("toolboxCtrl",ag);ao.service("processorComponent",Y);ao.service("inputPortComponent",D);ao.service("outputPortComponent",I);ao.service("groupComponent",am);ao.service("remoteGroupComponent",af);ao.service("funnelComponent",ai);ao.service("templateComponent",V);ao.service("labelComponent",s);ao.service("graphControlsCtrl",R);ao.service("navigateCtrl",g);ao.service("operateCtrl",ah);ao.directive("nfBreadcrumbs",l);ao.directive("nfDraggable",p);ak.init(E,C,al,j,v);r.injector=B.bootstrap(N("body"),["ngCanvasApp"],{strictDi:true});var an=E.init();an.done(function(){var ap=k.init();var aq=N.ajax({type:"GET",url:T.urls.flowConfig,dataType:"json"});N.when(aq,W.loadClusterSummary(),an,ap).done(function(au){var av=au[0];var aw=N("#canvas-container");E.CANVAS_OFFSET=aw.offset().top;var at=av.flowConfiguration;if(W.isClustered()&&!W.isConnectedToCluster()){o.showDisconnectedFromClusterMessage()}var ar=parseInt(at.autoRefreshIntervalSeconds,10);E.setManagedAuthorizer(at.supportsManagedAuthorizer);E.setConfigurableAuthorizer(at.supportsConfigurableAuthorizer);E.setConfigurableUsersAndGroups(at.supportsConfigurableUsersAndGroups);x.init();E.initCanvas();E.View.init();F.init(C);X.init(C);Z.init(F);r.injector.get("headerCtrl").init();S.init();C.init();K.init();n.init();f.init();z.init(at.timeOffset);y.init(S);A.init();M.init();ae.init(at.timeOffset);j.init(v);t.init(j,v);ab.init(U);O.init(S);G.init();aj.init();Q.init(U);L.init();a.init();P.init();H.init();b.init(true);w.init();u.init();ad.init();i.init();v.init().done(function(){r.injector.get("graphControlsCtrl").init();var ax=ar/2;setTimeout(function(){E.startPolling(ar)},ax*1000);E.hideSplash()}).fail(d.handleAjaxError)}).fail(d.handleAjaxError)}).fail(d.handleAjaxError);N(".component-button").qtip(N.extend({},aa.config.tooltipConfig,{position:{at:"bottom center",my:"top center",adjust:{y:5}}}))}else{N("#message-title").text("Unsupported Browser");N("#message-content").text("Flow graphs are shown using SVG. Please use a browser that supports rendering SVG.");N("#message-pane").show();E.hideSplash()}})}));
